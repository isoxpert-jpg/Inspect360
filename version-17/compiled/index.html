<style>
  @import url(https://fonts.googleapis.com/css?family=Google+Sans+Text);
  html {
    font-family: 'Google Sans Text', 'Google Sans';
    font-size: 14px;
    color-scheme: light dark;
    background: light-dark(white, black);
    color: light-dark(black, white);
  }
</style>

<script type="importmap">{"imports":{"@modelcontextprotocol/sdk/":"https://aistudiocdn.com/@modelcontextprotocol/sdk/dist/esm/","https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/es2022/":"https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/es2022/dist/esm/","https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/client/index?target=es2022":"https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/dist/esm/client/index?target=es2022","https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/types?target=es2022":"https://aistudiocdn.com/@modelcontextprotocol/sdk@^1.11.0/dist/esm/types?target=es2022","react":"https://aistudiocdn.com/react@^19.2.0","react-dom/client":"https://aistudiocdn.com/react-dom@^19.2.0/client","lucide-react":"https://aistudiocdn.com/lucide-react@^0.554.0","@google/genai":"https://aistudiocdn.com/@google/genai@^1.30.0","react-dom/":"https://aistudiocdn.com/react-dom@^19.2.0/","react/":"https://aistudiocdn.com/react@^19.2.0/","@/index":"data:application/javascript;base64,aW1wb3J0IHsganN4IGFzIF9qc3gsIGpzeHMgYXMgX2pzeHMgfSBmcm9tICJyZWFjdC9qc3gtcnVudGltZSI7CmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGNyZWF0ZVJvb3QgfSBmcm9tICdyZWFjdC1kb20vY2xpZW50JzsKaW1wb3J0IHsgQ2FtZXJhLCBVcGxvYWQsIENoZXZyb25MZWZ0LCBDaGVja0NpcmNsZSwgQWxlcnRUcmlhbmdsZSwgRmlsZVRleHQsIFByaW50ZXIsIFNoaWVsZCwgRmxhbWUsIExlYWYsIFV0ZW5zaWxzLCBYLCBMb2FkZXIyLCBNYXAgYXMgTWFwSWNvbiwgQ2hlY2tTcXVhcmUsIEJ1aWxkaW5nLCBMYXllcnMsIE1hcFBpbiwgVXNlciwgQnJpZWZjYXNlLCBDaGVjaywgR2xvYmUsIFNwYXJrbGVzLCBBcnJvd1JpZ2h0LCBHYXZlbCwgQ2xvY2ssIFBsYXksIExvY2ssIFNob3BwaW5nQmFnLCBHcmlwVmVydGljYWwsIEltYWdlSWNvbiwgUmVmcmVzaEN3LCBBbGVydENpcmNsZSwgQ2xpcGJvYXJkQ2hlY2ssIExheW91dERhc2hib2FyZCwgVGh1bWJzVXAsIFRodW1ic0Rvd24sIEFjdGl2aXR5LCBTY3JvbGxUZXh0LCBIaXN0b3J5IH0gZnJvbSAnbHVjaWRlLXJlYWN0JzsKaW1wb3J0IHsgR29vZ2xlR2VuQUksIFR5cGUgfSBmcm9tICJAZ29vZ2xlL2dlbmFpIjsKLy8gLS0tIEFJIFNldHVwIC0tLQpjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5BSSh7IGFwaUtleTogcHJvY2Vzcy5lbnYuQVBJX0tFWSB9KTsKY29uc3QgU0NPUEVfQ09ORklHID0gewogICAgT0hTOiB7CiAgICAgICAgbGFiZWw6ICdPY2N1cGF0aW9uYWwgSGVhbHRoICYgU2FmZXR5JywKICAgICAgICBpY29uOiBTaGllbGQsCiAgICAgICAgY29sb3I6ICdiZy1ibHVlLTYwMCcsCiAgICAgICAgZm9jdXM6ICdzbGlwL3RyaXAgaGF6YXJkcywgd29ya2luZyBhdCBoZWlnaHRzLCBlbGVjdHJpY2FsIHNhZmV0eSwgbWFjaGluZSBndWFyZGluZywgUFBFIGNvbXBsaWFuY2UsIGFuZCBjbGVhciBmbG9vciBtYXJraW5ncyAoZ3JlZW4gc2FmZSB3YWxrd2F5cywgeWVsbG93L2JsYWNrIHplYnJhIGNyb3NzaW5ncyBhcm91bmQgbWFjaGluZXMpLicsCiAgICAgICAgc3RhbmRhcmRzOiAnSVNPIDQ1MDAxOjIwMTggKE9IJlMgTWFuYWdlbWVudCksIE9TSEEgMTkxMCAoR2VuZXJhbCBJbmR1c3RyeSksIExvY2FsIEZhY3RvcmllcyBBY3RzIChMYXRlc3QgQW1lbmRtZW50cyksIEFOU0kvQVNTUCBaMTAuMCcsCiAgICAgICAgZG9jdW1lbnRzOiAnSGF6YXJkIElkZW50aWZpY2F0aW9uICYgUmlzayBBc3Nlc3NtZW50IChISVJBKSwgUFBFIElzc3VhbmNlIFJlZ2lzdGVyLCBNYWNoaW5lcnkgSW5zcGVjdGlvbiBDaGVja2xpc3RzLCBMb2Nrb3V0L1RhZ291dCAoTE9UTykgTG9ncywgU2FmZXR5IFRyYWluaW5nIEF0dGVuZGFuY2UgUmVjb3JkcycsCiAgICAgICAgaGV4OiAnIzI1NjNlYicKICAgIH0sCiAgICBGaXJlOiB7CiAgICAgICAgbGFiZWw6ICdGaXJlIFNhZmV0eScsCiAgICAgICAgaWNvbjogRmxhbWUsCiAgICAgICAgY29sb3I6ICdiZy1yZWQtNjAwJywKICAgICAgICBmb2N1czogJ2Jsb2NrZWQgZXhpdHMsIGV4dGluZ3Vpc2hlciBhY2Nlc3NpYmlsaXR5LCBzaWduYWdlLCBmbGFtbWFibGUgc3RvcmFnZSwgYW5kIHNwcmlua2xlciBvYnN0cnVjdGlvbi4nLAogICAgICAgIHN0YW5kYXJkczogJ05GUEEgMTAxIChMaWZlIFNhZmV0eSBDb2RlKSwgTkZQQSAxMCAoUG9ydGFibGUgRXh0aW5ndWlzaGVycyksIE5GUEEgNzIgKEZpcmUgQWxhcm0gQ29kZSksIElTTyA3MDEwIChTYWZldHkgU2lnbnMpLCBMb2NhbCBGaXJlIENvZGVzJywKICAgICAgICBkb2N1bWVudHM6ICdGaXJlIEV4dGluZ3Vpc2hlciBJbnNwZWN0aW9uIFRhZ3MsIEZpcmUgQWxhcm0gU3lzdGVtIFRlc3QgUmVwb3J0cywgRW1lcmdlbmN5IEV2YWN1YXRpb24gRHJpbGwgTG9ncywgRmlyZSBTYWZldHkgUGxhbiwgSG90IFdvcmsgUGVybWl0cycsCiAgICAgICAgaGV4OiAnI2RjMjYyNicKICAgIH0sCiAgICBFbnZpcm9ubWVudGFsOiB7CiAgICAgICAgbGFiZWw6ICdFbnZpcm9ubWVudGFsJywKICAgICAgICBpY29uOiBMZWFmLAogICAgICAgIGNvbG9yOiAnYmctZ3JlZW4tNjAwJywKICAgICAgICBmb2N1czogJ2NoZW1pY2FsIHNwaWxscywgd2FzdGUgc2VncmVnYXRpb24sIHNlY29uZGFyeSBjb250YWlubWVudCwgYW5kIGVtaXNzaW9uIGNvbnRyb2wuJywKICAgICAgICBzdGFuZGFyZHM6ICdJU08gMTQwMDE6MjAxNSAoRW52aXJvbm1lbnRhbCBNYW5hZ2VtZW50KSwgRVBBIDQwIENGUiAoSGF6YXJkb3VzIFdhc3RlKSwgTG9jYWwgRW52aXJvbm1lbnRhbCBQcm90ZWN0aW9uIEFjdHMnLAogICAgICAgIGRvY3VtZW50czogJ1dhc3RlIERpc3Bvc2FsIE1hbmlmZXN0cywgU3BpbGwgUHJldmVudGlvbiBDb250cm9sICYgQ291bnRlcm1lYXN1cmUgKFNQQ0MpIFBsYW4sIFNhZmV0eSBEYXRhIFNoZWV0cyAoU0RTKSwgQWlyIEVtaXNzaW9ucyBNb25pdG9yaW5nIExvZ3MnLAogICAgICAgIGhleDogJyMxNmEzNGEnCiAgICB9LAogICAgR01QOiB7CiAgICAgICAgbGFiZWw6ICdGb29kIFNhZmV0eSAoR01QL0hBQ0NQKScsCiAgICAgICAgaWNvbjogVXRlbnNpbHMsCiAgICAgICAgY29sb3I6ICdiZy10ZWFsLTYwMCcsCiAgICAgICAgZm9jdXM6ICdoeWdpZW5lLCBjcm9zcy1jb250YW1pbmF0aW9uLCBwZXN0IGNvbnRyb2wsIGhhaXJuZXRzL2JlYXJkIG5ldHMsIGpld2VscnksIHBlcnNvbmFsIGl0ZW1zIG9uIHByZXAgc3VyZmFjZXMsIHNhbml0YXRpb24sIGFuZCBmb3JlaWduIG1hdGVyaWFsIGNvbnRyb2wuJywKICAgICAgICBzdGFuZGFyZHM6ICdGU1NDIDIyMDAwIHY2LCBJU08gMjIwMDA6MjAxOCwgQ09ERVggQWxpbWVudGFyaXVzIEdlbmVyYWwgUHJpbmNpcGxlcyBvZiBGb29kIEh5Z2llbmUsIEZEQSAyMSBDRlIgUGFydCAxMTAnLAogICAgICAgIGRvY3VtZW50czogJ01hc3RlciBDbGVhbmluZyBTY2hlZHVsZSwgUGVzdCBDb250cm9sIFNlcnZpY2UgUmVwb3J0cywgU3RhZmYgSGVhbHRoICYgSHlnaWVuZSBSZWNvcmRzLCBUZW1wZXJhdHVyZSBDb250cm9sIExvZ3MsIEFsbGVyZ2VuIE1hbmFnZW1lbnQgUGxhbicsCiAgICAgICAgaGV4OiAnIzBkOTQ4OCcKICAgIH0sCiAgICBTZWN1cml0eTogewogICAgICAgIGxhYmVsOiAnU2VjdXJpdHkgJiBTdXJ2ZWlsbGFuY2UnLAogICAgICAgIGljb246IExvY2ssCiAgICAgICAgY29sb3I6ICdiZy1wdXJwbGUtNjAwJywKICAgICAgICBmb2N1czogJ2JsaW5kIHNwb3RzLCBwb29yIGxpZ2h0aW5nLCB3ZWFrIGVudHJ5IHBvaW50cywgbWlzc2luZyBjYW1lcmEgY292ZXJhZ2UsIGludHJ1c2lvbiByaXNrcywgcGVyaW1ldGVyIGludGVncml0eSwgYW5kIGFjY2VzcyBjb250cm9sIGdhcHMuJywKICAgICAgICBzdGFuZGFyZHM6ICdJU08gMjcwMDE6MjAxMyBBbm5leCBBLjExIChQaHlzaWNhbCBTZWN1cml0eSksIEFOU0kvQVNJUyBQQVAuMS0yMDEyIChQaHlzaWNhbCBBc3NldCBQcm90ZWN0aW9uKSwgQ1BURUQgUHJpbmNpcGxlcycsCiAgICAgICAgZG9jdW1lbnRzOiAnQ0NUViBTeXN0ZW0gTWFpbnRlbmFuY2UgTG9ncywgVmlzaXRvciBBY2Nlc3MgQ29udHJvbCBSZWdpc3RlciwgU2VjdXJpdHkgSW5jaWRlbnQgUmVwb3J0cywgS2V5ICYgQWNjZXNzIENhcmQgQ29udHJvbCBQb2xpY3ksIFBlcmltZXRlciBTZWN1cml0eSBQYXRyb2wgTG9ncycsCiAgICAgICAgaGV4OiAnIzkzMzNlYScKICAgIH0sCiAgICBGYWNpbGl0eTogewogICAgICAgIGxhYmVsOiAnRmFjaWxpdHkgTWFuYWdlbWVudCAoSVNPIDQxMDAxKScsCiAgICAgICAgaWNvbjogQ2xpcGJvYXJkQ2hlY2ssCiAgICAgICAgY29sb3I6ICdiZy1pbmRpZ28tNjAwJywKICAgICAgICBmb2N1czogJ2V4dGVyaW9yL2ludGVyaW9yIGNvbmRpdGlvbnMsIE1FUCB2aXN1YWxzLCBmaXJlIHNhZmV0eSwgc2VjdXJpdHksIGFzc2V0cywgY2xlYW5saW5lc3MsIGNvbnRyYWN0b3IgY29tcGxpYW5jZS4nLAogICAgICAgIHN0YW5kYXJkczogJ0lTTyA0MTAwMToyMDE4IChGYWNpbGl0eSBNYW5hZ2VtZW50KSwgQVNUTSBFMjAxOC0xNSAoUHJvcGVydHkgQ29uZGl0aW9uIEFzc2Vzc21lbnRzKSwgSW50ZXJuYXRpb25hbCBCdWlsZGluZyBDb2RlIChJQkMpIENoYXB0ZXIgMTAnLAogICAgICAgIGRvY3VtZW50czogJ1ByZXZlbnRpdmUgTWFpbnRlbmFuY2UgKFBNKSBTY2hlZHVsZSwgQXNzZXQgUmVnaXN0ZXIgJiBDb25kaXRpb24gQXNzZXNzbWVudCwgQ29udHJhY3RvciBXb3JrIFBlcm1pdHMsIENsZWFuaW5nIFNlcnZpY2UgTGV2ZWwgQWdyZWVtZW50cyAoU0xBKSwgQnVpbGRpbmcgSW5zcGVjdGlvbiBSZXBvcnRzJywKICAgICAgICBoZXg6ICcjNGY0NmU1JwogICAgfQp9OwovLyAtLS0gR2xvYmFsIFN0eWxlcyAoUHJpbnQgT3B0aW1pemF0aW9uKSAtLS0KY29uc3QgR2xvYmFsUHJpbnRTdHlsZXMgPSBgCiAgQG1lZGlhIHByaW50IHsKICAgIEBwYWdlIHsKICAgICAgc2l6ZTogQTQ7CiAgICAgIG1hcmdpbjogMTJtbSAxNW1tOyAvKiBTbGlnaHRseSB0aWdodGVyIG1hcmdpbnMgZm9yIGJldHRlciBmaXQgKi8KICAgIH0KICAgIGh0bWwsIGJvZHkgewogICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgICBmb250LWZhbWlseTogJ0hlbHZldGljYSBOZXVlJywgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsKICAgICAgZm9udC1zaXplOiAxMHB0OwogICAgICBsaW5lLWhlaWdodDogMS40OwogICAgICBjb2xvcjogIzBmMTcyYTsKICAgICAgLXdlYmtpdC1wcmludC1jb2xvci1hZGp1c3Q6IGV4YWN0ICFpbXBvcnRhbnQ7CiAgICAgIHByaW50LWNvbG9yLWFkanVzdDogZXhhY3QgIWltcG9ydGFudDsKICAgIH0KICAgIAogICAgLyogTGF5b3V0IEhlbHBlcnMgKi8KICAgIC5wcmludC1icmVhay1iZWZvcmUgeyBwYWdlLWJyZWFrLWJlZm9yZTogYWx3YXlzICFpbXBvcnRhbnQ7IGJyZWFrLWJlZm9yZTogcGFnZSAhaW1wb3J0YW50OyB9CiAgICAucHJpbnQtYnJlYWstYWZ0ZXIgeyBwYWdlLWJyZWFrLWFmdGVyOiBhbHdheXMgIWltcG9ydGFudDsgYnJlYWstYWZ0ZXI6IHBhZ2UgIWltcG9ydGFudDsgfQogICAgLnByaW50LW5vLWJyZWFrIHsgcGFnZS1icmVhay1pbnNpZGU6IGF2b2lkICFpbXBvcnRhbnQ7IGJyZWFrLWluc2lkZTogYXZvaWQgIWltcG9ydGFudDsgfQogICAgCiAgICAvKiBDb3ZlciBQYWdlICovCiAgICAucHJpbnQtY292ZXItcGFnZSB7CiAgICAgIG1pbi1oZWlnaHQ6IDk4dmg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgcGFnZS1icmVhay1hZnRlcjogYWx3YXlzOwogICAgfQogICAgCiAgICAvKiBUeXBvZ3JhcGh5IE92ZXJyaWRlcyBmb3IgUHJpbnQgKi8KICAgIGgxIHsgZm9udC1zaXplOiAyMnB0ICFpbXBvcnRhbnQ7IGxpbmUtaGVpZ2h0OiAxLjIgIWltcG9ydGFudDsgY29sb3I6ICMwZjE3MmEgIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMC41Y20gIWltcG9ydGFudDsgfQogICAgaDIgeyBmb250LXNpemU6IDE2cHQgIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMC4zY20gIWltcG9ydGFudDsgY29sb3I6ICMxZTI5M2IgIWltcG9ydGFudDsgYnJlYWstYWZ0ZXI6IGF2b2lkOyB9CiAgICBoMyB7IGZvbnQtc2l6ZTogMTJwdCAhaW1wb3J0YW50OyBtYXJnaW4tYm90dG9tOiAwLjJjbSAhaW1wb3J0YW50OyBjb2xvcjogIzMzNDE1NSAhaW1wb3J0YW50OyBicmVhay1hZnRlcjogYXZvaWQ7IH0KICAgIHAsIGxpLCB0ZCB7IGZvbnQtc2l6ZTogOXB0ICFpbXBvcnRhbnQ7IH0KICAgIAogICAgLyogUmVtb3ZlIFdlYiBVSSBjbHV0dGVyICovCiAgICAubm8tcHJpbnQsIGJ1dHRvbiwgbmF2LCBpbnB1dFt0eXBlPSJ0ZXh0Il0sIGlucHV0W3R5cGU9ImZpbGUiXSwgLm92ZXJsYXktc2xpZGVyLWhhbmRsZSwgLnByaW50LWhpZGRlbiB7CiAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBDbGVhbiBDYXJkIFN0eWxlIGZvciBQcmludCAqLwogICAgLnByaW50LWNhcmQtY2xlYW4gewogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50OwogICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsKICAgICAgYm94LXNoYWRvdzogbm9uZSAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIG1hcmdpbi1ib3R0b206IDAuM2NtICFpbXBvcnRhbnQ7CiAgICB9CiAgICAKICAgIC8qIEJvcmRlcnMgZm9yIFNlY3Rpb25zICovCiAgICAucHJpbnQtc2VjdGlvbi1ib3JkZXIgewogICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2UyZThmMCAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgICAgbWFyZ2luLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBPcHRpbWl6ZWQgR3JpZCBmb3IgSW1hZ2VzICovCiAgICAucHJpbnQtZ3JpZC0yIHsKICAgICAgZGlzcGxheTogZ3JpZCAhaW1wb3J0YW50OwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnIgIWltcG9ydGFudDsKICAgICAgZ2FwOiA1bW0gIWltcG9ydGFudDsKICAgICAgbWFyZ2luLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgIH0KICAgIAogICAgLnByaW50LWltYWdlLWNvbXBhY3QgewogICAgICAgIGhlaWdodDogMTYwcHggIWltcG9ydGFudDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmYWZjOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjYmQ1ZTE7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgfQogICAgCiAgICAvKiBQcm9mZXNzaW9uYWwgVGFibGUgU3R5bGluZyAqLwogICAgdGFibGUucHJpbnQtdGFibGUgeyAKICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsgCiAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7IAogICAgICBtYXJnaW4tYm90dG9tOiAwLjVjbSAhaW1wb3J0YW50OyAKICAgICAgZm9udC1zaXplOiA5cHQgIWltcG9ydGFudDsKICAgIH0KICAgIHRhYmxlLnByaW50LXRhYmxlIHRoIHsgCiAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjMzM0MTU1ICFpbXBvcnRhbnQ7IAogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmNWY5ICFpbXBvcnRhbnQ7CiAgICAgIHRleHQtYWxpZ246IGxlZnQ7IAogICAgICBwYWRkaW5nOiA2cHggOHB4ICFpbXBvcnRhbnQ7IAogICAgICBmb250LXdlaWdodDogNzAwICFpbXBvcnRhbnQ7IAogICAgICBjb2xvcjogIzBmMTcyYSAhaW1wb3J0YW50OyAKICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgIH0KICAgIHRhYmxlLnByaW50LXRhYmxlIHRkIHsgCiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZTJlOGYwICFpbXBvcnRhbnQ7IAogICAgICBwYWRkaW5nOiA2cHggOHB4ICFpbXBvcnRhbnQ7IAogICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOwogICAgfQogICAgdGFibGUucHJpbnQtdGFibGUgdHI6bnRoLWNoaWxkKGV2ZW4pIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZmFmYyAhaW1wb3J0YW50OwogICAgfQogICAgCiAgICAvKiBTcGVjaWZpYyBNYW5pZmVzdCBTdHlsaW5nICovCiAgICAucmVtZWRpYXRpb24tbWFuaWZlc3QgewogICAgICBtYXJnaW4tdG9wOiAxY207CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjYmQ1ZTE7CiAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgcGFkZGluZzogMDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgcGFnZS1icmVhay1pbnNpZGU6IGF2b2lkOwogICAgfQogICAgLnJlbWVkaWF0aW9uLWhlYWRlciB7CiAgICAgIGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiA4cHggMTJweDsKICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICAgIGZvbnQtc2l6ZTogMTBwdDsKICAgICAgLXdlYmtpdC1wcmludC1jb2xvci1hZGp1c3Q6IGV4YWN0ICFpbXBvcnRhbnQ7CiAgICAgIHByaW50LWNvbG9yLWFkanVzdDogZXhhY3QgIWltcG9ydGFudDsKICAgIH0KICB9CmA7Ci8vIC0tLSBDb21wb25lbnRzIC0tLQpjb25zdCBBY3Rpdml0eUxvZ01vZGFsID0gKHsgbG9ncywgaXNPcGVuLCBvbkNsb3NlIH0pID0+IHsKICAgIGlmICghaXNPcGVuKQogICAgICAgIHJldHVybiBudWxsOwogICAgcmV0dXJuIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImZpeGVkIGluc2V0LTAgYmctc2xhdGUtOTAwLzUwIGJhY2tkcm9wLWJsdXItc20gei1bMTAwXSBmbGV4IGp1c3RpZnktZW5kIiwgY2hpbGRyZW46IF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInctZnVsbCBtYXgtdy1tZCBiZy13aGl0ZSBoLWZ1bGwgc2hhZG93LTJ4bCBmbGV4IGZsZXgtY29sIGFuaW1hdGUtZmFkZS1pbiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC00IGJvcmRlci1iIGJvcmRlci1zbGF0ZS0yMDAgZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIGJnLXNsYXRlLTUwIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiB0ZXh0LXNsYXRlLTgwMCBmb250LWJvbGQiLCBjaGlsZHJlbjogW19qc3goSGlzdG9yeSwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBJbnNwZWN0aW9uIEFjdGl2aXR5IExvZyJdIH0pLCBfanN4KCJidXR0b24iLCB7IG9uQ2xpY2s6IG9uQ2xvc2UsIGNsYXNzTmFtZTogInAtMiBob3ZlcjpiZy1zbGF0ZS0yMDAgcm91bmRlZC1mdWxsIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IF9qc3goWCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleC0xIG92ZXJmbG93LXktYXV0byBwLTQgc3BhY2UteS00IiwgY2hpbGRyZW46IGxvZ3MubGVuZ3RoID09PSAwID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgcHktMTAiLCBjaGlsZHJlbjogIk5vIGFjdGl2aXR5IHJlY29yZGVkIHlldC4iIH0pKSA6IChsb2dzLm1hcCgobG9nKSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMyIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibXQtMSIsIGNoaWxkcmVuOiBbbG9nLnR5cGUgPT09ICdhaScgJiYgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ3LTYgaC02IHJvdW5kZWQtZnVsbCBiZy1pbmRpZ28tMTAwIHRleHQtaW5kaWdvLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciIsIGNoaWxkcmVuOiBfanN4KFNwYXJrbGVzLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pIH0pLCBsb2cudHlwZSA9PT0gJ2luZm8nICYmIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy02IGgtNiByb3VuZGVkLWZ1bGwgYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIiwgY2hpbGRyZW46IF9qc3goU2Nyb2xsVGV4dCwgeyBjbGFzc05hbWU6ICJ3LTMgaC0zIiB9KSB9KSwgbG9nLnR5cGUgPT09ICdzdWNjZXNzJyAmJiBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInctNiBoLTYgcm91bmRlZC1mdWxsIGJnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciIsIGNoaWxkcmVuOiBfanN4KENoZWNrLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pIH0pLCBsb2cudHlwZSA9PT0gJ2Vycm9yJyAmJiBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInctNiBoLTYgcm91bmRlZC1mdWxsIGJnLXJlZC0xMDAgdGV4dC1yZWQtNjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIiwgY2hpbGRyZW46IF9qc3goQWxlcnRDaXJjbGUsIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSkgfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4LTEiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLXN0YXJ0IiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTgwMCIsIGNoaWxkcmVuOiBsb2cuYWN0aW9uIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBmb250LW1vbm8iLCBjaGlsZHJlbjogbmV3IERhdGUobG9nLnRpbWVzdGFtcCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkgfSldIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNjAwIG10LTAuNSIsIGNoaWxkcmVuOiBsb2cuZGV0YWlscyB9KV0gfSldIH0sIGxvZy5pZCkpKSkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCBib3JkZXItdCBib3JkZXItc2xhdGUtMjAwIHRleHQtY2VudGVyIHRleHQteHMgdGV4dC1zbGF0ZS00MDAiLCBjaGlsZHJlbjogW2xvZ3MubGVuZ3RoLCAiIFRvdGFsIEV2ZW50cyBSZWNvcmRlZCJdIH0pXSB9KSB9KSk7Cn07CmNvbnN0IEltYWdlQ29tcGFyZVNsaWRlciA9ICh7IG9yaWdpbmFsLCBvdmVybGF5LCBsYWJlbE9yaWdpbmFsID0gIk9yaWdpbmFsIiwgbGFiZWxPdmVybGF5ID0gIkFuYWx5c2lzIiB9KSA9PiB7CiAgICBjb25zdCBbc2xpZGVyUG9zaXRpb24sIHNldFNsaWRlclBvc2l0aW9uXSA9IHVzZVN0YXRlKDUwKTsKICAgIGNvbnN0IFtpc0RyYWdnaW5nLCBzZXRJc0RyYWdnaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTsKICAgIGNvbnN0IGNvbnRhaW5lclJlZiA9IHVzZVJlZihudWxsKTsKICAgIGNvbnN0IGhhbmRsZU1vdmUgPSAoY2xpZW50WCkgPT4gewogICAgICAgIGlmICghY29udGFpbmVyUmVmLmN1cnJlbnQpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyUmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgY29uc3QgeCA9IE1hdGgubWF4KDAsIE1hdGgubWluKGNsaWVudFggLSByZWN0LmxlZnQsIHJlY3Qud2lkdGgpKTsKICAgICAgICBjb25zdCBwZXJjZW50ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCAoeCAvIHJlY3Qud2lkdGgpICogMTAwKSk7CiAgICAgICAgc2V0U2xpZGVyUG9zaXRpb24ocGVyY2VudCk7CiAgICB9OwogICAgY29uc3Qgb25Nb3VzZURvd24gPSAoZSkgPT4gewogICAgICAgIHNldElzRHJhZ2dpbmcodHJ1ZSk7CiAgICAgICAgaGFuZGxlTW92ZShlLmNsaWVudFgpOwogICAgfTsKICAgIGNvbnN0IG9uVG91Y2hTdGFydCA9IChlKSA9PiB7CiAgICAgICAgc2V0SXNEcmFnZ2luZyh0cnVlKTsKICAgICAgICBoYW5kbGVNb3ZlKGUudG91Y2hlc1swXS5jbGllbnRYKTsKICAgIH07CiAgICB1c2VFZmZlY3QoKCkgPT4gewogICAgICAgIGNvbnN0IGhhbmRsZVdpbmRvd01vdmUgPSAoZSkgPT4gewogICAgICAgICAgICBpZiAoaXNEcmFnZ2luZykKICAgICAgICAgICAgICAgIGhhbmRsZU1vdmUoZS5jbGllbnRYKTsKICAgICAgICB9OwogICAgICAgIGNvbnN0IGhhbmRsZVdpbmRvd1VwID0gKCkgPT4gc2V0SXNEcmFnZ2luZyhmYWxzZSk7CiAgICAgICAgY29uc3QgaGFuZGxlVG91Y2hNb3ZlID0gKGUpID0+IHsKICAgICAgICAgICAgaWYgKGlzRHJhZ2dpbmcpCiAgICAgICAgICAgICAgICBoYW5kbGVNb3ZlKGUudG91Y2hlc1swXS5jbGllbnRYKTsKICAgICAgICB9OwogICAgICAgIGlmIChpc0RyYWdnaW5nKSB7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVXaW5kb3dNb3ZlKTsKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVUb3VjaE1vdmUpOwogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVXaW5kb3dNb3ZlKTsKICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVUb3VjaE1vdmUpOwogICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgfTsKICAgIH0sIFtpc0RyYWdnaW5nXSk7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IHJlZjogY29udGFpbmVyUmVmLCBjbGFzc05hbWU6ICJyZWxhdGl2ZSB3LWZ1bGwgaC05NiByb3VuZGVkLXhsIG92ZXJmbG93LWhpZGRlbiBjdXJzb3ItY29sLXJlc2l6ZSBzZWxlY3Qtbm9uZSBzaGFkb3ctc20gYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgZ3JvdXAgdG91Y2gtbm9uZSBwcmludDpoaWRkZW4iLCBvbk1vdXNlRG93bjogb25Nb3VzZURvd24sIG9uVG91Y2hTdGFydDogb25Ub3VjaFN0YXJ0LCBjaGlsZHJlbjogW19qc3goImltZyIsIHsgc3JjOiBvdmVybGF5LCBjbGFzc05hbWU6ICJhYnNvbHV0ZSBpbnNldC0wIHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIiwgYWx0OiAiQW5hbHlzaXMiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC00IHJpZ2h0LTQgYmctYmx1ZS05MDAvODAgdGV4dC13aGl0ZSB0ZXh0LXhzIGZvbnQtYm9sZCBweC0yIHB5LTEgcm91bmRlZCBiYWNrZHJvcC1ibHVyLXNtIHBvaW50ZXItZXZlbnRzLW5vbmUgei0xMCIsIGNoaWxkcmVuOiBsYWJlbE92ZXJsYXkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGluc2V0LTAgdy1mdWxsIGgtZnVsbCBvdmVyZmxvdy1oaWRkZW4iLCBzdHlsZTogeyBjbGlwUGF0aDogYGluc2V0KDAgJHsxMDAgLSBzbGlkZXJQb3NpdGlvbn0lIDAgMClgIH0sIGNoaWxkcmVuOiBbX2pzeCgiaW1nIiwgeyBzcmM6IG9yaWdpbmFsLCBjbGFzc05hbWU6ICJhYnNvbHV0ZSBpbnNldC0wIHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIiwgYWx0OiAiT3JpZ2luYWwiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC00IGxlZnQtNCBiZy1zbGF0ZS05MDAvODAgdGV4dC13aGl0ZSB0ZXh0LXhzIGZvbnQtYm9sZCBweC0yIHB5LTEgcm91bmRlZCBiYWNrZHJvcC1ibHVyLXNtIHBvaW50ZXItZXZlbnRzLW5vbmUiLCBjaGlsZHJlbjogbGFiZWxPcmlnaW5hbCB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTAgYm90dG9tLTAgdy0wLjUgYmctd2hpdGUgY3Vyc29yLWNvbC1yZXNpemUgei0yMCBvdmVybGF5LXNsaWRlci1oYW5kbGUiLCBzdHlsZTogeyBsZWZ0OiBgJHtzbGlkZXJQb3NpdGlvbn0lYCB9LCBjaGlsZHJlbjogX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMS8yIGxlZnQtMS8yIC10cmFuc2xhdGUteC0xLzIgLXRyYW5zbGF0ZS15LTEvMiB3LTggaC04IGJnLXdoaXRlIHJvdW5kZWQtZnVsbCBzaGFkb3ctbGcgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1ibHVlLTYwMCBib3JkZXIgYm9yZGVyLXNsYXRlLTEwMCIsIGNoaWxkcmVuOiBfanN4KEdyaXBWZXJ0aWNhbCwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSBib3R0b20tNCBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIGJnLWJsYWNrLzQwIHRleHQtd2hpdGUgdGV4dC1bMTBweF0gZm9udC1ib2xkIHB4LTMgcHktMSByb3VuZGVkLWZ1bGwgYmFja2Ryb3AtYmx1ci1zbSBwb2ludGVyLWV2ZW50cy1ub25lIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHkiLCBjaGlsZHJlbjogIkRyYWcgdG8gY29tcGFyZSIgfSldIH0pKTsKfTsKZnVuY3Rpb24gQW5hbHlzaXNEaXNwbGF5KHsgYW5hbHlzaXMsIGNvbXBhY3QgPSBmYWxzZSwgaGlkZUl0ZW1zID0gZmFsc2UgfSkgewogICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIEZhY2lsaXR5IEluc3BlY3Rpb24gcmVzdWx0IChoYXMgZGV0YWlsZWRGaW5kaW5ncykKICAgIGNvbnN0IGlzRmFjaWxpdHkgPSAhIWFuYWx5c2lzLmRldGFpbGVkRmluZGluZ3M7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHNwYWNlLXktNCBwcmludDpzcGFjZS15LTMgJHtjb21wYWN0ID8gJ3RleHQteHMnIDogJyd9YCwgY2hpbGRyZW46IFshY29tcGFjdCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHAtNCBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQtc2VjdGlvbi1ib3JkZXIiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC00IiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6IGB0ZXh0LTN4bCBmb250LWJvbGQgJHtnZXRTY29yZUNvbG9yKGFuYWx5c2lzLnNjb3JlKX1gLCBjaGlsZHJlbjogW2FuYWx5c2lzLnNjb3JlLCAiLzEwMCJdIH0pLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiQ29tcGxpYW5jZSBTY29yZSIgfSksIGFuYWx5c2lzLmNhdGVnb3J5ICYmIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtaW5kaWdvLTYwMCBiZy1pbmRpZ28tNTAgcHgtMiBweS0wLjUgcm91bmRlZCBib3JkZXIgYm9yZGVyLWluZGlnby0xMDAgbXQtMSBpbmxpbmUtYmxvY2siLCBjaGlsZHJlbjogYW5hbHlzaXMuY2F0ZWdvcnkgfSkpXSB9KV0gfSksIGFuYWx5c2lzLnJpc2tMZXZlbCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgcHgtMyBweS0xIHJvdW5kZWQgdGV4dC14cyBmb250LWJvbGQgdXBwZXJjYXNlIGJvcmRlciAke2FuYWx5c2lzLnJpc2tMZXZlbCA9PT0gJ0hpZ2gnID8gJ2JnLXJlZC0xMDAgdGV4dC1yZWQtNzAwIGJvcmRlci1yZWQtMjAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmFseXNpcy5yaXNrTGV2ZWwgPT09ICdNZWRpdW0nID8gJ2JnLW9yYW5nZS0xMDAgdGV4dC1vcmFuZ2UtNzAwIGJvcmRlci1vcmFuZ2UtMjAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTcwMCBib3JkZXItZ3JlZW4tMjAwJ31gLCBjaGlsZHJlbjogW2FuYWx5c2lzLnJpc2tMZXZlbCwgIiBSaXNrIl0gfSkpXSB9KSksIGlzRmFjaWxpdHkgPyAoCiAgICAgICAgICAgIC8vIEZBQ0lMSVRZIE1PREU6IERldGFpbGVkIEZpbmRpbmdzIFRhYmxlCiAgICAgICAgICAgIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgb3ZlcmZsb3ctaGlkZGVuIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTUwIHAtMiBib3JkZXItYiBib3JkZXItc2xhdGUtMjAwIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB0ZXh0LXhzIHVwcGVyY2FzZSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LWJsYWNrIiwgY2hpbGRyZW46IFtfanN4KENsaXBib2FyZENoZWNrLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIEluc3BlY3Rpb24gRmluZGluZ3MiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkaXZpZGUteSBkaXZpZGUtc2xhdGUtMTAwIiwgY2hpbGRyZW46IGFuYWx5c2lzLmRldGFpbGVkRmluZGluZ3M/Lm1hcCgoZmluZGluZywgaSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtMyB0ZXh0LXNtIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0xIiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6IGBmb250LWJvbGQgJHtmaW5kaW5nLnR5cGUgPT09ICdHb29kIGNvbmRpdGlvbicgPyAndGV4dC1ncmVlbi03MDAnIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZGluZy50eXBlID09PSAnU2FmZXR5IGhhemFyZCcgPyAndGV4dC1yZWQtNzAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kaW5nLnR5cGUgPT09ICdNYWpvciBkZWZlY3QnID8gJ3RleHQtcmVkLTYwMCcgOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRpbmcudHlwZSA9PT0gJ01pbm9yIGlzc3VlJyA/ICd0ZXh0LW9yYW5nZS02MDAnIDogJ3RleHQtc2xhdGUtNzAwJ31gLCBjaGlsZHJlbjogZmluZGluZy50eXBlIH0pLCBmaW5kaW5nLnJpc2sgIT09ICdOb25lJyAmJiAoX2pzeHMoInNwYW4iLCB7IGNsYXNzTmFtZTogYHRleHQtWzEwcHhdIHVwcGVyY2FzZSBmb250LWJvbGQgcHgtMS41IHB5LTAuNSByb3VuZGVkICR7ZmluZGluZy5yaXNrID09PSAnSGlnaCcgPyAnYmctcmVkLTEwMCB0ZXh0LXJlZC04MDAnIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZGluZy5yaXNrID09PSAnTWVkaXVtJyA/ICdiZy1vcmFuZ2UtMTAwIHRleHQtb3JhbmdlLTgwMCcgOiAnYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwJ31gLCBjaGlsZHJlbjogW2ZpbmRpbmcucmlzaywgIiBSaXNrIl0gfSkpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTgwMCBtYi0xIiwgY2hpbGRyZW46IGZpbmRpbmcuaXNzdWUgfSksIGZpbmRpbmcucmVjb21tZW5kYXRpb24gJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNTAwIHRleHQteHMgaXRhbGljIGJnLXNsYXRlLTUwIHAtMS41IHJvdW5kZWQgZmxleCBnYXAtMSIsIGNoaWxkcmVuOiBbX2pzeChBcnJvd1JpZ2h0LCB7IGNsYXNzTmFtZTogInctMyBoLTMgbXQtMC41IHNocmluay0wIiB9KSwgIiAiLCBmaW5kaW5nLnJlY29tbWVuZGF0aW9uXSB9KSldIH0sIGkpKSkgfSldIH0pKSA6ICgKICAgICAgICAgICAgLy8gU1RBTkRBUkQgTU9ERTogSGF6YXJkcyBMaXN0CiAgICAgICAgICAgIGFuYWx5c2lzLmhhemFyZHMubGVuZ3RoID4gMCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgcC00IGJnLXJlZC01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItcmVkLTEwMCBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LXJlZC05MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiAke2NvbXBhY3QgPyAndGV4dC1zbScgOiAnJ30gcHJpbnQ6dGV4dC1zbGF0ZS04MDAgcHJpbnQ6dXBwZXJjYXNlIHByaW50OnRleHQteHNgLCBjaGlsZHJlbjogW19qc3goQWxlcnRUcmlhbmdsZSwgeyBjbGFzc05hbWU6IGNvbXBhY3QgPyAidy0zIGgtMyIgOiAidy00IGgtNCIgfSksICIgSWRlbnRpZmllZCBSaXNrcyJdIH0pLCBfanN4KCJ1bCIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xIHByaW50OnNwYWNlLXktMSIsIGNoaWxkcmVuOiBhbmFseXNpcy5oYXphcmRzLm1hcCgoaCwgaSkgPT4gKF9qc3hzKCJsaSIsIHsgY2xhc3NOYW1lOiBgdGV4dC1yZWQtODAwIGZsZXggaXRlbXMtc3RhcnQgZ2FwLTIgJHtjb21wYWN0ID8gJ3RleHQteHMnIDogJ3RleHQtc20nfSBwcmludDp0ZXh0LXNsYXRlLTcwMGAsIGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAibXQtMS41IHctMS41IGgtMS41IGJnLXJlZC00MDAgcm91bmRlZC1mdWxsIGZsZXgtc2hyaW5rLTAgcHJpbnQ6Ymctc2xhdGUtNDAwIiB9KSwgX2pzeCgic3BhbiIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9faHRtbDogaC5yZXBsYWNlKC9cKlwqKC4qPylcKlwqL2csICc8c3Ryb25nPiQxPC9zdHJvbmc+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KV0gfSwgaSkpKSB9KV0gfSkpKSwgIWlzRmFjaWxpdHkgJiYgYW5hbHlzaXMucmVjb21tZW5kZWRJdGVtcyAmJiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLmxlbmd0aCA+IDAgJiYgIWNvbXBhY3QgJiYgIWhpZGVJdGVtcyAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC00IGJnLWVtZXJhbGQtNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWVtZXJhbGQtMTAwIHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtZW1lcmFsZC05MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LXNsYXRlLTgwMCBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14cyIsIGNoaWxkcmVuOiBbX2pzeChTaG9wcGluZ0JhZywgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSwgIiBSZXF1aXJlZCBTYWZldHkgSXRlbXMiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIGdhcC0yIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciB0ZXh0LXNtIGJnLXdoaXRlIHAtMiByb3VuZGVkIGJvcmRlciBib3JkZXItZW1lcmFsZC0xMDAiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtZW1lcmFsZC04MDAiLCBjaGlsZHJlbjogaXRlbS5pdGVtIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIGJsb2NrIiwgY2hpbGRyZW46IGl0ZW0ucmVhc29uIH0pXSB9KSwgX2pzeHMoInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtMTAwIHRleHQtZW1lcmFsZC04MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCB3aGl0ZXNwYWNlLW5vd3JhcCIsIGNoaWxkcmVuOiBbIlF0eTogIiwgaXRlbS5xdWFudGl0eV0gfSldIH0sIGkpKSkgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiaGlkZGVuIHByaW50OmJsb2NrIiwgY2hpbGRyZW46IF9qc3hzKCJ0YWJsZSIsIHsgY2xhc3NOYW1lOiAicHJpbnQtdGFibGUiLCBjaGlsZHJlbjogW19qc3goInRoZWFkIiwgeyBjaGlsZHJlbjogX2pzeHMoInRyIiwgeyBjaGlsZHJlbjogW19qc3goInRoIiwgeyBjaGlsZHJlbjogIkl0ZW0gLyBFcXVpcG1lbnQiIH0pLCBfanN4KCJ0aCIsIHsgY2hpbGRyZW46ICJRdHkiIH0pLCBfanN4KCJ0aCIsIHsgY2hpbGRyZW46ICJSZWFzb24iIH0pXSB9KSB9KSwgX2pzeCgidGJvZHkiLCB7IGNoaWxkcmVuOiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gKF9qc3hzKCJ0ciIsIHsgY2hpbGRyZW46IFtfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIiwgY2hpbGRyZW46IGl0ZW0uaXRlbSB9KSwgX2pzeCgidGQiLCB7IGNsYXNzTmFtZTogIndoaXRlc3BhY2Utbm93cmFwIiwgY2hpbGRyZW46IGl0ZW0ucXVhbnRpdHkgfSksIF9qc3goInRkIiwgeyBjbGFzc05hbWU6ICJpdGFsaWMgdGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogaXRlbS5yZWFzb24gfSldIH0sIGkpKSkgfSldIH0pIH0pXSB9KSksIGFuYWx5c2lzLnJlbGV2YW50U3RhbmRhcmRzICYmIGFuYWx5c2lzLnJlbGV2YW50U3RhbmRhcmRzLmxlbmd0aCA+IDAgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHAtNCBiZy1ibHVlLTUwIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ibHVlLTEwMCBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgJHtjb21wYWN0ID8gJ3RleHQtc20nIDogJyd9IHByaW50OnRleHQtc2xhdGUtODAwIHByaW50OnVwcGVyY2FzZSBwcmludDp0ZXh0LXhzYCwgY2hpbGRyZW46IFtfanN4KEdhdmVsLCB7IGNsYXNzTmFtZTogY29tcGFjdCA/ICJ3LTMgaC0zIiA6ICJ3LTQgaC00IiB9KSwgIiBBcHBsaWNhYmxlIExhdyAmIFN0YW5kYXJkcyJdIH0pLCBfanN4KCJ1bCIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0yIHByaW50OnNwYWNlLXktMSIsIGNoaWxkcmVuOiBhbmFseXNpcy5yZWxldmFudFN0YW5kYXJkcy5tYXAoKHMsIGkpID0+IChfanN4cygibGkiLCB7IGNsYXNzTmFtZTogInRleHQtc20gYmctd2hpdGUgcC0yIHJvdW5kZWQgYm9yZGVyIGJvcmRlci1ibHVlLTEwMCBzaGFkb3ctc20gZmxleCBmbGV4LWNvbCBnYXAtMSBwcmludDpib3JkZXItbm9uZSBwcmludDpzaGFkb3ctbm9uZSBwcmludDpiZy10cmFuc3BhcmVudCBwcmludDpwLTAgcHJpbnQ6bWItMSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtYmx1ZS04MDAgZm9udC1tb25vIHRleHQteHMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgcHJpbnQ6dGV4dC1zbGF0ZS04MDAgcHJpbnQ6dGV4dC1bOXB0XSIsIGNoaWxkcmVuOiBbcy5zdGFuZGFyZElkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2xvY2FsJykgPyAoX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYmctaW5kaWdvLTEwMCB0ZXh0LWluZGlnby03MDAgcHgtMS41IHB5LTAuNSByb3VuZGVkLVszcHhdIHRleHQtWzEwcHhdIHVwcGVyY2FzZSB0cmFja2luZy13aWRlciBwcmludDpib3JkZXIgcHJpbnQ6Ym9yZGVyLXNsYXRlLTQwMCBwcmludDpiZy13aGl0ZSBwcmludDp0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiTG9jYWwgTGF3IiB9KSkgOiAoX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNjAwIHB4LTEuNSBweS0wLjUgcm91bmRlZC1bM3B4XSB0ZXh0LVsxMHB4XSB1cHBlcmNhc2UgdHJhY2tpbmctd2lkZXIgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS00MDAgcHJpbnQ6Ymctd2hpdGUgcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkludGwuIFN0ZCIgfSkpLCBzLnN0YW5kYXJkSWQucmVwbGFjZSgvXFsuKj9cXS9nLCAnJykudHJpbSgpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTcwMCBsZWFkaW5nLXNudWcgcHJpbnQ6cGwtMCIsIGNoaWxkcmVuOiBzLmRlc2NyaXB0aW9uIH0pXSB9LCBpKSkpIH0pXSB9KSksIGFuYWx5c2lzLm1pc3NpbmdEb2N1bWVudHMgJiYgYW5hbHlzaXMubWlzc2luZ0RvY3VtZW50cy5sZW5ndGggPiAwICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6IGBwLTQgYmctYW1iZXItNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWFtYmVyLTEwMCBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWFtYmVyLTkwMCBtYi0yIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yICR7Y29tcGFjdCA/ICd0ZXh0LXNtJyA6ICcnfSBwcmludDp0ZXh0LXNsYXRlLTgwMCBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14c2AsIGNoaWxkcmVuOiBbX2pzeChGaWxlVGV4dCwgeyBjbGFzc05hbWU6IGNvbXBhY3QgPyAidy0zIGgtMyIgOiAidy00IGgtNCIgfSksICIgQXVkaXQgRG9jdW1lbnRhdGlvbiBHYXBzIl0gfSksIF9qc3goInVsIiwgeyBjbGFzc05hbWU6ICJsaXN0LWRpc2MgcGwtNSBzcGFjZS15LTEgcHJpbnQ6cGwtNCIsIGNoaWxkcmVuOiBhbmFseXNpcy5taXNzaW5nRG9jdW1lbnRzLm1hcCgoZG9jLCBpKSA9PiAoX2pzeCgibGkiLCB7IGNsYXNzTmFtZTogYHRleHQtYW1iZXItODAwICR7Y29tcGFjdCA/ICd0ZXh0LXhzJyA6ICd0ZXh0LXNtJ30gcHJpbnQ6dGV4dC1zbGF0ZS03MDBgLCBjaGlsZHJlbjogZG9jIH0sIGkpKSkgfSldIH0pKSwgIWNvbXBhY3QgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQtbm8tYnJlYWsiLCBjaGlsZHJlbjogW19qc3goImgzIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgbWItMSBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14cyIsIGNoaWxkcmVuOiAiQXNzZXNzbWVudCBTdW1tYXJ5IiB9KSwgX2pzeHMoInAiLCB7IGNsYXNzTmFtZTogInRleHQtc20gdGV4dC1zbGF0ZS02MDAgaXRhbGljIiwgY2hpbGRyZW46IFsiXCIiLCBhbmFseXNpcy5zdW1tYXJ5LCAiXCIiXSB9KV0gfSkpXSB9KSk7Cn0KZnVuY3Rpb24gZ2V0U2NvcmVDb2xvcihzY29yZSkgewogICAgaWYgKHNjb3JlID49IDgwKQogICAgICAgIHJldHVybiAndGV4dC1ncmVlbi02MDAnOwogICAgaWYgKHNjb3JlID49IDUwKQogICAgICAgIHJldHVybiAndGV4dC1vcmFuZ2UtNTAwJzsKICAgIHJldHVybiAndGV4dC1yZWQtNjAwJzsKfQpmdW5jdGlvbiBRckhlYWRlcih7IHRpdGxlLCBzdWJUaXRsZSwgc2l0ZU5hbWUsIGNvbXBhbnlOYW1lLCBpbnNwZWN0b3JOYW1lLCBkYXRlLCBsb2dvLCB0aGVtZUNvbG9yIH0pIHsKICAgIC8vIFVzZSB0aGUgc3BlY2lmaWMgcHJvZHVjdGlvbiBVUkwgcHJvdmlkZWQgYnkgdGhlIHVzZXIKICAgIGNvbnN0IGJhc2VVcmwgPSAiaHR0cHM6Ly9jb21wbGlhbmNlLWluc3BlY3Rvci0yNDEwNjc1MzEyMDYudXMtd2VzdDEucnVuLmFwcC8iOwogICAgLy8gQ29uc3RydWN0IGEgZnVuY3Rpb25hbCBVUkwgdGhhdCBpbmNsdWRlcyBjb250ZXh0CiAgICBjb25zdCBxclBheWxvYWQgPSBgJHtiYXNlVXJsfT9yZXBvcnQ9JHtlbmNvZGVVUklDb21wb25lbnQodGl0bGUpfSZzaXRlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHNpdGVOYW1lKX0mZGF0ZT0ke2VuY29kZVVSSUNvbXBvbmVudChkYXRlKX1gOwogICAgLy8gTGFyZ2VyIHNpemUgZm9yIGJldHRlciBzY2FubmluZyByZWxpYWJpbGl0eSB3aGVuIHByaW50ZWQKICAgIGNvbnN0IHFyVXJsID0gYGh0dHBzOi8vYXBpLnFyc2VydmVyLmNvbS92MS9jcmVhdGUtcXItY29kZS8/c2l6ZT0xNTB4MTUwJmRhdGE9JHtlbmNvZGVVUklDb21wb25lbnQocXJQYXlsb2FkKX1gOwogICAgY29uc3QgcHJpbWFyeUNvbG9yID0gdGhlbWVDb2xvciB8fCAnIzBmMTcyYSc7IC8vIERlZmF1bHQgc2xhdGUtOTAwCiAgICAvLyBDaGVjayBpZiB3ZSBhcmUgaW4gRmFjaWxpdHkgbW9kZSB0byBjaGFuZ2UgdGhlIEFwcCBUaXRsZQogICAgY29uc3QgaXNGYWNpbGl0eSA9IHN1YlRpdGxlLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgY29uc3QgYXBwVGl0bGUgPSBpc0ZhY2lsaXR5ID8gIkluc3BlY3QzNjBQcm86IEZhY2lsaXR5IFZpc3VhbCBJbnNwZWN0aW9uIiA6ICJDb21wbGlhbmNlIEluc3BlY3RvciI7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJvcmRlci1iLTIgcGItNCBtYi02IHByaW50Om1iLTgiLCBzdHlsZTogeyBib3JkZXJDb2xvcjogcHJpbWFyeUNvbG9yIH0sIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCIsIGNoaWxkcmVuOiBbbG9nbyA/IChfanN4KCJpbWciLCB7IHNyYzogbG9nbywgYWx0OiAiQ29tcGFueSBMb2dvIiwgY2xhc3NOYW1lOiAiaC0xNiB3LWF1dG8gb2JqZWN0LWNvbnRhaW4gbWF4LXctWzEyMHB4XSBwcmludDpibG9jayIgfSkpIDogKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy0xNiBoLTE2IHJvdW5kZWQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC13aGl0ZSBwcmludDpoaWRkZW4iLCBzdHlsZTogeyBiYWNrZ3JvdW5kQ29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogaXNGYWNpbGl0eSA/IF9qc3goQ2xpcGJvYXJkQ2hlY2ssIHsgY2xhc3NOYW1lOiAidy0xMCBoLTEwIiB9KSA6IF9qc3goU2hpZWxkLCB7IGNsYXNzTmFtZTogInctMTAgaC0xMCIgfSkgfSkpLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImgxIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTN4bCBmb250LWJvbGQgdXBwZXJjYXNlIHRyYWNraW5nLXRpZ2h0IHByaW50OnRleHQtMnhsIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogYXBwVGl0bGUgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1sZyBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgcHJpbnQ6dGV4dC1ibGFjayIsIGNoaWxkcmVuOiBjb21wYW55TmFtZSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIGZvbnQtbWVkaXVtIHByaW50OnRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46IHNpdGVOYW1lIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC1jb2wgaXRlbXMtZW5kIGdhcC0yIiwgY2hpbGRyZW46IFtfanN4KCJpbWciLCB7IHNyYzogcXJVcmwsIGFsdDogIlNjYW4gZm9yIERpZ2l0YWwgUmVwb3J0IiwgY2xhc3NOYW1lOiAidy0yNCBoLTI0IGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHAtMSBibG9jayBwcmludDpib3JkZXItYmxhY2siIH0pLCBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1bMTBweF0gdGV4dC1zbGF0ZS01MDAgZm9udC1tb25vIHRleHQtcmlnaHQgdy0yNCBsZWFkaW5nLXRpZ2h0IHByaW50OnRleHQtYmxhY2siLCBjaGlsZHJlbjogWyJTY2FuIGZvciIsIF9qc3goImJyIiwge30pLCAiRGlnaXRhbCBSZXBvcnQiXSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC00IGdyaWQgZ3JpZC1jb2xzLTQgZ2FwLTQgdGV4dC14cyB0ZXh0LXNsYXRlLTYwMCBmb250LW1vbm8gYm9yZGVyLXQgYm9yZGVyLXNsYXRlLTIwMCBwdC0yIHByaW50OmJvcmRlci1zbGF0ZS00MDAgcHJpbnQ6dGV4dC1ibGFjayIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBibG9jayB1cHBlcmNhc2UgdGV4dC1bMTBweF0gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkluc3BlY3RvciIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCIsIGNoaWxkcmVuOiBpbnNwZWN0b3JOYW1lIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBibG9jayB1cHBlcmNhc2UgdGV4dC1bMTBweF0gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkRhdGUiIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQiLCBjaGlsZHJlbjogZGF0ZSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS00MDAgYmxvY2sgdXBwZXJjYXNlIHRleHQtWzEwcHhdIHByaW50OnRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46ICJTY29wZSIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCIsIGNoaWxkcmVuOiBzdWJUaXRsZSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtcmlnaHQiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNDAwIGJsb2NrIHVwcGVyY2FzZSB0ZXh0LVsxMHB4XSBwcmludDp0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiUmVmIiB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIiwgY2hpbGRyZW46IHRpdGxlIH0pXSB9KV0gfSldIH0pKTsKfQovLyAtLS0gTWFpbiBBcHAgLS0tCmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbXBsaWFuY2VJbnNwZWN0b3JBcHAoKSB7CiAgICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IHVzZVN0YXRlKHsKICAgICAgICB2aWV3OiAnc2V0dXAnLAogICAgICAgIHNjb3BlOiBbJ09IUyddLAogICAgICAgIGNvbXBhbnlOYW1lOiAnJywKICAgICAgICBzaXRlTmFtZTogJycsCiAgICAgICAgaW5zcGVjdG9yTmFtZTogJycsCiAgICAgICAgY29tcGFueUxvZ286IG51bGwsCiAgICAgICAgaW5zcGVjdGlvbkRhdGU6IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCksCiAgICAgICAgZ2VvTG9jYXRpb246ICcnLAogICAgICAgIHJvb21zOiBbXSwKICAgICAgICBhY3RpdmVSb29tSWQ6IG51bGwsCiAgICAgICAgc3RhZ2luZ0ltYWdlczogW10sCiAgICAgICAgc3RhZ2luZ1Jvb21OYW1lOiAnJywKICAgICAgICBzdGFnaW5nRGVwYXJ0bWVudDogJycsCiAgICAgICAgc3RhZ2luZ0dlbmVyYXRlUGxhbjogZmFsc2UsCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgbG9hZGluZ01lc3NhZ2U6ICcnLAogICAgICAgIGxvZ3M6IFtdLAogICAgICAgIHNob3dMb2dzOiBmYWxzZQogICAgfSk7CiAgICAvLyBIZWxwZXIgdG8gbG9nIGFjdGl2aXRpZXMKICAgIGNvbnN0IGFkZExvZyA9IChhY3Rpb24sIGRldGFpbHMgPSAnJywgdHlwZSA9ICdpbmZvJykgPT4gewogICAgICAgIHNldFN0YXRlKHMgPT4gKHsKICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgbG9nczogW3sKICAgICAgICAgICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLAogICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICBhY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgZGV0YWlscywKICAgICAgICAgICAgICAgICAgICB0eXBlCiAgICAgICAgICAgICAgICB9LCAuLi5zLmxvZ3NdCiAgICAgICAgfSkpOwogICAgfTsKICAgIGNvbnN0IFtjdXN0b21RdWVyeSwgc2V0Q3VzdG9tUXVlcnldID0gdXNlU3RhdGUoJycpOwogICAgY29uc3QgZmlsZUlucHV0UmVmID0gdXNlUmVmKG51bGwpOwogICAgY29uc3QgY2FtZXJhSW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7CiAgICBjb25zdCBsb2dvSW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7CiAgICAvLyBBdXRvLWRldGVjdCBHZW9Mb2NhdGlvbiBvbiBNb3VudAogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBkZXRlY3RMb2NhdGlvbigpOwogICAgfSwgW10pOwogICAgY29uc3QgZGV0ZWN0TG9jYXRpb24gPSAoKSA9PiB7CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogJ0RldGVjdGluZy4uLicgfSkpOwogICAgICAgIGlmICgiZ2VvbG9jYXRpb24iIGluIG5hdmlnYXRvcikgewogICAgICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKChwb3NpdGlvbikgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbG9jID0gYCR7cG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLnRvRml4ZWQoNSl9LCAke3Bvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUudG9GaXhlZCg1KX1gOwogICAgICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogbG9jIH0pKTsKICAgICAgICAgICAgICAgIC8vIE5vdGU6IGNhbid0IGFjY2VzcyBhZGRMb2cgZGlyZWN0bHkgaGVyZSBkdWUgdG8gY2xvc3VyZSwgYnV0IHdlIGFyZSBzZXR0aW5nIHN0YXRlCiAgICAgICAgICAgIH0sIChlcnJvcikgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiR2VvTG9jYXRpb24gRXJyb3I6IiwgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGdlb0xvY2F0aW9uOiBzLmdlb0xvY2F0aW9uID09PSAnRGV0ZWN0aW5nLi4uJyA/ICcnIDogcy5nZW9Mb2NhdGlvbiB9KSk7CiAgICAgICAgICAgIH0sIHsgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLCB0aW1lb3V0OiA1MDAwLCBtYXhpbXVtQWdlOiAwIH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJHZW9sb2NhdGlvbiBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci4iKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogJycgfSkpOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBzZXRWaWV3ID0gKHZpZXcpID0+IHsKICAgICAgICBzZXRTdGF0ZShzID0+IHsKICAgICAgICAgICAgLy8gTG9nIHJlcG9ydCBnZW5lcmF0aW9uIHNwZWNpZmljYWxseQogICAgICAgICAgICBsZXQgbmV3TG9ncyA9IHMubG9nczsKICAgICAgICAgICAgaWYgKHZpZXcgPT09ICdyZXBvcnQnKSB7CiAgICAgICAgICAgICAgICBuZXdMb2dzID0gW3sKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdSZXBvcnQgR2VuZXJhdGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYFZpZXdpbmcgcmVwb3J0IGZvciAke3Mucm9vbXMubGVuZ3RofSBhcmVhcy4gU2NvcGU6ICR7cy5zY29wZS5qb2luKCcsICcpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJwogICAgICAgICAgICAgICAgICAgIH0sIC4uLnMubG9nc107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHsgLi4ucywgdmlldywgbG9nczogbmV3TG9ncyB9OwogICAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHRvZ2dsZVNjb3BlID0gKHNjb3BlKSA9PiB7CiAgICAgICAgc2V0U3RhdGUocyA9PiB7CiAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBzLnNjb3BlLmluY2x1ZGVzKHNjb3BlKTsKICAgICAgICAgICAgbGV0IG5ld1Njb3BlID0gcy5zY29wZTsKICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIG5ld1Njb3BlID0gcy5zY29wZS5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSBzY29wZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAocy5zY29wZS5sZW5ndGggPj0gMikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gczsgLy8gTGltaXQgdG8gMiBzY29wZXMKICAgICAgICAgICAgICAgIG5ld1Njb3BlID0gWy4uLnMuc2NvcGUsIHNjb3BlXTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4geyAuLi5zLCBzY29wZTogbmV3U2NvcGUgfTsKICAgICAgICB9KTsKICAgIH07CiAgICBjb25zdCBoYW5kbGVTdGFydFNlc3Npb24gPSAoKSA9PiB7CiAgICAgICAgaWYgKCFzdGF0ZS5zaXRlTmFtZSB8fCAhc3RhdGUuY29tcGFueU5hbWUgfHwgIXN0YXRlLmluc3BlY3Rvck5hbWUpIHsKICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBmaWxsIGluIENvbXBhbnksIEZhY2lsaXR5LCBhbmQgSW5zcGVjdG9yIG5hbWVzIHRvIHN0YXJ0LiIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzdGF0ZS5zY29wZS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYXQgbGVhc3Qgb25lIGluc3BlY3Rpb24gc2NvcGUuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYWRkTG9nKCdTZXNzaW9uIEluaXRpYWxpemVkJywgYEluc3BlY3RvcjogJHtzdGF0ZS5pbnNwZWN0b3JOYW1lfSwgU2l0ZTogJHtzdGF0ZS5zaXRlTmFtZX0sIFNjb3BlOiAke3N0YXRlLnNjb3BlLmpvaW4oJywgJyl9YCk7CiAgICAgICAgc2V0VmlldygnZGFzaGJvYXJkJyk7CiAgICB9OwogICAgY29uc3QgaGFuZGxlTG9nb1NlbGVjdCA9IChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzICYmIGUudGFyZ2V0LmZpbGVzWzBdKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChldikgPT4gewogICAgICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBjb21wYW55TG9nbzogZXYudGFyZ2V0Py5yZXN1bHQgfSkpOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgaGFuZGxlSW1hZ2VTZWxlY3QgPSAoZSkgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5maWxlcykgewogICAgICAgICAgICBjb25zdCBuZXdGaWxlcyA9IEFycmF5LmZyb20oZS50YXJnZXQuZmlsZXMpOwogICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7CiAgICAgICAgICAgICAgICAuLi5zLAogICAgICAgICAgICAgICAgdmlldzogJ3N0YWdpbmcnLAogICAgICAgICAgICAgICAgc3RhZ2luZ0ltYWdlczogWy4uLnMuc3RhZ2luZ0ltYWdlcywgLi4ubmV3RmlsZXNdLAogICAgICAgICAgICAgICAgc3RhZ2luZ1Jvb21OYW1lOiBzLnN0YWdpbmdSb29tTmFtZSB8fCBgQXJlYSAke3Mucm9vbXMubGVuZ3RoICsgMX1gCiAgICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgaGFuZGxlU2F2ZVN0YWdpbmcgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgaWYgKHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoID09PSAwKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiB0cnVlLCBsb2FkaW5nTWVzc2FnZTogJ1NhdmluZyBhcmVhIHRvIGluc3BlY3Rpb24gcXVldWUuLi4nIH0pKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBjYXB0dXJlcyA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBzdGF0ZS5zdGFnaW5nSW1hZ2VzW2ldOwogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0RGF0YSA9IGF3YWl0IGZpbGVUb0Jhc2U2NChmaWxlKTsKICAgICAgICAgICAgICAgIGNhcHR1cmVzLnB1c2goewogICAgICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpICsgJy0nICsgaSwKICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEltYWdlOiBgZGF0YToke2ZpbGUudHlwZX07YmFzZTY0LCR7YmFzZTY0RGF0YX1gLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgbmV3Um9vbSA9IHsKICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBuYW1lOiBzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsCiAgICAgICAgICAgICAgICBkZXBhcnRtZW50OiBzdGF0ZS5zdGFnaW5nRGVwYXJ0bWVudCB8fCAnR2VuZXJhbCcsCiAgICAgICAgICAgICAgICBjYXB0dXJlczogY2FwdHVyZXMsCiAgICAgICAgICAgICAgICBnZW5lcmF0ZVBsYW5SZXF1ZXN0OiBzdGF0ZS5zdGFnaW5nR2VuZXJhdGVQbGFuLAogICAgICAgICAgICAgICAgY3VzdG9tQ2hlY2tzOiBbXSwKICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGFkZExvZygnQXJlYSBBZGRlZCcsIGBBZGRlZCAiJHtuZXdSb29tLm5hbWV9IiB3aXRoICR7Y2FwdHVyZXMubGVuZ3RofSBpbWFnZXMuIFBsYW4gUmVxdWVzdGVkOiAke3N0YXRlLnN0YWdpbmdHZW5lcmF0ZVBsYW59YCwgJ2luZm8nKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoewogICAgICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgICAgIHJvb21zOiBbLi4ucy5yb29tcywgbmV3Um9vbV0sCiAgICAgICAgICAgICAgICBzdGFnaW5nSW1hZ2VzOiBbXSwKICAgICAgICAgICAgICAgIHN0YWdpbmdSb29tTmFtZTogJycsCiAgICAgICAgICAgICAgICBzdGFnaW5nRGVwYXJ0bWVudDogJycsCiAgICAgICAgICAgICAgICBzdGFnaW5nR2VuZXJhdGVQbGFuOiBmYWxzZSwKICAgICAgICAgICAgICAgIHZpZXc6ICdkYXNoYm9hcmQnLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgIGFsZXJ0KCdGYWlsZWQgdG8gc2F2ZSBhcmVhLicpOwogICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGxvYWRpbmc6IGZhbHNlIH0pKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgYW5hbHl6ZVJvb20gPSBhc3luYyAocm9vbSkgPT4gewogICAgICAgIGxldCBldmFjdWF0aW9uUGxhblVyaSA9IHJvb20uZXZhY3VhdGlvblBsYW47CiAgICAgICAgYWRkTG9nKCdBSSBBbmFseXNpcyBTdGFydGVkJywgYEFuYWx5emluZyByb29tOiAiJHtyb29tLm5hbWV9IiAoJHtyb29tLmNhcHR1cmVzLmxlbmd0aH0gdmlld3BvaW50cykuIE1vZGVsOiBnZW1pbmktMi41LWZsYXNoYCwgJ2FpJyk7CiAgICAgICAgLy8gR2VuZXJhdGUgRXZhY3VhdGlvbiBQbGFuIGlmIHJlcXVlc3RlZCBhbmQgbm90IGFscmVhZHkgcHJlc2VudAogICAgICAgIGlmIChyb29tLmdlbmVyYXRlUGxhblJlcXVlc3QgJiYgIWV2YWN1YXRpb25QbGFuVXJpICYmIHJvb20uY2FwdHVyZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCBiYXNlNjRGdWxsID0gcm9vbS5jYXB0dXJlc1swXS5vcmlnaW5hbEltYWdlOwogICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gYmFzZTY0RnVsbC5zcGxpdCgnLCcpWzFdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYWRkTG9nKCdQbGFuIEdlbmVyYXRpb24gU3RhcnRlZCcsIGBHZW5lcmF0aW5nIGV2YWN1YXRpb24gcGxhbiBmb3IgJHtyb29tLm5hbWV9Li4uYCwgJ2FpJyk7CiAgICAgICAgICAgICAgICBldmFjdWF0aW9uUGxhblVyaSA9IGF3YWl0IGdlbmVyYXRlRXZhY3VhdGlvblBsYW4oYmFzZTY0RGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlBsYW4gZ2VuZXJhdGlvbiBmYWlsZWQiLCBlKTsKICAgICAgICAgICAgICAgIGFkZExvZygnUGxhbiBHZW5lcmF0aW9uIEZhaWxlZCcsIGBFcnJvciBnZW5lcmF0aW5nIHBsYW4gZm9yICR7cm9vbS5uYW1lfWAsICdlcnJvcicpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnN0IHVwZGF0ZWRDYXB0dXJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJvb20uY2FwdHVyZXMubWFwKGFzeW5jIChjYXB0dXJlKSA9PiB7CiAgICAgICAgICAgIGlmIChjYXB0dXJlLmFuYWx5c2lzKQogICAgICAgICAgICAgICAgcmV0dXJuIGNhcHR1cmU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gY2FwdHVyZS5vcmlnaW5hbEltYWdlLnNwbGl0KCcsJylbMV07CiAgICAgICAgICAgICAgICBjb25zdCBbdGV4dEFuYWx5c2lzLCBvdmVybGF5SW1hZ2VdID0gYXdhaXQgUHJvbWlzZS5hbGwoWwogICAgICAgICAgICAgICAgICAgIHBlcmZvcm1UZXh0QW5hbHlzaXMoYmFzZTY0RGF0YSwgc3RhdGUuc2NvcGUsIHN0YXRlLmdlb0xvY2F0aW9uKSwKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZU92ZXJsYXkoYmFzZTY0RGF0YSwgc3RhdGUuc2NvcGUpCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgLi4uY2FwdHVyZSwKICAgICAgICAgICAgICAgICAgICBhbmFseXNpczogdGV4dEFuYWx5c2lzLAogICAgICAgICAgICAgICAgICAgIG92ZXJsYXlJbWFnZTogb3ZlcmxheUltYWdlLAogICAgICAgICAgICAgICAgICAgIGVycm9yOiB1bmRlZmluZWQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEFuYWx5c2lzIGZhaWxlZCBmb3IgY2FwdHVyZSAke2NhcHR1cmUuaWR9YCwgZSk7CiAgICAgICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gIkFJIEFuYWx5c2lzIGZhaWxlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iOwogICAgICAgICAgICAgICAgaWYgKGUubWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoJzQyOScpKQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiU2VydmljZSBpcyBidXN5IChSYXRlIExpbWl0IEV4Y2VlZGVkKS4gUGxlYXNlIHJldHJ5IGluIGEgbW9tZW50LiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCc1MDMnKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoJzUwMCcpKQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiQUkgU2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHJldHJ5LiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCdTYWZldHknKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkltYWdlIGZsYWdnZWQgYnkgc2FmZXR5IGZpbHRlcnMuIFVuYWJsZSB0byBwcm9jZXNzLiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBgQW5hbHlzaXMgRXJyb3I6ICR7ZS5tZXNzYWdlfWA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIC4uLmNhcHR1cmUsCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yTWVzc2FnZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0pKTsKICAgICAgICBjb25zdCBmYWlsdXJlQ291bnQgPSB1cGRhdGVkQ2FwdHVyZXMuZmlsdGVyKGMgPT4gYy5lcnJvcikubGVuZ3RoOwogICAgICAgIGlmIChmYWlsdXJlQ291bnQgPiAwKSB7CiAgICAgICAgICAgIGFkZExvZygnQUkgQW5hbHlzaXMgQ29tcGxldGUgKFdpdGggRXJyb3JzKScsIGAke2ZhaWx1cmVDb3VudH0vJHt1cGRhdGVkQ2FwdHVyZXMubGVuZ3RofSBpbWFnZXMgZmFpbGVkIHRvIGFuYWx5emUgaW4gJHtyb29tLm5hbWV9LmAsICdlcnJvcicpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYWRkTG9nKCdBSSBBbmFseXNpcyBTdWNjZXNzZnVsJywgYFN1Y2Nlc3NmdWxseSBhbmFseXplZCAke3Jvb20ubmFtZX0uYCwgJ3N1Y2Nlc3MnKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgLi4ucm9vbSwKICAgICAgICAgICAgY2FwdHVyZXM6IHVwZGF0ZWRDYXB0dXJlcywKICAgICAgICAgICAgZXZhY3VhdGlvblBsYW46IGV2YWN1YXRpb25QbGFuVXJpLAogICAgICAgICAgICBzdGF0dXM6ICdhbmFseXplZCcKICAgICAgICB9OwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUJhdGNoQW5hbHl6ZSA9IGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBwZW5kaW5nUm9vbXMgPSBzdGF0ZS5yb29tcy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ3BlbmRpbmcnIHx8IHIuY2FwdHVyZXMuc29tZShjID0+IGMuZXJyb3IpKTsKICAgICAgICBpZiAocGVuZGluZ1Jvb21zLmxlbmd0aCA9PT0gMCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGFkZExvZygnQmF0Y2ggQW5hbHlzaXMgSW5pdGlhdGVkJywgYFF1ZXVlZCAke3BlbmRpbmdSb29tcy5sZW5ndGh9IHJvb21zIGZvciBiYXRjaCBwcm9jZXNzaW5nLmAsICdpbmZvJyk7CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiB0cnVlLCBsb2FkaW5nTWVzc2FnZTogYE9wdGltaXppbmcgd29ya2Zsb3c6IEFuYWx5emluZyAke3BlbmRpbmdSb29tcy5sZW5ndGh9IGFyZWEocykgc2ltdWx0YW5lb3VzbHkuLi5gIH0pKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBhbmFseXplZFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChwZW5kaW5nUm9vbXMubWFwKHJvb20gPT4gYW5hbHl6ZVJvb20ocm9vbSkpKTsKICAgICAgICAgICAgY29uc3QgdXBkYXRlZFJvb21zID0gc3RhdGUucm9vbXMubWFwKHIgPT4gewogICAgICAgICAgICAgICAgY29uc3QgYW5hbHl6ZWQgPSBhbmFseXplZFJlc3VsdHMuZmluZChhciA9PiBhci5pZCA9PT0gci5pZCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYW5hbHl6ZWQgfHwgcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsKICAgICAgICAgICAgICAgIC4uLnMsCiAgICAgICAgICAgICAgICByb29tczogdXBkYXRlZFJvb21zLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBsb2FkaW5nTWVzc2FnZTogJycKICAgICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICBhZGRMb2coJ0JhdGNoIEFuYWx5c2lzIEZhaWxlZCcsICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkIGR1cmluZyBiYXRjaCBwcm9jZXNzaW5nLicsICdlcnJvcicpOwogICAgICAgICAgICBhbGVydCgiQmF0Y2ggYW5hbHlzaXMgaW50ZXJydXB0ZWQuIFBsZWFzZSB0cnkgYWdhaW4uIik7CiAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgbG9hZGluZzogZmFsc2UgfSkpOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBoYW5kbGVHZW5lcmF0ZVBsYW5Gb3JSb29tID0gYXN5bmMgKHJvb21JZCkgPT4gewogICAgICAgIGNvbnN0IHJvb20gPSBzdGF0ZS5yb29tcy5maW5kKHIgPT4gci5pZCA9PT0gcm9vbUlkKTsKICAgICAgICBpZiAoIXJvb20gfHwgcm9vbS5jYXB0dXJlcy5sZW5ndGggPT09IDApCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGxvYWRpbmc6IHRydWUsIGxvYWRpbmdNZXNzYWdlOiAnR2VuZXJhdGluZyBBSSBFdmFjdWF0aW9uIFBsYW4uLi4nIH0pKTsKICAgICAgICBhZGRMb2coJ01hbnVhbCBQbGFuIEdlbmVyYXRpb24nLCBgVXNlciByZXF1ZXN0ZWQgcGxhbiBnZW5lcmF0aW9uIGZvciAke3Jvb20ubmFtZX1gLCAnYWknKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBiYXNlNjQgPSByb29tLmNhcHR1cmVzWzBdLm9yaWdpbmFsSW1hZ2Uuc3BsaXQoJywnKVsxXTsKICAgICAgICAgICAgY29uc3QgcGxhblVyaSA9IGF3YWl0IGdlbmVyYXRlRXZhY3VhdGlvblBsYW4oYmFzZTY0KTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoewogICAgICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgICAgIHJvb21zOiBzLnJvb21zLm1hcChyID0+IHIuaWQgPT09IHJvb21JZCA/IHsgLi4uciwgZXZhY3VhdGlvblBsYW46IHBsYW5VcmkgfSA6IHIpLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBhZGRMb2coJ1BsYW4gR2VuZXJhdGlvbiBTdWNjZXNzZnVsJywgYFBsYW4gY3JlYXRlZCBmb3IgJHtyb29tLm5hbWV9YCwgJ3N1Y2Nlc3MnKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgYWRkTG9nKCdQbGFuIEdlbmVyYXRpb24gRmFpbGVkJywgYEZhaWxlZCB0byBnZW5lcmF0ZSBwbGFuIGZvciAke3Jvb20ubmFtZX1gLCAnZXJyb3InKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiBmYWxzZSB9KSk7CiAgICAgICAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gZ2VuZXJhdGUgcGxhbiIpOwogICAgICAgIH0KICAgIH07CiAgICAvLyAuLi4gKHBlcmZvcm1DdXN0b21BbmFseXNpcywgZmlsZVRvQmFzZTY0LCBwZXJmb3JtVGV4dEFuYWx5c2lzLCBnZW5lcmF0ZU92ZXJsYXksIGdlbmVyYXRlRXZhY3VhdGlvblBsYW4gaGVscGVycyByZW1haW4gc2FtZSkgLi4uCiAgICBjb25zdCBmaWxlVG9CYXNlNjQgPSAoZmlsZSkgPT4gewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQuc3BsaXQoJywnKVsxXSk7CiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0OwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICB9KTsKICAgIH07CiAgICBjb25zdCBwZXJmb3JtVGV4dEFuYWx5c2lzID0gYXN5bmMgKGJhc2U2NEltYWdlLCBzY29wZXMsIGxvY2F0aW9uKSA9PiB7CiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDb25maWdzID0gc2NvcGVzLm1hcChzID0+IFNDT1BFX0NPTkZJR1tzXSk7CiAgICAgICAgY29uc3QgbGFiZWxzID0gc2VsZWN0ZWRDb25maWdzLm1hcChjID0+IGMubGFiZWwpLmpvaW4oJywgJyk7CiAgICAgICAgY29uc3QgZm9jdXNlcyA9IHNlbGVjdGVkQ29uZmlncy5tYXAoYyA9PiBjLmZvY3VzKS5qb2luKCc7ICcpOwogICAgICAgIGNvbnN0IHN0YW5kYXJkcyA9IHNlbGVjdGVkQ29uZmlncy5tYXAoYyA9PiBjLnN0YW5kYXJkcykuam9pbignOyAnKTsKICAgICAgICBjb25zdCBleHBlY3RlZERvY3MgPSBzZWxlY3RlZENvbmZpZ3MubWFwKGMgPT4gYy5kb2N1bWVudHMpLmpvaW4oJzsgJyk7CiAgICAgICAgY29uc3QgaXNGYWNpbGl0eVNjb3BlID0gc2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgICAgIGNvbnN0IGxvY0NvbnRleHQgPSBsb2NhdGlvbiAmJiBsb2NhdGlvbiAhPT0gJ0ZldGNoaW5nLi4uJyAmJiBsb2NhdGlvbiAhPT0gJ0RldGVjdGluZy4uLicKICAgICAgICAgICAgPyBgVGhlIGluc3BlY3Rpb24gaXMgdGFraW5nIHBsYWNlIGF0IHNwZWNpZmljIGxvY2F0aW9uOiAiJHtsb2NhdGlvbn0iLiBZb3UgTVVTVCBpbmZlciB0aGUgY291bnRyeS9yZWdpb24gYW5kIGFwcGx5IHRoZSBzcGVjaWZpYyBsb2NhbCBsYXdzL2NvZGVzIHJlbGV2YW50IHRvIHRoaXMganVyaXNkaWN0aW9uIGZvciBlYWNoIHNjb3BlLmAKICAgICAgICAgICAgOiBgVGhlIGluc3BlY3Rpb24gbG9jYXRpb24gaXMgZ2VuZXJpYy91bmtub3duLiBBcHBseSBJbnRlcm5hdGlvbmFsIEJlc3QgUHJhY3RpY2VzIChJU08vTkZQQSkuYDsKICAgICAgICBjb25zdCByZXNwb25zZVNjaGVtYSA9IHsKICAgICAgICAgICAgdHlwZTogVHlwZS5PQkpFQ1QsCiAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgIHNjb3JlOiB7IHR5cGU6IFR5cGUuTlVNQkVSLCBkZXNjcmlwdGlvbjogIkNvbXBsaWFuY2Ugc2NvcmUgMC0xMDAiIH0sCiAgICAgICAgICAgICAgICBoYXphcmRzOiB7IHR5cGU6IFR5cGUuQVJSQVksIGl0ZW1zOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0sIGRlc2NyaXB0aW9uOiAiTGlzdCBvZiBoYXphcmRzIChTdW1tYXJ5KS4iIH0sCiAgICAgICAgICAgICAgICB6b25pbmdJc3N1ZXM6IHsgdHlwZTogVHlwZS5TVFJJTkcsIGRlc2NyaXB0aW9uOiAiQW5hbHlzaXMgb2YgbWFya2luZ3MuIiB9LAogICAgICAgICAgICAgICAgc3VtbWFyeTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJFeGVjdXRpdmUgc3VtbWFyeS4iIH0sCiAgICAgICAgICAgICAgICByZWxldmFudFN0YW5kYXJkczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuQVJSQVksCiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogVHlwZS5PQkpFQ1QsCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YW5kYXJkSWQ6IHsgdHlwZTogVHlwZS5TVFJJTkcgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBtaXNzaW5nRG9jdW1lbnRzOiB7IHR5cGU6IFR5cGUuQVJSQVksIGl0ZW1zOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0gfSwKICAgICAgICAgICAgICAgIHJlY29tbWVuZGVkSXRlbXM6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBUeXBlLkFSUkFZLAogICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuT0JKRUNULAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogeyB0eXBlOiBUeXBlLlNUUklORyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJPbmUgb2YgdGhlIDkgc3BlY2lmaWMgZmFjaWxpdHkgY2F0ZWdvcmllcyBpZiBhcHBsaWNhYmxlLiIgfSwKICAgICAgICAgICAgICAgIHJpc2tMZXZlbDogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJPdmVyYWxsIHJpc2sgbGV2ZWwgZm9yIHRoaXMgaW1hZ2U6IExvdywgTWVkaXVtLCBvciBIaWdoLiIgfSwKICAgICAgICAgICAgICAgIGRldGFpbGVkRmluZGluZ3M6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBUeXBlLkFSUkFZLAogICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuT0JKRUNULAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZTogeyB0eXBlOiBUeXBlLlNUUklORyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJHb29kIGNvbmRpdGlvbiwgTWlub3IgaXNzdWUsIE1ham9yIGRlZmVjdCwgU2FmZXR5IGhhemFyZCwgb3IgQ29tcGxpYW5jZSBnYXAiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaXNrOiB7IHR5cGU6IFR5cGUuU1RSSU5HLCBkZXNjcmlwdGlvbjogIkxvdywgTWVkaXVtLCBIaWdoLCBvciBOb25lIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb21tZW5kYXRpb246IHsgdHlwZTogVHlwZS5TVFJJTkcsIGRlc2NyaXB0aW9uOiAiUHJldmVudGl2ZS9Db3JyZWN0aXZlL0ltcHJvdmVtZW50IGFjdGlvbiIgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICByZXF1aXJlZDogWyJzY29yZSIsICJoYXphcmRzIiwgInpvbmluZ0lzc3VlcyIsICJzdW1tYXJ5IiwgInJlbGV2YW50U3RhbmRhcmRzIiwgIm1pc3NpbmdEb2N1bWVudHMiLCAicmVjb21tZW5kZWRJdGVtcyJdCiAgICAgICAgfTsKICAgICAgICBsZXQgcHJvbXB0ID0gYAogICAgICBDb250ZXh0OiAke2xvY0NvbnRleHR9CiAgICAgIFRhc2s6IEFuYWx5emUgT05MWSBmb3IgdGhlIGZvbGxvd2luZyBjb21wbGlhbmNlIHNjb3BlczogJHtsYWJlbHN9LiAKICAgICAgQ1JJVElDQUw6IFNUUklDVExZIElHTk9SRSBhbnkgaXNzdWVzLCBoYXphcmRzLCBvciBub24tY29tcGxpYW5jZSB0aGF0IGZhbGxzIG91dHNpZGUgb2YgdGhlc2Ugc2VsZWN0ZWQgc2NvcGVzLgogICAgICAKICAgICAgMS4gSlVSSVNESUNUSU9OICYgU0NPUEUgTUFQUElORzogCiAgICAgIEJhc2VkIG9uIHRoZSBsb2NhdGlvbiAiJHtsb2NhdGlvbn0iLCBhcHBseSBzcGVjaWZpYyBMb2NhbCBMZWdpc2xhdGlvbiBhbmQgSW50ZXJuYXRpb25hbCBTdGFuZGFyZHM6CiAgICAgICR7c3RhbmRhcmRzfQoKICAgICAgMi4gQ09NQklORUQgQU5BTFlTSVM6CiAgICAgIC0gRm9jdXMgT05MWSBvbjogJHtmb2N1c2VzfS4gCiAgICBgOwogICAgICAgIGlmIChpc0ZhY2lsaXR5U2NvcGUpIHsKICAgICAgICAgICAgcHJvbXB0ICs9IGAKICAgICAgICBTUEVDSUZJQyBJTlNUUlVDVElPTlMgRk9SIElTTyA0MTAwMSBGQUNJTElUWSBJTlNQRUNUSU9OOgogICAgICAgIEEuIENMQVNTSUZZIHRoZSBpbWFnZSBpbnRvIEVYQUNUTFkgT05FIG9mIHRoZXNlIDkgY2F0ZWdvcmllczoKICAgICAgICAgICAxLiBFeHRlcmlvciBGYWNpbGl0eSAoV2FsbHMsIGZhw6dhZGUsIHJvb2YsIGJvdW5kYXJ5LCBwYXJraW5nKQogICAgICAgICAgIDIuIEludGVyaW9yIEZhY2lsaXR5IChGbG9vcnMsIGNlaWxpbmdzLCB3YWxscywgZG9vcnMsIHN0YWlycykKICAgICAgICAgICAzLiBNRVAgU3lzdGVtcyAoVmlzdWFsIE9ubHkgLSBFbGVjdHJpY2FsLCBIVkFDLCBQbHVtYmluZykKICAgICAgICAgICA0LiBGaXJlICYgTGlmZSBTYWZldHkgKEV4dGluZ3Vpc2hlcnMsIGV4aXRzLCBzcHJpbmtsZXJzKQogICAgICAgICAgIDUuIEZhY2lsaXR5IFNlY3VyaXR5IChDQ1RWLCBhY2Nlc3MsIGJvdW5kYXJ5KQogICAgICAgICAgIDYuIEVudmlyb25tZW50YWwgJiBTdXN0YWluYWJpbGl0eSAoV2FzdGUsIGNoZW1pY2FscywgbGVha3MpCiAgICAgICAgICAgNy4gQXNzZXQgQ29uZGl0aW9uIChFcXVpcG1lbnQsIGxhYmVscywgcmFja2luZykKICAgICAgICAgICA4LiBDbGVhbmxpbmVzcyAmIEhvdXNla2VlcGluZyAoQ2x1dHRlciwgc3BpbGxzLCBwZXN0KQogICAgICAgICAgIDkuIENvbnRyYWN0b3IgQ29tcGxpYW5jZSAoUFBFLCBiYXJyaWNhZGluZywgdG9vbHMpCgogICAgICAgIEIuIElERU5USUZZIEZJTkRJTkdTIGZvciAnZGV0YWlsZWRGaW5kaW5ncyc6CiAgICAgICAgICAgLSBGb3IgZWFjaCBvYnNlcnZhdGlvbiwgZGV0ZXJtaW5lIHRoZSBUeXBlOiAnR29vZCBjb25kaXRpb24nLCAnTWlub3IgaXNzdWUnLCAnTWFqb3IgZGVmZWN0JywgJ1NhZmV0eSBoYXphcmQnLCBvciAnQ29tcGxpYW5jZSBnYXAnLgogICAgICAgICAgIC0gQXNzaWduIGEgUmlzayBMZXZlbDogJ0xvdycsICdNZWRpdW0nLCAnSGlnaCcsIG9yICdOb25lJy4KICAgICAgICAgICAtIFByb3ZpZGUgYSBSZWNvbW1lbmRhdGlvbiAoUHJldmVudGl2ZSwgQ29ycmVjdGl2ZSwgb3IgSW1wcm92ZW1lbnQpLgogICAgICAgIAogICAgICAgIEMuIFNDT1JFOgogICAgICAgICAgIC0gUHJvdmlkZSBhbiBvdmVyYWxsIHNjb3JlICgwLTEwMCkgZm9yIHRoaXMgaW1hZ2UgYmFzZWQgb24gdGhlIGZpbmRpbmdzLgogICAgICAgIGA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwcm9tcHQgKz0gYAogICAgICAgIC0gQ29tcGFyZSB2aXN1YWwgZXZpZGVuY2UgYWdhaW5zdCB0aGVzZSBTUEVDSUZJQyBpbmZlcnJlZCBsb2NhbCBsYXdzLgogICAgICAgIC0gRm9yIE9IUywgcHJpb3JpdGl6ZSB0cmlwIGhhemFyZHMsIGd1YXJkcywgYW5kIG1hcmtpbmdzLgogICAgICAgIGA7CiAgICAgICAgfQogICAgICAgIHByb21wdCArPSBgCiAgICAgIDMuIFJFTUVESUFUSU9OIElURU1TIChCSUxMIE9GIE1BVEVSSUFMUyk6CiAgICAgIC0gSWRlbnRpZnkgcGh5c2ljYWwgaXRlbXMgbmVlZGVkIHRvIGZpeCB0aGVzZSBoYXphcmRzLgoKICAgICAgNC4gUkVQT1JUSU5HIChTVEFOREFSRFMgJiBET0NVTUVOVFMpOgogICAgICAtIEluICdyZWxldmFudFN0YW5kYXJkcycsIGxpc3Qgc3BlY2lmaWMgbGF3cyBmb3VuZC4KICAgICAgLSBJbiAnbWlzc2luZ0RvY3VtZW50cycsIGluZmVyIHJlcXVpcmVkIGNvbXBsaWFuY2UgZG9jdW1lbnRzIGZyb20gdGhpcyByZWZlcmVuY2UgbGlzdDogWyR7ZXhwZWN0ZWREb2NzfV0uIAogICAgICAtIE9OTFkgbGlzdCBkb2N1bWVudHMgdGhhdCBhcmUgbGlrZWx5IG1pc3Npbmcgb3IgcmVxdWlyZWQgYmFzZWQgb24gdGhlIHZpc3VhbCBldmlkZW5jZSBkZXRlY3RlZCAoZS5nLiBpZiBhIG1hY2hpbmUgaXMgdW5ndWFyZGVkLCBmbGFnICdSaXNrIEFzc2Vzc21lbnQnIGFuZCAnTWFpbnRlbmFuY2UgTG9ncycpLiBEbyBub3QgbGlzdCBhbGwuCiAgICBgOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2VuQUkubW9kZWxzLmdlbmVyYXRlQ29udGVudCh7CiAgICAgICAgICAgICAgICBtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gnLAogICAgICAgICAgICAgICAgY29udGVudHM6IHsgcGFydHM6IFt7IGlubGluZURhdGE6IHsgbWltZVR5cGU6ICdpbWFnZS9qcGVnJywgZGF0YTogYmFzZTY0SW1hZ2UgfSB9LCB7IHRleHQ6IHByb21wdCB9XSB9LAogICAgICAgICAgICAgICAgY29uZmlnOiB7IHJlc3BvbnNlTWltZVR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJywgcmVzcG9uc2VTY2hlbWE6IHJlc3BvbnNlU2NoZW1hIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IHRleHQgPSByZXNwb25zZS50ZXh0OwogICAgICAgICAgICBpZiAoIXRleHQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVtcHR5IHJlc3BvbnNlIGZyb20gQUkgbW9kZWwuIik7CiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRleHQpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVGV4dCBBbmFseXNpcyBFcnJvcjoiLCBlcnJvcik7CiAgICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBwZXJmb3JtQ3VzdG9tQW5hbHlzaXMgPSBhc3luYyAoaW1hZ2VzLCBxdWVyeSwgbG9jYXRpb24pID0+IHsKICAgICAgICAvLyAuLi4gKEV4aXN0aW5nIGN1c3RvbSBhbmFseXNpcyBpbXBsKSAuLi4KICAgICAgICBjb25zdCBpbWFnZVBhcnRzID0gaW1hZ2VzLm1hcChpbWcgPT4gKHsKICAgICAgICAgICAgaW5saW5lRGF0YTogeyBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLCBkYXRhOiBpbWcuc3BsaXQoJywnKVsxXSB9CiAgICAgICAgfSkpOwogICAgICAgIGNvbnN0IHByb21wdCA9IGAKICAgICAgQ29udGV4dDogSW5zcGVjdGlvbiBhdCAke2xvY2F0aW9ufS4KICAgICAgVGFzazogQW5hbHl6ZSB0aGUgcHJvdmlkZWQgaW1hZ2VzIG9mIHRoaXMgcm9vbS9hcmVhIHNwZWNpZmljYWxseSBhZ2FpbnN0IHRoZSBmb2xsb3dpbmcgc3RhbmRhcmQvcmVxdWlyZW1lbnQ6ICIke3F1ZXJ5fSIuCiAgICAgIAogICAgICBQcm92aWRlIGEgY29uY2lzZSBidXQgcHJvZmVzc2lvbmFsIGFzc2Vzc21lbnQgcmVwb3J0IGluY2x1ZGluZzoKICAgICAgMS4gQ29tcGxpYW5jZSBWZXJkaWN0IChDb21wbGlhbnQgLyBOb24tQ29tcGxpYW50IC8gTmVlZHMgUmV2aWV3KQogICAgICAyLiBTcGVjaWZpYyBPYnNlcnZhdGlvbnMgcmVsYXRlZCBzcGVjaWZpY2FsbHkgdG8gIiR7cXVlcnl9IiBiYXNlZCBvbiB2aXN1YWwgZXZpZGVuY2UuCiAgICAgIDMuIENpdGF0aW9uIG9mIGxpa2VseSBhcHBsaWNhYmxlIGNsYXVzZXMgb2YgdGhlIHJlcXVlc3RlZCBzdGFuZGFyZCAoaWYga25vd24pIG9yIGdlbmVyYWwgYmVzdCBwcmFjdGljZXMuCiAgICAgIDQuIFJlY29tbWVuZGVkIFJlbWVkaWF0aW9uIHN0ZXBzIGlmIGFwcGxpY2FibGUuCiAgICAgIAogICAgICBGb3JtYXQgdGhlIG91dHB1dCBpbiBjbGVhbiBNYXJrZG93bi4KICAgIGA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5BSS5tb2RlbHMuZ2VuZXJhdGVDb250ZW50KHsKICAgICAgICAgICAgICAgIG1vZGVsOiAnZ2VtaW5pLTIuNS1mbGFzaCcsCiAgICAgICAgICAgICAgICBjb250ZW50czogeyBwYXJ0czogWy4uLmltYWdlUGFydHMsIHsgdGV4dDogcHJvbXB0IH1dIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0IHx8ICJObyByZXNwb25zZSBnZW5lcmF0ZWQuIjsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkN1c3RvbSBBbmFseXNpcyBFcnJvcjoiLCBlcnJvcik7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRmFpbGVkIHRvIGNvbnN1bHQgQUkgY29uc3VsdGFudC4iKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgZ2VuZXJhdGVPdmVybGF5ID0gYXN5bmMgKGJhc2U2NEltYWdlLCBzY29wZXMpID0+IHsKICAgICAgICAvLyAuLi4gKEV4aXN0aW5nIG92ZXJsYXkgaW1wbCkgLi4uCiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDb25maWdzID0gc2NvcGVzLm1hcChzID0+IFNDT1BFX0NPTkZJR1tzXSk7CiAgICAgICAgY29uc3QgbGFiZWxzID0gc2VsZWN0ZWRDb25maWdzLm1hcChjID0+IGMubGFiZWwpLmpvaW4oJyBhbmQgJyk7CiAgICAgICAgbGV0IGV4YW1wbGVzID0gIidIQVpBUkQnIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdPSFMnKSkKICAgICAgICAgICAgZXhhbXBsZXMgKz0gIiwgJ1RSSVAgSEFaQVJEJywgJ01JU1NJTkcgR1VBUkQnLCAnU0FGRSBXQUxLV0FZJyI7CiAgICAgICAgaWYgKHNjb3Blcy5pbmNsdWRlcygnRmlyZScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQkxPQ0tFRCBFWElUJywgJ0ZJUkUgUklTSycsICdFWFRJTkdVSVNIRVInIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdTZWN1cml0eScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQkxJTkQgU1BPVCcsICdXRUFLIEVOVFJZJywgJ05PIENDVFYnIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQ1JBQ0snLCAnTEVBSycsICdEQU1BR0VEIEFTU0VUJywgJ0NMVVRURVInIjsKICAgICAgICBjb25zdCBwcm9tcHQgPSBgCiAgICAgIFJlZHJhdyB0aGUgaW1hZ2Ugd2l0aCBzYWZldHkvaW5zcGVjdGlvbiBvdmVybGF5cyBPTkxZIGZvciAke2xhYmVsc30uCiAgICAgIAogICAgICAxLiBERVRFQ1QgSEFaQVJEUyAoUkVEIEJvdW5kaW5nIEJveGVzICYgVGV4dCk6CiAgICAgICAgIC0gSWRlbnRpZnkgaGF6YXJkcyByZWxldmFudCB0byAke2xhYmVsc30uCiAgICAgICAgICR7c2NvcGVzLmluY2x1ZGVzKCdPSFMnKSA/IGAKICAgICAgICAgLSBDUklUSUNBTCBPSFMgVEFTSzogRGV0ZWN0IFRSSVAgSEFaQVJEUy4gTGFiZWwgYXMgJ1RSSVAgSEFaQVJEJy4KICAgICAgICAgLSBDUklUSUNBTCBPSFMgVEFTSzogRGV0ZWN0IFVOR1VBUkRFRCBNQUNISU5FUlkuIExhYmVsIGFzICdOTyBHVUFSRCcuCiAgICAgICAgIC0gQ1JJVElDQUwgT0hTIFRBU0s6IElmIGluZHVzdHJpYWwgbWFjaGluZXMgTEFDSyB5ZWxsb3cvYmxhY2sgc2FmZXR5IHpvbmluZywgRFJBVyBWSVJUVUFMIFlFTExPVy9CTEFDSyBESUFHT05BTCBTVFJJUEVTIG9uIHRoZSBmbG9vciBzdXJyb3VuZGluZyB0aGUgbWFjaGluZS5gIDogIiJ9CiAgICAgICAgICR7c2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpID8gYAogICAgICAgICAtIERldGVjdCB2aXN1YWwgZGVmZWN0cyAoY3JhY2tzLCBzdGFpbnMsIGxlYWtzLCBjbHV0dGVyKS4gTGFiZWwgY2xlYXJseSAoZS5nLiwgJ1dBTEwgQ1JBQ0snLCAnV0FURVIgTEVBSycpLmAgOiAiIn0KICAgICAgICAgLSBMYWJlbCBhbGwgaGF6YXJkcyBjbGVhcmx5IChlLmcuLCAke2V4YW1wbGVzfSkuCgogICAgICAyLiBERVRFQ1QgUE9TSVRJVkUgQ09NUExJQU5DRSAoR1JFRU4gQm91bmRpbmcgQm94ZXMgJiBUZXh0KToKICAgICAgICAgLSBMYWJlbCBhcyAnQ09NUExJQU5UJyBvciAnR09PRCBDT05ESVRJT04nLgoKICAgICAgMy4gVklTVUFMIFFVQUxJVFk6CiAgICAgICAgIC0gRW5zdXJlIHRleHQgaXMgVVBQRVJDQVNFLCBMRUdJQkxFLCBhbmQgU1BFTExFRCBDT1JSRUNUTFkuCiAgICBgOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2VuQUkubW9kZWxzLmdlbmVyYXRlQ29udGVudCh7CiAgICAgICAgICAgICAgICBtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gtaW1hZ2UnLAogICAgICAgICAgICAgICAgY29udGVudHM6IHsgcGFydHM6IFt7IGlubGluZURhdGE6IHsgbWltZVR5cGU6ICdpbWFnZS9qcGVnJywgZGF0YTogYmFzZTY0SW1hZ2UgfSB9LCB7IHRleHQ6IHByb21wdCB9XSB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcmVzcG9uc2UuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cyB8fCBbXSkgewogICAgICAgICAgICAgICAgaWYgKHBhcnQuaW5saW5lRGF0YSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYGRhdGE6JHtwYXJ0LmlubGluZURhdGEubWltZVR5cGV9O2Jhc2U2NCwke3BhcnQuaW5saW5lRGF0YS5kYXRhfWA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJPdmVybGF5IGdlbmVyYXRpb24gZmFpbGVkLCByZXR1cm5pbmcgb3JpZ2luYWwuIiwgZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBgZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwke2Jhc2U2NEltYWdlfWA7CiAgICB9OwogICAgY29uc3QgZ2VuZXJhdGVFdmFjdWF0aW9uUGxhbiA9IGFzeW5jIChiYXNlNjRJbWFnZSkgPT4gewogICAgICAgIC8vIC4uLiAoRXhpc3RpbmcgcGxhbiBpbXBsKSAuLi4KICAgICAgICBjb25zdCBwcm9tcHQgPSBgCiAgICAgIENyZWF0ZSBhIHByb2Zlc3Npb25hbCBldmFjdWF0aW9uIHBsYW4gZmxvb3IgbWFwIGJhc2VkIG9uIHRoaXMgaW1hZ2UuCiAgICAgIDEuIERyYXcgYSBjbGVhciB3aGl0ZSBmbG9vciBwbGFuIHdpdGggYmxhY2sgd2FsbHMuCiAgICAgIDIuIEFERCBGTE9PUiBNQVJLSU5HUzogRHJhdyBkaXN0aW5jdCBHcmVlbiBwYXRod2F5cy9hcnJvd3Mgb24gdGhlIGZsb29yIGluZGljYXRpbmcgdGhlIHNhZmUgZXhpdCByb3V0ZS4KICAgICAgMy4gTWFyayAnRU1FUkdFTkNZIEVYSVQnIGxvY2F0aW9ucyB3aXRoIHN0YW5kYXJkIEdyZWVuL1doaXRlIGV4aXQgc2lnbnMuCiAgICAgIDQuIEFkZCBSZWQgaWNvbnMgZm9yIEZpcmUgRXh0aW5ndWlzaGVycyBpZiByZWxldmFudCB0byB0aGUgbG9jYXRpb24uCiAgICAgIDUuIFRpdGxlIHRoZSB0b3AgJ0VWQUNVQVRJT04gUExBTicuCiAgICAgIDYuIENSSVRJQ0FMOiBFbnN1cmUgdGhlIHRpdGxlIGFuZCAnRVhJVCcgc2lnbnMgYXJlIFNQRUxMRUQgQ09SUkVDVExZIGFuZCBhcmUgY3Jpc3AvbGVnaWJsZS4KICAgIGA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5BSS5tb2RlbHMuZ2VuZXJhdGVDb250ZW50KHsKICAgICAgICAgICAgICAgIG1vZGVsOiAnZ2VtaW5pLTIuNS1mbGFzaC1pbWFnZScsCiAgICAgICAgICAgICAgICBjb250ZW50czogeyBwYXJ0czogW3sgaW5saW5lRGF0YTogeyBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLCBkYXRhOiBiYXNlNjRJbWFnZSB9IH0sIHsgdGV4dDogcHJvbXB0IH1dIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiByZXNwb25zZS5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzIHx8IFtdKSB7CiAgICAgICAgICAgICAgICBpZiAocGFydC5pbmxpbmVEYXRhKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBgZGF0YToke3BhcnQuaW5saW5lRGF0YS5taW1lVHlwZX07YmFzZTY0LCR7cGFydC5pbmxpbmVEYXRhLmRhdGF9YDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIkV2YWN1YXRpb24gcGxhbiBnZW5lcmF0aW9uIGZhaWxlZC4iLCBlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGBkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCR7YmFzZTY0SW1hZ2V9YDsKICAgIH07CiAgICAvLyAuLi4gKFZpZXdzKSAuLi4KICAgIGlmIChzdGF0ZS5sb2FkaW5nKSB7CiAgICAgICAgLy8gLi4uCiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtNTAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcC02IiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4KExvYWRlcjIsIHsgY2xhc3NOYW1lOiAidy0xMiBoLTEyIHRleHQtYmx1ZS02MDAgYW5pbWF0ZS1zcGluIG1iLTQiIH0pLCBfanN4KCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC14bCBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogIlByb2Nlc3NpbmcgQXVkaXQuLi4iIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTUwMCBtdC0yIiwgY2hpbGRyZW46IHN0YXRlLmxvYWRpbmdNZXNzYWdlIH0pXSB9KSk7CiAgICB9CiAgICAvLyBTZXR1cCBWaWV3CiAgICBpZiAoc3RhdGUudmlldyA9PT0gJ3NldHVwJykgewogICAgICAgIC8vIC4uLiAoU2V0dXAgdmlldyBsb2dpYyB1bmNoYW5nZWQpIC4uLgogICAgICAgIGNvbnN0IGlzUmVhZHkgPSBzdGF0ZS5jb21wYW55TmFtZSAmJiBzdGF0ZS5zaXRlTmFtZSAmJiBzdGF0ZS5pbnNwZWN0b3JOYW1lICYmIHN0YXRlLnNjb3BlLmxlbmd0aCA+IDA7CiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtMTAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtNCBtZDpwLTYgZm9udC1zYW5zIiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSByb3VuZGVkLTN4bCBzaGFkb3ctMnhsIG92ZXJmbG93LWhpZGRlbiBtYXgtdy02eGwgdy1mdWxsIGdyaWQgZ3JpZC1jb2xzLTEgbGc6Z3JpZC1jb2xzLTEyIG1pbi1oLVs2MDBweF0iLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImxnOmNvbC1zcGFuLTUgYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1zbGF0ZS05MDAgdmlhLWJsdWUtOTAwIHRvLWluZGlnby05MDAgcC04IG1kOnAtMTIgdGV4dC13aGl0ZSBmbGV4IGZsZXgtY29sIGp1c3RpZnktYmV0d2VlbiByZWxhdGl2ZSBvdmVyZmxvdy1oaWRkZW4iLCBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTAgcmlnaHQtMCB3LTY0IGgtNjQgYmctd2hpdGUvNSByb3VuZGVkLWZ1bGwgLXRyYW5zbGF0ZS15LTEvMiB0cmFuc2xhdGUteC0xLzIgYmx1ci0zeGwiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGJvdHRvbS0wIGxlZnQtMCB3LTY0IGgtNjQgYmctYmx1ZS01MDAvMjAgcm91bmRlZC1mdWxsIHRyYW5zbGF0ZS15LTEvMiAtdHJhbnNsYXRlLXgtMS8yIGJsdXItM3hsIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicmVsYXRpdmUgei0xMCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgbWItNiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZS8xMCBiYWNrZHJvcC1ibHVyIHAtMiByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItd2hpdGUvMjAiLCBjaGlsZHJlbjogX2pzeChTaGllbGQsIHsgY2xhc3NOYW1lOiAidy04IGgtOCB0ZXh0LWJsdWUtMzAwIiB9KSB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRyYWNraW5nLXdpZGVzdCB0ZXh0LXNtIHRleHQtYmx1ZS0yMDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJDb21wbGlhbmNlR3VhcmQgQUkiIH0pXSB9KSwgX2pzeHMoImgxIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTR4bCBtZDp0ZXh0LTV4bCBmb250LWJsYWNrIGxlYWRpbmctdGlnaHQgbWItNiIsIGNoaWxkcmVuOiBbIkludGVsbGlnZW50ICIsIF9qc3goImJyIiwge30pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXRyYW5zcGFyZW50IGJnLWNsaXAtdGV4dCBiZy1ncmFkaWVudC10by1yIGZyb20tYmx1ZS0yMDAgdG8td2hpdGUiLCBjaGlsZHJlbjogIkF1ZGl0ICYgU2FmZXR5IiB9KSwgIiAiLCBfanN4KCJiciIsIHt9KSwgIkNvbXBsaWFuY2UuIl0gfSksIF9qc3goInAiLCB7IGNsYXNzTmFtZTogInRleHQtYmx1ZS0yMDAgdGV4dC1sZyBsZWFkaW5nLXJlbGF4ZWQgbWItOCBtYXgtdy1tZCIsIGNoaWxkcmVuOiAiVHJhbnNmb3JtIHlvdXIgaW5zcGVjdGlvbiB3b3JrZmxvdyB3aXRoIHJlYWwtdGltZSBBSSBoYXphcmQgZGV0ZWN0aW9uLCBhdXRvbWF0ZWQgcmVndWxhdG9yeSBtYXBwaW5nLCBhbmQgaW5zdGFudCByZXBvcnRpbmcuIiB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAibXQtMTIgdGV4dC14cyB0ZXh0LWJsdWUtNDAwLzYwIGZvbnQtbW9ubyIsIGNoaWxkcmVuOiAidjIuNi4wIFx1MjAyMiBQb3dlcmVkIGJ5IEdlbWluaSAyLjUgRmxhc2giIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJsZzpjb2wtc3Bhbi03IHAtOCBtZDpwLTEyIGJnLXdoaXRlIGZsZXggZmxleC1jb2wganVzdGlmeS1jZW50ZXIiLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXcteGwgbXgtYXV0byB3LWZ1bGwiLCBjaGlsZHJlbjogW19qc3goImgyIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgbWItMiIsIGNoaWxkcmVuOiAiU3RhcnQgSW5zcGVjdGlvbiBTZXNzaW9uIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgbWItOCIsIGNoaWxkcmVuOiAiRW50ZXIgc2Vzc2lvbiBkZXRhaWxzIHRvIGNvbmZpZ3VyZSB0aGUgQUkgY29udGV4dC4iIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImdyaWQgZ3JpZC1jb2xzLTEgbWQ6Z3JpZC1jb2xzLTIgZ2FwLTUiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInNwYWNlLXktMS41IiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJDb21wYW55IE5hbWUiIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSIsIGNoaWxkcmVuOiBbX2pzeChCcmllZmNhc2UsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgbGVmdC0zIHRvcC0zIHctNCBoLTQgdGV4dC1zbGF0ZS00MDAiIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogInRleHQiLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcGwtMTAgcC0yLjUgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTgwMCBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1ibHVlLTUwMCBvdXRsaW5lLW5vbmUgdHJhbnNpdGlvbi1hbGwiLCBwbGFjZWhvbGRlcjogImUuZy4gQWNtZSBJbmR1c3RyaWVzIiwgdmFsdWU6IHN0YXRlLmNvbXBhbnlOYW1lLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgY29tcGFueU5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEuNSIsIGNoaWxkcmVuOiBbX2pzeCgibGFiZWwiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiRmFjaWxpdHkgLyBTaXRlIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicmVsYXRpdmUiLCBjaGlsZHJlbjogW19qc3goQnVpbGRpbmcsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgbGVmdC0zIHRvcC0zIHctNCBoLTQgdGV4dC1zbGF0ZS00MDAiIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogInRleHQiLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcGwtMTAgcC0yLjUgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTgwMCBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1ibHVlLTUwMCBvdXRsaW5lLW5vbmUgdHJhbnNpdGlvbi1hbGwiLCBwbGFjZWhvbGRlcjogImUuZy4gV2FyZWhvdXNlIEIiLCB2YWx1ZTogc3RhdGUuc2l0ZU5hbWUsIG9uQ2hhbmdlOiAoZSkgPT4gc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBzaXRlTmFtZTogZS50YXJnZXQudmFsdWUgfSkpIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInNwYWNlLXktMS41IiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJJbnNwZWN0b3IiIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSIsIGNoaWxkcmVuOiBbX2pzeChVc2VyLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGxlZnQtMyB0b3AtMyB3LTQgaC00IHRleHQtc2xhdGUtNDAwIiB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJ0ZXh0IiwgY2xhc3NOYW1lOiAidy1mdWxsIHBsLTEwIHAtMi41IGJnLXNsYXRlLTUwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHJvdW5kZWQtbGcgdGV4dC1zbGF0ZS04MDAgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctYmx1ZS01MDAgb3V0bGluZS1ub25lIHRyYW5zaXRpb24tYWxsIiwgcGxhY2Vob2xkZXI6ICJGdWxsIE5hbWUiLCB2YWx1ZTogc3RhdGUuaW5zcGVjdG9yTmFtZSwgb25DaGFuZ2U6IChlKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGluc3BlY3Rvck5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEuNSIsIGNoaWxkcmVuOiBbX2pzeCgibGFiZWwiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiR2VvLUxvY2F0aW9uIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJ0ZXh0IiwgY2xhc3NOYW1lOiAiZmxleC0xIHAtMi41IGJnLXNsYXRlLTUwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHJvdW5kZWQtbGcgdGV4dC1zbGF0ZS04MDAgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctYmx1ZS01MDAgb3V0bGluZS1ub25lIHRleHQtc20iLCBwbGFjZWhvbGRlcjogIkNpdHkvUmVnaW9uIiwgdmFsdWU6IHN0YXRlLmdlb0xvY2F0aW9uLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgZ2VvTG9jYXRpb246IGUudGFyZ2V0LnZhbHVlIH0pKSB9KSwgX2pzeCgiYnV0dG9uIiwgeyBvbkNsaWNrOiBkZXRlY3RMb2NhdGlvbiwgY2xhc3NOYW1lOiAicHgtMyBiZy1zbGF0ZS0xMDAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTUwMCBob3Zlcjp0ZXh0LWJsdWUtNjAwIGhvdmVyOmJvcmRlci1ibHVlLTMwMCB0cmFuc2l0aW9uLWNvbG9ycyIsIGNoaWxkcmVuOiBfanN4KE1hcFBpbiwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KV0gfSldIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xLjUiLCBjaGlsZHJlbjogW19qc3goImxhYmVsIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCB1cHBlcmNhc2UiLCBjaGlsZHJlbjogIkNvbXBhbnkgTG9nbyAoT3B0aW9uYWwpIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IGxvZ29JbnB1dFJlZi5jdXJyZW50Py5jbGljaygpLCBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBweC00IHB5LTIgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTYwMCBob3ZlcjpiZy1zbGF0ZS0xMDAgdGV4dC1zbSBmb250LW1lZGl1bSIsIGNoaWxkcmVuOiBbX2pzeChJbWFnZUljb24sIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgVXBsb2FkIExvZ28iXSB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJmaWxlIiwgcmVmOiBsb2dvSW5wdXRSZWYsIGNsYXNzTmFtZTogImhpZGRlbiIsIGFjY2VwdDogImltYWdlLyoiLCBvbkNoYW5nZTogaGFuZGxlTG9nb1NlbGVjdCB9KSwgc3RhdGUuY29tcGFueUxvZ28gJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJnLWdyZWVuLTUwIHRleHQtZ3JlZW4tNzAwIHB4LTMgcHktMS41IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ncmVlbi0xMDAgdGV4dC14cyBmb250LWJvbGQiLCBjaGlsZHJlbjogW19qc3goQ2hlY2ssIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSksICIgTG9nbyBVcGxvYWRlZCJdIH0pKV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJwdC00IGJvcmRlci10IGJvcmRlci1zbGF0ZS0xMDAiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciBtYi0zIiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJTZWxlY3QgSW5zcGVjdGlvbiBTY29wZXMiIH0pLCBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiBgdGV4dC14cyBmb250LWJvbGQgJHtzdGF0ZS5zY29wZS5sZW5ndGggPj0gMiA/ICd0ZXh0LWFtYmVyLTYwMCcgOiAndGV4dC1zbGF0ZS00MDAnfWAsIGNoaWxkcmVuOiBbc3RhdGUuc2NvcGUubGVuZ3RoLCAiLzIgU2VsZWN0ZWQiXSB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBnYXAtMyIsIGNoaWxkcmVuOiBPYmplY3Qua2V5cyhTQ09QRV9DT05GSUcpLm1hcCgoc2NvcGVLZXkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZiA9IFNDT1BFX0NPTkZJR1tzY29wZUtleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IEljb24gPSBjb25mLmljb247CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBzdGF0ZS5zY29wZS5pbmNsdWRlcyhzY29wZUtleSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSAhaXNTZWxlY3RlZCAmJiBzdGF0ZS5zY29wZS5sZW5ndGggPj0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiB0b2dnbGVTY29wZShzY29wZUtleSksIGRpc2FibGVkOiBpc0Rpc2FibGVkLCBjbGFzc05hbWU6IGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlIHAtMyByb3VuZGVkLXhsIGJvcmRlciB0cmFuc2l0aW9uLWFsbCB0ZXh0LWxlZnQgZmxleCBpdGVtcy1zdGFydCBnYXAtMyBncm91cAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtpc1NlbGVjdGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnYmctYmx1ZS01MCBib3JkZXItYmx1ZS01MDAgcmluZy0xIHJpbmctYmx1ZS01MDAgc2hhZG93LXNtJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogaXNEaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdiZy1zbGF0ZS01MCBib3JkZXItc2xhdGUtMTAwIG9wYWNpdHktNTAgY3Vyc29yLW5vdC1hbGxvd2VkJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdiZy13aGl0ZSBib3JkZXItc2xhdGUtMjAwIGhvdmVyOmJvcmRlci1ibHVlLTMwMCBob3ZlcjpiZy1zbGF0ZS01MCd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC0yIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnMgc2hyaW5rLTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7aXNTZWxlY3RlZCA/IGNvbmYuY29sb3IgKyAnIHRleHQtd2hpdGUnIDogaXNEaXNhYmxlZCA/ICdiZy1zbGF0ZS0xMDAgdGV4dC1zbGF0ZS0zMDAnIDogJ2JnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTQwMCBncm91cC1ob3Zlcjp0ZXh0LXNsYXRlLTYwMCd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCwgY2hpbGRyZW46IF9qc3goSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LXNtICR7aXNTZWxlY3RlZCA/ICd0ZXh0LWJsdWUtOTAwJyA6IGlzRGlzYWJsZWQgPyAndGV4dC1zbGF0ZS00MDAnIDogJ3RleHQtc2xhdGUtNzAwJ31gLCBjaGlsZHJlbjogY29uZi5sYWJlbCB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBtdC0wLjUgbGVhZGluZy10aWdodCIsIGNoaWxkcmVuOiBjb25mLnN0YW5kYXJkcy5zcGxpdCgnLCcpWzBdIH0pXSB9KSwgaXNTZWxlY3RlZCAmJiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMyByaWdodC0zIiwgY2hpbGRyZW46IF9qc3goQ2hlY2tDaXJjbGUsIHsgY2xhc3NOYW1lOiAidy00IGgtNCB0ZXh0LWJsdWUtNjAwIiB9KSB9KSldIH0sIHNjb3BlS2V5KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSldIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiBoYW5kbGVTdGFydFNlc3Npb24sIGRpc2FibGVkOiAhaXNSZWFkeSwgY2xhc3NOYW1lOiBgCiAgICAgICAgICAgICAgICAgICAgICAgIHctZnVsbCBweS00IHJvdW5kZWQteGwgZm9udC1ib2xkIHRleHQtbGcgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTMgdHJhbnNpdGlvbi1hbGwgbXQtNgogICAgICAgICAgICAgICAgICAgICAgICAke2lzUmVhZHkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWdyYWRpZW50LXRvLXIgZnJvbS1ibHVlLTcwMCB0by1pbmRpZ28tODAwIHRleHQtd2hpdGUgc2hhZG93LXhsIHNoYWRvdy1ibHVlLTkwMC8yMCBob3ZlcjpzaGFkb3ctMnhsIHRyYW5zZm9ybSBob3ZlcjotdHJhbnNsYXRlLXktMC41JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNDAwIGN1cnNvci1ub3QtYWxsb3dlZCd9CiAgICAgICAgICAgICAgICAgICAgICBgLCBjaGlsZHJlbjogWyJJbml0aWFsaXplIEluc3BlY3Rpb24gIiwgX2pzeChBcnJvd1JpZ2h0LCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pXSB9KV0gfSldIH0pIH0pXSB9KV0gfSkpOwogICAgfQogICAgLy8gU3RhZ2luZyBWaWV3CiAgICBpZiAoc3RhdGUudmlldyA9PT0gJ3N0YWdpbmcnKSB7CiAgICAgICAgLy8gLi4uIChTdGFnaW5nIGxvZ2ljIGxvZ2ljIHVuY2hhbmdlZCkgLi4uCiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtNTAgcC02IiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4KCJuYXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIGJvcmRlci1iIGJvcmRlci1zbGF0ZS0yMDAgc3RpY2t5IHRvcC0wIHotMTAgcC00IG1iLTYgcm91bmRlZC14bCBzaGFkb3ctc20iLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHZpZXc6ICdkYXNoYm9hcmQnLCBzdGFnaW5nSW1hZ2VzOiBbXSB9KSksIGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRleHQtc2xhdGUtNjAwIGZvbnQtbWVkaXVtIGhvdmVyOnRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogW19qc3goQ2hldnJvbkxlZnQsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgQ2FuY2VsIFVwbG9hZCJdIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc20gZm9udC1ib2xkIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogc3RhdGUuc2l0ZU5hbWUgfSldIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy0zeGwgbXgtYXV0byIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgcm91bmRlZC0yeGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHAtOCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgiaDIiLCB7IGNsYXNzTmFtZTogInRleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIiwgY2hpbGRyZW46ICJBZGQgTmV3IFNwYWNlIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgdGV4dC1zbSIsIGNoaWxkcmVuOiAiVXBsb2FkIGltYWdlcyB0byBhbmFseXplIGhhemFyZHMiIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGdhcC0yIiwgY2hpbGRyZW46IHN0YXRlLnNjb3BlLm1hcChzID0+IChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQteHMgcHgtMiBweS0xIHJvdW5kZWQgZm9udC1ib2xkIGJvcmRlciAke3MgPT09ICdGaXJlJyA/ICdiZy1yZWQtNTAgdGV4dC1yZWQtODAwIGJvcmRlci1yZWQtMTAwJyA6ICdiZy1ibHVlLTUwIHRleHQtYmx1ZS04MDAgYm9yZGVyLWJsdWUtMTAwJ31gLCBjaGlsZHJlbjogU0NPUEVfQ09ORklHW3NdLmxhYmVsIH0sIHMpKSkgfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC02IG1iLTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeHMoImxhYmVsIiwgeyBjbGFzc05hbWU6ICJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtc2xhdGUtNzAwIG1iLTIgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goTGF5ZXJzLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIERlcGFydG1lbnQgLyBTZWN0aW9uIl0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAidGV4dCIsIHZhbHVlOiBzdGF0ZS5zdGFnaW5nRGVwYXJ0bWVudCwgb25DaGFuZ2U6IChlKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHN0YWdpbmdEZXBhcnRtZW50OiBlLnRhcmdldC52YWx1ZSB9KSksIGNsYXNzTmFtZTogInctZnVsbCBwLTMgYm9yZGVyIGJvcmRlci1zbGF0ZS0zMDAgcm91bmRlZC1sZyIsIHBsYWNlaG9sZGVyOiAiZS5nLiBQcm9kdWN0aW9uIEZsb29yLCBXYXJlaG91c2UuLi4iIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4cygibGFiZWwiLCB7IGNsYXNzTmFtZTogImJsb2NrIHRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1zbGF0ZS03MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeChCdWlsZGluZywgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSwgIiBSb29tIC8gQXJlYSBOYW1lIl0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAidGV4dCIsIHZhbHVlOiBzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsIG9uQ2hhbmdlOiAoZSkgPT4gc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBzdGFnaW5nUm9vbU5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSwgY2xhc3NOYW1lOiAidy1mdWxsIHAtMyBib3JkZXIgYm9yZGVyLXNsYXRlLTMwMCByb3VuZGVkLWxnIiwgcGxhY2Vob2xkZXI6ICJlLmcuIExpbmUgNCwgTWl4aW5nIEFyZWEsIE9mZmljZSAyMDEuLi4iIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1iLTYgcC00IGJnLWJsdWUtNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWJsdWUtMTAwIGZsZXggaXRlbXMtc3RhcnQgZ2FwLTMiLCBjaGlsZHJlbjogW19qc3goImlucHV0IiwgeyB0eXBlOiAiY2hlY2tib3giLCBpZDogImdlblBsYW4iLCBjaGVja2VkOiBzdGF0ZS5zdGFnaW5nR2VuZXJhdGVQbGFuLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgc3RhZ2luZ0dlbmVyYXRlUGxhbjogZS50YXJnZXQuY2hlY2tlZCB9KSksIGNsYXNzTmFtZTogIm10LTEgdy01IGgtNSB0ZXh0LWJsdWUtNjAwIHJvdW5kZWQiIH0pLCBfanN4cygibGFiZWwiLCB7IGh0bWxGb3I6ICJnZW5QbGFuIiwgY2xhc3NOYW1lOiAiY3Vyc29yLXBvaW50ZXIiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIiwgY2hpbGRyZW46IFtfanN4KE1hcEljb24sIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgQUkgRXZhY3VhdGlvbiBQbGFuIl0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LWJsdWUtODAwIiwgY2hpbGRyZW46ICJBdXRvbWF0aWNhbGx5IGdlbmVyYXRlIGEgc2NoZW1hdGljIGV2YWN1YXRpb24gcGxhbiBiYXNlZCBvbiB0aGUgZmlyc3QgaW1hZ2UgdXBsb2FkZWQuIiB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0yIG1kOmdyaWQtY29scy00IGdhcC00IG1iLTgiLCBjaGlsZHJlbjogW3N0YXRlLnN0YWdpbmdJbWFnZXMubWFwKChmaWxlLCBpZHgpID0+IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSBhc3BlY3Qtc3F1YXJlIGJnLXNsYXRlLTEwMCByb3VuZGVkLWxnIG92ZXJmbG93LWhpZGRlbiBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCIsIGNoaWxkcmVuOiBbX2pzeCgiaW1nIiwgeyBzcmM6IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSksIGNsYXNzTmFtZTogInctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIG9wYWNpdHktODAiIH0pLCBfanN4KCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgc3RhZ2luZ0ltYWdlczogcy5zdGFnaW5nSW1hZ2VzLmZpbHRlcigoXywgaSkgPT4gaSAhPT0gaWR4KSB9KSksIGNsYXNzTmFtZTogImFic29sdXRlIHRvcC0xIHJpZ2h0LTEgYmctcmVkLTUwMCB0ZXh0LXdoaXRlIHAtMSByb3VuZGVkLWZ1bGwgc2hhZG93IiwgY2hpbGRyZW46IF9qc3goWCwgeyBjbGFzc05hbWU6ICJ3LTMgaC0zIiB9KSB9KSwgaWR4ID09PSAwICYmIHN0YXRlLnN0YWdpbmdHZW5lcmF0ZVBsYW4gJiYgKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgYm90dG9tLTEgbGVmdC0xIGJnLWJsdWUtNjAwIHRleHQtd2hpdGUgdGV4dC1bMTBweF0gcHgtMS41IHB5LTAuNSByb3VuZGVkIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiAiUkVGIiB9KSldIH0sIGlkeCkpKSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gY2FtZXJhSW5wdXRSZWYuY3VycmVudD8uY2xpY2soKSwgY2xhc3NOYW1lOiAiYXNwZWN0LXNxdWFyZSBiZy1ibHVlLTUwIHJvdW5kZWQtbGcgYm9yZGVyLTIgYm9yZGVyLWRhc2hlZCBib3JkZXItYmx1ZS0yMDAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1ibHVlLTYwMCBob3ZlcjpiZy1ibHVlLTEwMCB0cmFuc2l0aW9uLWNvbG9ycyIsIGNoaWxkcmVuOiBbX2pzeChDYW1lcmEsIHsgY2xhc3NOYW1lOiAidy04IGgtOCBtYi0xIiB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQiLCBjaGlsZHJlbjogIlRha2UgUGhvdG8iIH0pXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gZmlsZUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImFzcGVjdC1zcXVhcmUgYmctc2xhdGUtNTAgcm91bmRlZC1sZyBib3JkZXItMiBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgaG92ZXI6Ym9yZGVyLWJsdWUtNDAwIGhvdmVyOnRleHQtYmx1ZS01MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW19qc3goVXBsb2FkLCB7IGNsYXNzTmFtZTogInctOCBoLTggbWItMSIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRleHQteHMiLCBjaGlsZHJlbjogIlVwbG9hZCIgfSldIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIHB0LTQgYm9yZGVyLXQgYm9yZGVyLXNsYXRlLTEwMCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIGl0YWxpYyIsIGNoaWxkcmVuOiAiSW1hZ2VzIHdpbGwgYmUgcXVldWVkIGZvciBiYXRjaCBhbmFseXNpcy4iIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiBoYW5kbGVTYXZlU3RhZ2luZywgZGlzYWJsZWQ6IHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoID09PSAwIHx8ICFzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtNiBweS0zIHJvdW5kZWQtbGcgZm9udC1ib2xkIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW19qc3goQ2hlY2tTcXVhcmUsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgU2F2ZSB0byBRdWV1ZSJdIH0pXSB9KV0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAiZmlsZSIsIHJlZjogZmlsZUlucHV0UmVmLCBjbGFzc05hbWU6ICJoaWRkZW4iLCBhY2NlcHQ6ICJpbWFnZS8qIiwgbXVsdGlwbGU6IHRydWUsIG9uQ2hhbmdlOiBoYW5kbGVJbWFnZVNlbGVjdCB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJmaWxlIiwgcmVmOiBjYW1lcmFJbnB1dFJlZiwgY2xhc3NOYW1lOiAiaGlkZGVuIiwgYWNjZXB0OiAiaW1hZ2UvKiIsIGNhcHR1cmU6ICJlbnZpcm9ubWVudCIsIG9uQ2hhbmdlOiBoYW5kbGVJbWFnZVNlbGVjdCB9KV0gfSldIH0pKTsKICAgIH0KICAgIC8vIFJvb20gRGV0YWlsIFZpZXcKICAgIGlmIChzdGF0ZS52aWV3ID09PSAncm9vbS1kZXRhaWwnKSB7CiAgICAgICAgY29uc3Qgcm9vbSA9IHN0YXRlLnJvb21zLmZpbmQociA9PiByLmlkID09PSBzdGF0ZS5hY3RpdmVSb29tSWQpOwogICAgICAgIGlmICghcm9vbSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgY29uc3QgaXNQZW5kaW5nID0gcm9vbS5zdGF0dXMgPT09ICdwZW5kaW5nJzsKICAgICAgICBjb25zdCBoYXNFcnJvcnMgPSByb29tLmNhcHR1cmVzLnNvbWUoYyA9PiBjLmVycm9yKTsKICAgICAgICBjb25zdCBwcmltYXJ5Q29sb3IgPSBTQ09QRV9DT05GSUdbc3RhdGUuc2NvcGVbMF1dLmhleDsKICAgICAgICBjb25zdCBpc0ZhY2lsaXR5T3JPSFMgPSBzdGF0ZS5zY29wZS5pbmNsdWRlcygnRmFjaWxpdHknKSB8fCBzdGF0ZS5zY29wZS5pbmNsdWRlcygnT0hTJykgfHwgc3RhdGUuc2NvcGUuaW5jbHVkZXMoJ0ZpcmUnKTsKICAgICAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1pbi1oLXNjcmVlbiBiZy1zbGF0ZS01MCBwcmludDpiZy13aGl0ZSIsIGNoaWxkcmVuOiBbX2pzeCgic3R5bGUiLCB7IGNoaWxkcmVuOiBHbG9iYWxQcmludFN0eWxlcyB9KSwgX2pzeCgibmF2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSBib3JkZXItYiBib3JkZXItc2xhdGUtMjAwIHAtNCBzdGlja3kgdG9wLTAgei0xMCBwcmludDpoaWRkZW4iLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXctNXhsIG14LWF1dG8gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHZpZXc6ICdkYXNoYm9hcmQnIH0pKSwgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgdGV4dC1zbGF0ZS02MDAgZm9udC1tZWRpdW0gaG92ZXI6dGV4dC1ibHVlLTkwMCIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBCYWNrIHRvIERhc2hib2FyZCJdIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiaDEiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWxnIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMiIsIGNoaWxkcmVuOiAhaXNQZW5kaW5nICYmICFoYXNFcnJvcnMgJiYgKF9qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHdpbmRvdy5wcmludCgpLCBjbGFzc05hbWU6ICJiZy1ibHVlLTYwMCB0ZXh0LXdoaXRlIHB4LTQgcHktMiByb3VuZGVkLWxnIHRleHQtc20gZm9udC1tZWRpdW0gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgc2hhZG93LXNtIiwgY2hpbGRyZW46IFtfanN4KFByaW50ZXIsIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgUHJpbnQgUm9vbSBSZXBvcnQiXSB9KSkgfSldIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy01eGwgbXgtYXV0byBwLTYgc3BhY2UteS04IHByaW50OnAtMCBwcmludDptLTAgcHJpbnQ6dy1mdWxsIHByaW50Om1heC13LW5vbmUgcHJpbnQ6c3BhY2UteS0yIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJwcmludDpoaWRkZW4gYmctd2hpdGUgcC02IHJvdW5kZWQteGwgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgc2hhZG93LXNtIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgZm9udC1ib2xkIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4cygicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTcwMCBweC0yIHB5LTAuNSByb3VuZGVkIHRleHQteHMgZm9udC1ib2xkIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KSwgIlx1MjAyMiAiLCByb29tLmNhcHR1cmVzLmxlbmd0aCwgIiBWaWV3cG9pbnRzIl0gfSldIH0pLCAoaXNQZW5kaW5nIHx8IGhhc0Vycm9ycykgJiYgKF9qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgbG9hZGluZzogdHJ1ZSwgbG9hZGluZ01lc3NhZ2U6IGBBbmFseXppbmcgJHtyb29tLm5hbWV9Li4uYCB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmFseXplUm9vbShyb29tKS50aGVuKHVwZGF0ZWRSb29tID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb21zOiBzLnJvb21zLm1hcChyID0+IHIuaWQgPT09IHVwZGF0ZWRSb29tLmlkID8gdXBkYXRlZFJvb20gOiByKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgY2xhc3NOYW1lOiAiYmctYmx1ZS02MDAgdGV4dC13aGl0ZSBweC00IHB5LTIgcm91bmRlZC1sZyBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgdGV4dC1zbSBzaGFkb3ctbWQgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW2hhc0Vycm9ycyA/IF9qc3goUmVmcmVzaEN3LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pIDogX2pzeChQbGF5LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCBoYXNFcnJvcnMgPyAiUmV0cnkgRmFpbGVkIEFuYWx5c2lzIiA6ICJSdW4gQW5hbHlzaXMgTm93Il0gfSkpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJoaWRkZW4gcHJpbnQ6YmxvY2sgcHJpbnQ6bWItNiBwcmludC1uby1icmVhayIsIGNoaWxkcmVuOiBfanN4KFFySGVhZGVyLCB7IHRpdGxlOiByb29tLm5hbWUsIHN1YlRpdGxlOiBgJHtyb29tLmRlcGFydG1lbnR9YCwgc2l0ZU5hbWU6IHN0YXRlLnNpdGVOYW1lLCBjb21wYW55TmFtZTogc3RhdGUuY29tcGFueU5hbWUsIGluc3BlY3Rvck5hbWU6IHN0YXRlLmluc3BlY3Rvck5hbWUsIGRhdGU6IHN0YXRlLmluc3BlY3Rpb25EYXRlLCBsb2dvOiBzdGF0ZS5jb21wYW55TG9nbywgdGhlbWVDb2xvcjogcHJpbWFyeUNvbG9yIH0pIH0pLCAocm9vbS5ldmFjdWF0aW9uUGxhbiB8fCBpc0ZhY2lsaXR5T3JPSFMpICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSBwLTYgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBzaGFkb3ctc20gcHJpbnQtbm8tYnJlYWsgcHJpbnQtY2FyZC1jbGVhbiBwcmludC1zZWN0aW9uLWJvcmRlciIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTQiLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1ibHVlLTkwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LWJsYWNrIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogW19qc3goTWFwSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBFdmFjdWF0aW9uIFBsYW4iXSB9KSwgcm9vbS5ldmFjdWF0aW9uUGxhbiAmJiBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJiZy1ncmVlbi0xMDAgdGV4dC1ncmVlbi03MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBib3JkZXIgYm9yZGVyLWdyZWVuLTIwMCBwcmludDpoaWRkZW4iLCBjaGlsZHJlbjogIkdlbmVyYXRlZCIgfSldIH0pLCByb29tLmV2YWN1YXRpb25QbGFuID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctc2xhdGUtNTAgcm91bmRlZCBib3JkZXIgYm9yZGVyLXNsYXRlLTEwMCBwLTIgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS0zMDAgcHJpbnQ6Ymctd2hpdGUiLCBjaGlsZHJlbjogX2pzeCgiaW1nIiwgeyBzcmM6IHJvb20uZXZhY3VhdGlvblBsYW4sIGNsYXNzTmFtZTogInctZnVsbCBtYXgtaC1bNjAwcHhdIG9iamVjdC1jb250YWluIHByaW50Om1heC1oLVs4Y21dIiB9KSB9KSkgOiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctYmx1ZS01MCBib3JkZXIgYm9yZGVyLWJsdWUtMTAwIHJvdW5kZWQtbGcgcC04IHRleHQtY2VudGVyIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ3LTE2IGgtMTYgYmctYmx1ZS0xMDAgdGV4dC1ibHVlLTYwMCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgbXgtYXV0byBtYi00IiwgY2hpbGRyZW46IF9qc3goTWFwSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTggaC04IiB9KSB9KSwgX2pzeCgiaDQiLCB7IGNsYXNzTmFtZTogInRleHQteGwgZm9udC1ib2xkIHRleHQtYmx1ZS05MDAgbWItMiIsIGNoaWxkcmVuOiAiRXZhY3VhdGlvbiBQbGFuIE1pc3NpbmciIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTYwMCBtYi02IG1heC13LW1kIG14LWF1dG8iLCBjaGlsZHJlbjogIkdlbmVyYXRlIGEgcHJvZmVzc2lvbmFsIGV2YWN1YXRpb24gcGxhbiB3aXRoIGZsb29yIG1hcmtpbmdzIGFuZCBleGl0IHJvdXRlcyB1c2luZyBBSSBiYXNlZCBvbiB0aGUgcm9vbSBsYXlvdXQuIiB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gaGFuZGxlR2VuZXJhdGVQbGFuRm9yUm9vbShyb29tLmlkKSwgZGlzYWJsZWQ6IHN0YXRlLmxvYWRpbmcsIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtNiBweS0zIHJvdW5kZWQtbGcgZm9udC1ib2xkIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbXgtYXV0byIsIGNoaWxkcmVuOiBbc3RhdGUubG9hZGluZyA/IF9qc3goTG9hZGVyMiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IGFuaW1hdGUtc3BpbiIgfSkgOiBfanN4KE1hcEljb24sIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICJHZW5lcmF0ZSBBSSBFdmFjdWF0aW9uIFBsYW4iXSB9KV0gfSkpXSB9KSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xMiBwcmludDpzcGFjZS15LTgiLCBjaGlsZHJlbjogcm9vbS5jYXB0dXJlcy5tYXAoKGNhcHR1cmUsIGlkeCkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNiByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuIHByaW50LXNlY3Rpb24tYm9yZGVyIiwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTQgYm9yZGVyLWIgcGItMiBmbGV4IGp1c3RpZnktYmV0d2VlbiBwcmludDp0ZXh0LWJsYWNrIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciwgYm9yZGVyQ29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogW19qc3hzKCJzcGFuIiwgeyBjaGlsZHJlbjogWyJWaWV3cG9pbnQgIiwgaWR4ICsgMV0gfSksIF9qc3hzKCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIGZvbnQtbm9ybWFsIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IFsiSUQ6ICIsIGNhcHR1cmUuaWQuc3BsaXQoJy0nKVsxXV0gfSldIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1iLTYiLCBjaGlsZHJlbjogY2FwdHVyZS5vdmVybGF5SW1hZ2UgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0yIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KEltYWdlQ29tcGFyZVNsaWRlciwgeyBvcmlnaW5hbDogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBvdmVybGF5OiBjYXB0dXJlLm92ZXJsYXlJbWFnZSB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiaGlkZGVuIHByaW50LWdyaWQtMiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiT3JpZ2luYWwgQ2FwdHVyZSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogInByaW50LWltYWdlLWNvbXBhY3QiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiQW5hbHlzaXMgT3ZlcmxheSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm92ZXJsYXlJbWFnZSwgY2xhc3NOYW1lOiAicHJpbnQtaW1hZ2UtY29tcGFjdCIgfSldIH0pXSB9KV0gfSkpIDogKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImdyaWQgZ3JpZC1jb2xzLTIgZ2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgbWItMiB1cHBlcmNhc2UiLCBjaGlsZHJlbjogIk9yaWdpbmFsIENhcHR1cmUiIH0pLCBfanN4KCJpbWciLCB7IHNyYzogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcm91bmRlZCBiZy1zbGF0ZS0xMDAgYm9yZGVyIGgtNjQgb2JqZWN0LWNvdmVyIiB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy1mdWxsIGgtNjQgYmctc2xhdGUtNTAgYm9yZGVyIHJvdW5kZWQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgdGV4dC14cyBpdGFsaWMiLCBjaGlsZHJlbjogY2FwdHVyZS5lcnJvciA/ICJBbmFseXNpcyBGYWlsZWQiIDogIkFuYWx5c2lzIFBlbmRpbmciIH0pXSB9KSkgfSksIGNhcHR1cmUuZXJyb3IgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC02IGJnLXJlZC01MCBib3JkZXIgYm9yZGVyLXJlZC0yMDAgcm91bmRlZC1sZyB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeChBbGVydENpcmNsZSwgeyBjbGFzc05hbWU6ICJ3LTggaC04IHRleHQtcmVkLTUwMCBteC1hdXRvIG1iLTIiIH0pLCBfanN4KCJoNCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtcmVkLTkwMCIsIGNoaWxkcmVuOiAiQW5hbHlzaXMgRmFpbGVkIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LXJlZC03MDAgbXQtMSBtYi00IiwgY2hpbGRyZW46IGNhcHR1cmUuZXJyb3IgfSldIH0pKSA6IGNhcHR1cmUuYW5hbHlzaXMgPyAoX2pzeChBbmFseXNpc0Rpc3BsYXksIHsgYW5hbHlzaXM6IGNhcHR1cmUuYW5hbHlzaXMgfSkpIDogKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtOCBiZy1hbWJlci01MCBib3JkZXIgYm9yZGVyLWFtYmVyLTEwMCByb3VuZGVkLWxnIHRleHQtY2VudGVyIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3goQ2xvY2ssIHsgY2xhc3NOYW1lOiAidy04IGgtOCB0ZXh0LWFtYmVyLTQwMCBteC1hdXRvIG1iLTIiIH0pLCBfanN4KCJoNCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtYW1iZXItOTAwIiwgY2hpbGRyZW46ICJBbmFseXNpcyBQZW5kaW5nIiB9KV0gfSkpXSB9LCBjYXB0dXJlLmlkKSkpIH0pXSB9KV0gfSkpOwogICAgfQogICAgLy8gUmVwb3J0IFZpZXcgKEZ1bGwgU2l0ZSkKICAgIGlmIChzdGF0ZS52aWV3ID09PSAncmVwb3J0JykgewogICAgICAgIGNvbnN0IGFuYWx5emVkUm9vbXMgPSBzdGF0ZS5yb29tcy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ2FuYWx5emVkJyk7CiAgICAgICAgY29uc3QgdG90YWxDYXB0dXJlcyA9IGFuYWx5emVkUm9vbXMucmVkdWNlKChhY2MsIHIpID0+IGFjYyArIHIuY2FwdHVyZXMubGVuZ3RoLCAwKTsKICAgICAgICBjb25zdCBhdmdTY29yZSA9IHRvdGFsQ2FwdHVyZXMgPiAwCiAgICAgICAgICAgID8gTWF0aC5yb3VuZChhbmFseXplZFJvb21zLnJlZHVjZSgoYWNjLCByKSA9PiBhY2MgKyByLmNhcHR1cmVzLnJlZHVjZSgoY0FjYywgYykgPT4gY0FjYyArIChjLmFuYWx5c2lzPy5zY29yZSB8fCAwKSwgMCkgLyB0b3RhbENhcHR1cmVzKSkKICAgICAgICAgICAgOiAwOwogICAgICAgIGNvbnN0IGFsbFN0YW5kYXJkcyA9IGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMuZmxhdE1hcChjID0+IGMuYW5hbHlzaXM/LnJlbGV2YW50U3RhbmRhcmRzIHx8IFtdKSk7CiAgICAgICAgY29uc3QgdW5pcXVlU3RhbmRhcmRzID0gQXJyYXkuZnJvbShuZXcgTWFwKGFsbFN0YW5kYXJkcy5tYXAoKHMpID0+IFtzLnN0YW5kYXJkSWQsIHNdKSkudmFsdWVzKCkpOwogICAgICAgIGNvbnN0IGFjdGl2ZVNjb3BlTGFiZWwgPSBzdGF0ZS5zY29wZS5tYXAocyA9PiBTQ09QRV9DT05GSUdbc10ubGFiZWwpLmpvaW4oJyArICcpOwogICAgICAgIGNvbnN0IGFjdGl2ZVNjb3BlQ29uZmlnID0gU0NPUEVfQ09ORklHW3N0YXRlLnNjb3BlWzBdXTsKICAgICAgICBjb25zdCB0aGVtZUNvbG9yID0gYWN0aXZlU2NvcGVDb25maWcuaGV4OwogICAgICAgIGNvbnN0IGlzRmFjaWxpdHlTY29wZSA9IHN0YXRlLnNjb3BlLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgICAgIC8vIEFnZ3JlZ2F0ZSBmaW5kaW5ncyBmb3IgRmFjaWxpdHkgU2NvcGUgU3VtbWFyeSBUYWJsZQogICAgICAgIGNvbnN0IGZhY2lsaXR5U3VtbWFyeSA9IGlzRmFjaWxpdHlTY29wZSA/IGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMpLnJlZHVjZSgoYWNjLCBjKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhdCA9IGMuYW5hbHlzaXM/LmNhdGVnb3J5IHx8ICdHZW5lcmFsJzsKICAgICAgICAgICAgaWYgKCFhY2NbY2F0XSkKICAgICAgICAgICAgICAgIGFjY1tjYXRdID0geyBzY29yZVN1bTogMCwgY291bnQ6IDAsIGlzc3VlczogMCB9OwogICAgICAgICAgICBhY2NbY2F0XS5zY29yZVN1bSArPSBjLmFuYWx5c2lzPy5zY29yZSB8fCAwOwogICAgICAgICAgICBhY2NbY2F0XS5jb3VudCArPSAxOwogICAgICAgICAgICBhY2NbY2F0XS5pc3N1ZXMgKz0gKGMuYW5hbHlzaXM/LmRldGFpbGVkRmluZGluZ3M/LmZpbHRlcihmID0+IGYudHlwZSAhPT0gJ0dvb2QgY29uZGl0aW9uJykubGVuZ3RoIHx8IDApOwogICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0sIHt9KSA6IG51bGw7CiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtMTAwIHByaW50OmJnLXdoaXRlIHByaW50Om1pbi1oLTAiLCBjaGlsZHJlbjogW19qc3goInN0eWxlIiwgeyBjaGlsZHJlbjogR2xvYmFsUHJpbnRTdHlsZXMgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBzdGlja3kgdG9wLTAgei01MCBzaGFkb3ctbWQgcHJpbnQ6aGlkZGVuIiwgY2hpbGRyZW46IF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1heC13LTV4bCBteC1hdXRvIHB4LTQgaC0xNiBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4iLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHNldFZpZXcoJ2Rhc2hib2FyZCcpLCBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBob3Zlcjp0ZXh0LWJsdWUtOTAwIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBCYWNrIHRvIERhc2hib2FyZCJdIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiB3aW5kb3cucHJpbnQoKSwgY2xhc3NOYW1lOiAiYmctYmx1ZS02MDAgdGV4dC13aGl0ZSBweC00IHB5LTIgcm91bmRlZC1sZyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBob3ZlcjpiZy1ibHVlLTcwMCBmb250LWJvbGQgc2hhZG93LXNtIiwgY2hpbGRyZW46IFtfanN4KFByaW50ZXIsIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgUHJpbnQgRnVsbCBSZXBvcnQiXSB9KV0gfSkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1heC13LTV4bCBteC1hdXRvIHAtOCBwcmludDpwLTAgcHJpbnQ6bWF4LXctbm9uZSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJpbnQtY292ZXItcGFnZSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50Om1iLTgiLCBjaGlsZHJlbjogX2pzeChRckhlYWRlciwgeyB0aXRsZTogIlNpdGUgSW5zcGVjdGlvbiBSZXBvcnQiLCBzdWJUaXRsZTogYWN0aXZlU2NvcGVMYWJlbCwgc2l0ZU5hbWU6IHN0YXRlLnNpdGVOYW1lLCBjb21wYW55TmFtZTogc3RhdGUuY29tcGFueU5hbWUsIGluc3BlY3Rvck5hbWU6IHN0YXRlLmluc3BlY3Rvck5hbWUsIGRhdGU6IHN0YXRlLmluc3BlY3Rpb25EYXRlLCBsb2dvOiBzdGF0ZS5jb21wYW55TG9nbywgdGhlbWVDb2xvcjogdGhlbWVDb2xvciB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBnYXAtOCBtYi04IHByaW50LW5vLWJyZWFrIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0zIGdhcC00IHRleHQtY2VudGVyIHByaW50OmdyaWQgcHJpbnQ6Z2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNCByb3VuZGVkLXhsIHNoYWRvdy1zbSBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHByaW50OnRleHQtYmxhY2siLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogYW5hbHl6ZWRSb29tcy5sZW5ndGggfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB0ZXh0LXNsYXRlLTUwMCB1cHBlcmNhc2UgZm9udC1ib2xkIiwgY2hpbGRyZW46ICJBcmVhcyBBdWRpdGVkIiB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNCByb3VuZGVkLXhsIHNoYWRvdy1zbSBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHByaW50OnRleHQtYmxhY2siLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogdG90YWxDYXB0dXJlcyB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQiLCBjaGlsZHJlbjogIlRvdGFsIFZpZXdwb2ludHMiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgYmctd2hpdGUgcC00IHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW5gLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQtM3hsIGZvbnQtYm9sZCAke2dldFNjb3JlQ29sb3IoYXZnU2NvcmUpfSBwcmludDp0ZXh0LWJsYWNrYCwgY2hpbGRyZW46IFthdmdTY29yZSwgIiUiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQiLCBjaGlsZHJlbjogIlNpdGUgQ29tcGxpYW5jZSIgfSldIH0pXSB9KSwgc3RhdGUuZ2VvTG9jYXRpb24gJiYgc3RhdGUuZ2VvTG9jYXRpb24gIT09ICdGZXRjaGluZy4uLicgJiYgc3RhdGUuZ2VvTG9jYXRpb24gIT09ICdOb3QgU3VwcG9ydGVkJyAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgcC0xIHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIG92ZXJmbG93LWhpZGRlbiBoLTQwIHJlbGF0aXZlIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS0zMDAgcHJpbnQ6aC0zMiIsIGNoaWxkcmVuOiBbX2pzeCgiaWZyYW1lIiwgeyB3aWR0aDogIjEwMCUiLCBoZWlnaHQ6ICIxMDAlIiwgZnJhbWVCb3JkZXI6ICIwIiwgc2Nyb2xsaW5nOiAibm8iLCBtYXJnaW5IZWlnaHQ6IDAsIG1hcmdpbldpZHRoOiAwLCB0aXRsZTogIlNpdGUgTG9jYXRpb24iLCBzcmM6IGBodHRwczovL21hcHMuZ29vZ2xlLmNvbS9tYXBzP3E9JHtlbmNvZGVVUklDb21wb25lbnQoc3RhdGUuZ2VvTG9jYXRpb24pfSZ0PSZ6PTEzJmllPVVURjgmaXdsb2M9Jm91dHB1dD1lbWJlZGAsIGNsYXNzTmFtZTogInJvdW5kZWQtbGciIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMiBsZWZ0LTIgYmctd2hpdGUvOTAgYmFja2Ryb3AtYmx1ciBweC0yIHB5LTEgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBzaGFkb3ctc20gdGV4dC1zbGF0ZS03MDAgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS00MDAiLCBjaGlsZHJlbjogW19qc3goTWFwUGluLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiICIsIHN0YXRlLmdlb0xvY2F0aW9uXSB9KV0gfSkpXSB9KV0gfSksIGlzRmFjaWxpdHlTY29wZSAmJiBmYWNpbGl0eVN1bW1hcnkgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHJvdW5kZWQteGwgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgc2hhZG93LXNtIHAtNiBtYi04IHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1ibHVlLTkwMCBtYi00IGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJvcmRlci1iIGJvcmRlci1zbGF0ZS0xMDAgcGItMiBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1zbGF0ZS0zMDAiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogW19qc3goTGF5b3V0RGFzaGJvYXJkLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIENhdGVnb3J5IFN1bW1hcnkiXSB9KSwgX2pzeHMoInRhYmxlIiwgeyBjbGFzc05hbWU6ICJ3LWZ1bGwgdGV4dC1zbSB0ZXh0LWxlZnQiLCBjaGlsZHJlbjogW19qc3goInRoZWFkIiwgeyBjbGFzc05hbWU6ICJiZy1zbGF0ZS01MCBmb250LWJvbGQgdGV4dC1zbGF0ZS03MDAiLCBjaGlsZHJlbjogX2pzeHMoInRyIiwgeyBjaGlsZHJlbjogW19qc3goInRoIiwgeyBjbGFzc05hbWU6ICJwLTIgYm9yZGVyLWIiLCBjaGlsZHJlbjogIkNhdGVnb3J5IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiSW1hZ2VzIiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiQXZnIFNjb3JlIiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiRmluZGluZ3MiIH0pXSB9KSB9KSwgX2pzeCgidGJvZHkiLCB7IGNoaWxkcmVuOiBPYmplY3QuZW50cmllcyhmYWNpbGl0eVN1bW1hcnkpLm1hcCgoW2NhdCwgc3RhdHNdKSA9PiAoX2pzeHMoInRyIiwgeyBjbGFzc05hbWU6ICJib3JkZXItYiBsYXN0OmJvcmRlci0wIiwgY2hpbGRyZW46IFtfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0yIGZvbnQtbWVkaXVtIiwgY2hpbGRyZW46IGNhdCB9KSwgX2pzeCgidGQiLCB7IGNsYXNzTmFtZTogInAtMiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBzdGF0cy5jb3VudCB9KSwgX2pzeHMoInRkIiwgeyBjbGFzc05hbWU6ICJwLTIgdGV4dC1jZW50ZXIiLCBjaGlsZHJlbjogW01hdGgucm91bmQoc3RhdHMuc2NvcmVTdW0gLyBzdGF0cy5jb3VudCksICIlIl0gfSksIF9qc3goInRkIiwgeyBjbGFzc05hbWU6ICJwLTIgdGV4dC1jZW50ZXIiLCBjaGlsZHJlbjogc3RhdHMuaXNzdWVzID4gMCA/IChfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1yZWQtNjAwIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiBbc3RhdHMuaXNzdWVzLCAiIElzc3VlcyJdIH0pKSA6IChfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyZWVuLTYwMCBmb250LWJvbGQiLCBjaGlsZHJlbjogIkdvb2QiIH0pKSB9KV0gfSwgY2F0KSkpIH0pXSB9KV0gfSkpLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwLTYgbWItOCBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWxnIHRleHQtYmx1ZS05MDAgbWItNCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBib3JkZXItYiBib3JkZXItc2xhdGUtMTAwIHBiLTIgcHJpbnQ6dGV4dC1ibGFjayBwcmludDpib3JkZXItc2xhdGUtMzAwIiwgc3R5bGU6IHsgY29sb3I6IHRoZW1lQ29sb3IgfSwgY2hpbGRyZW46IFtfanN4KEdhdmVsLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIEFwcGxpY2FibGUgUmVndWxhdG9yeSBGcmFtZXdvcmsiXSB9KSwgdW5pcXVlU3RhbmRhcmRzLmxlbmd0aCA+IDAgPyAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC00IiwgY2hpbGRyZW46IHVuaXF1ZVN0YW5kYXJkcy5tYXAoKHMsIGkpID0+IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zIHAtMyBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMTAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6cC0wIHByaW50Om1iLTIgcHJpbnQ6YmxvY2siLCBjaGlsZHJlbjogW3Muc3RhbmRhcmRJZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsb2NhbCcpID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctaW5kaWdvLTYwMCB0ZXh0LXdoaXRlIHAtMS41IHJvdW5kZWQgbXQtMC41IHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KE1hcFBpbiwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy1ibHVlLTYwMCB0ZXh0LXdoaXRlIHAtMS41IHJvdW5kZWQgbXQtMC41IHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KEdsb2JlLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pIH0pKSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTgwMCB0ZXh0LXNtIiwgY2hpbGRyZW46IHMuc3RhbmRhcmRJZC5yZXBsYWNlKC9cWy4qP1xdL2csICcnKS50cmltKCkgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiBzLmRlc2NyaXB0aW9uIH0pXSB9KV0gfSwgaSkpKSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBpdGFsaWMgdGV4dC1zbSIsIGNoaWxkcmVuOiAiTm8gc3BlY2lmaWMgc3RhbmRhcmRzIHdlcmUgY2l0ZWQgaW4gdGhlIGFuYWx5c2lzIHJlc3VsdHMuIiB9KSldIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEyIHByaW50OnNwYWNlLXktMCIsIGNoaWxkcmVuOiBhbmFseXplZFJvb21zLm1hcCgocm9vbSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50LWJyZWFrLWJlZm9yZSBtYi0xNiBsYXN0Om1iLTAgcHJpbnQ6bWItMCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy1ibHVlLTkwMCB0ZXh0LXdoaXRlIHAtNCByb3VuZGVkLXQtbGcgbWItNiBwcmludDpiZy13aGl0ZSBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1iLTIgcHJpbnQ6Ym9yZGVyLWJsYWNrIHByaW50OnJvdW5kZWQtbm9uZSBwcmludDpweC0wIHByaW50Om1iLTQgcHJpbnQtbm8tYnJlYWsiLCBzdHlsZTogeyBib3JkZXJDb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtZW5kIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB1cHBlcmNhc2UgZm9udC1ib2xkIHRleHQtYmx1ZS0yMDAgcHJpbnQ6dGV4dC1zbGF0ZS01MDAgbWItMSIsIGNoaWxkcmVuOiByb29tLmRlcGFydG1lbnQgfSksIF9qc3goImgyIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXJpZ2h0IiwgY2hpbGRyZW46IF9qc3hzKCJwIiwgeyBjbGFzc05hbWU6ICJvcGFjaXR5LTcwIHRleHQtc20gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogWyJBdWRpdGVkOiAiLCBuZXcgRGF0ZShyb29tLnRpbWVzdGFtcCkudG9Mb2NhbGVEYXRlU3RyaW5nKCldIH0pIH0pXSB9KSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIGdhcC0xMiBwcmludDpnYXAtNCIsIGNoaWxkcmVuOiByb29tLmNhcHR1cmVzLm1hcCgoY2FwdHVyZSwgaWR4KSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJpbnQtbm8tYnJlYWsgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBwYi04IGxhc3Q6Ym9yZGVyLTAgcHJpbnQ6Ym9yZGVyLW5vbmUgcHJpbnQ6cGItMCBwcmludDptYi00IHByaW50LXNlY3Rpb24tYm9yZGVyIiwgY2hpbGRyZW46IFtfanN4cygiaDQiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTQgdGV4dC1sZyBwcmludDp0ZXh0LWJsYWNrIHByaW50OnRleHQtYmFzZSIsIHN0eWxlOiB7IGNvbG9yOiB0aGVtZUNvbG9yIH0sIGNoaWxkcmVuOiBbIlZpZXdwb2ludCAiLCBpZHggKyAxXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMiBnYXAtNiBtYi02IHByaW50LWdyaWQtMiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtY2VudGVyIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiT3JpZ2luYWwgU2NlbmUiIH0pLCBfanN4KCJpbWciLCB7IHNyYzogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBjbGFzc05hbWU6ICJ3LWZ1bGwgaC02NCBvYmplY3QtY292ZXIgYm9yZGVyIHJvdW5kZWQtbGcgc2hhZG93LXNtIHByaW50LWltYWdlLWNvbXBhY3QiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtY2VudGVyIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiQUkgQW5hbHlzaXMgT3ZlcmxheSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm92ZXJsYXlJbWFnZSB8fCBjYXB0dXJlLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogInctZnVsbCBoLTY0IG9iamVjdC1jb3ZlciBib3JkZXIgcm91bmRlZC1sZyBzaGFkb3ctc20gcHJpbnQtaW1hZ2UtY29tcGFjdCIgfSldIH0pXSB9KSwgY2FwdHVyZS5hbmFseXNpcyA/IChfanN4KEFuYWx5c2lzRGlzcGxheSwgeyBhbmFseXNpczogY2FwdHVyZS5hbmFseXNpcywgY29tcGFjdDogZmFsc2UsIGhpZGVJdGVtczogdHJ1ZSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXJlZC01MDAgZm9udC1ib2xkIHRleHQtc20gaXRhbGljIiwgY2hpbGRyZW46ICJBbmFseXNpcyBGYWlsZWQgZm9yIHRoaXMgdmlld3BvaW50LiIgfSkpXSB9LCBjYXB0dXJlLmlkKSkpIH0pLCByb29tLmV2YWN1YXRpb25QbGFuICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC04IHAtNCBwcmludC1uby1icmVhayBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCByb3VuZGVkLWxnIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6bXQtNCBwcmludC1zZWN0aW9uLWJvcmRlciIsIGNoaWxkcmVuOiBbX2pzeCgiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCBtYi00IHRleHQtYmx1ZS05MDAgYm9yZGVyLWIgcGItMiBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1zbGF0ZS0zMDAiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogIkV2YWN1YXRpb24gUGxhbiIgfSksIF9qc3goImltZyIsIHsgc3JjOiByb29tLmV2YWN1YXRpb25QbGFuLCBjbGFzc05hbWU6ICJtYXgtaC1bNjAwcHhdIG9iamVjdC1jb250YWluIHctZnVsbCBwcmludDptYXgtaC1bOGNtXSIgfSldIH0pKV0gfSwgcm9vbS5pZCkpKSB9KSwgaXNGYWNpbGl0eVNjb3BlICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC0xMiBiZy13aGl0ZSByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwLTggcHJpbnQtbm8tYnJlYWsgcHJpbnQtY2FyZC1jbGVhbiBwcmludDpicmVhay1iZWZvcmUtcGFnZSIsIGNoaWxkcmVuOiBbX2pzeHMoImgzIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC14bCB0ZXh0LWJsdWUtOTAwIG1iLTYgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgYm9yZGVyLWItMiBib3JkZXItc2xhdGUtMjAwIHBiLTQgcHJpbnQ6dGV4dC1ibGFjayIsIHN0eWxlOiB7IGJvcmRlckNvbG9yOiB0aGVtZUNvbG9yLCBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogW19qc3goQWN0aXZpdHksIHsgY2xhc3NOYW1lOiAidy02IGgtNiIgfSksICIgRmluYWwgRXZhbHVhdGlvbiJdIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtOCBtYi04IiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQgbWItMSIsIGNoaWxkcmVuOiAiT3ZlcmFsbCBTY29yZSIgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtNXhsIGZvbnQtYmxhY2sgdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogW2F2Z1Njb3JlLCAiJSJdIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgZmxleC0xIHAtNiByb3VuZGVkLXhsIGJvcmRlciBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCAke2F2Z1Njb3JlID49IDcwID8gJ2JnLWdyZWVuLTUwIGJvcmRlci1ncmVlbi0yMDAnIDogJ2JnLXJlZC01MCBib3JkZXItcmVkLTIwMCd9YCwgY2hpbGRyZW46IFthdmdTY29yZSA+PSA3MCA/IF9qc3goVGh1bWJzVXAsIHsgY2xhc3NOYW1lOiAidy0xMiBoLTEyIHRleHQtZ3JlZW4tNjAwIiB9KSA6IF9qc3goVGh1bWJzRG93biwgeyBjbGFzc05hbWU6ICJ3LTEyIGgtMTIgdGV4dC1yZWQtNjAwIiB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQtMnhsIGZvbnQtYm9sZCAke2F2Z1Njb3JlID49IDcwID8gJ3RleHQtZ3JlZW4tODAwJyA6ICd0ZXh0LXJlZC04MDAnfWAsIGNoaWxkcmVuOiBhdmdTY29yZSA+PSA3MCA/ICdQQVNTJyA6ICdGQUlMJyB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46IGF2Z1Njb3JlID49IDcwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICJGYWNpbGl0eSBtZWV0cyB0aGUgYmFzZWxpbmUgdmlzdWFsIGluc3BlY3Rpb24gc3RhbmRhcmRzLiBNaW5vciBpbXByb3ZlbWVudHMgcmVjb21tZW5kZWQuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAiQ3JpdGljYWwgbm9uLWNvbmZvcm1pdGllcyBkZXRlY3RlZC4gSW1tZWRpYXRlIGNvcnJlY3RpdmUgYWN0aW9uIHJlcXVpcmVkLiIgfSldIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgiaDQiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB1cHBlcmNhc2UgdGV4dC1zbSBtYi00IiwgY2hpbGRyZW46ICJQcmlvcml0eSBJbXByb3ZlbWVudCBBY3Rpb25zIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0zIiwgY2hpbGRyZW46IFthbmFseXplZFJvb21zLmZsYXRNYXAociA9PiByLmNhcHR1cmVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZsYXRNYXAoYyA9PiBjLmFuYWx5c2lzPy5kZXRhaWxlZEZpbmRpbmdzIHx8IFtdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmID0+IGYucmlzayA9PT0gJ0hpZ2gnIHx8IGYudHlwZSA9PT0gJ1NhZmV0eSBoYXphcmQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWNlKDAsIDUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChmLCBpKSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMyBwLTMgYmctcmVkLTUwIGJvcmRlciBib3JkZXItcmVkLTEwMCByb3VuZGVkLWxnIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXJlZC0yMDAgdGV4dC1yZWQtODAwIGZvbnQtYm9sZCB3LTYgaC02IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXhzIHNocmluay0wIiwgY2hpbGRyZW46IGkgKyAxIH0pLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtcmVkLTkwMCB0ZXh0LXNtIiwgY2hpbGRyZW46IGYuaXNzdWUgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS02MDAgdGV4dC14cyBpdGFsaWMiLCBjaGlsZHJlbjogZi5yZWNvbW1lbmRhdGlvbiB9KV0gfSldIH0sIGkpKSksIGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMpLmZsYXRNYXAoYyA9PiBjLmFuYWx5c2lzPy5kZXRhaWxlZEZpbmRpbmdzIHx8IFtdKS5maWx0ZXIoZiA9PiBmLnJpc2sgPT09ICdIaWdoJykubGVuZ3RoID09PSAwICYmIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNTAwIGl0YWxpYyIsIGNoaWxkcmVuOiAiTm8gaGlnaC1yaXNrIHByaW9yaXR5IGFjdGlvbnMgaWRlbnRpZmllZC4iIH0pKV0gfSldIH0pXSB9KSksICFpc0ZhY2lsaXR5U2NvcGUgJiYgKGFuYWx5emVkUm9vbXMubWFwKHJvb20gPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9vbUl0ZW1zID0gcm9vbS5jYXB0dXJlcy5mbGF0TWFwKGMgPT4gYy5hbmFseXNpcz8ucmVjb21tZW5kZWRJdGVtcyB8fCBbXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm9vbUl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm10LTggYmctd2hpdGUgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBzaGFkb3ctc20gcC02IHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6bXQtNiByZW1lZGlhdGlvbi1tYW5pZmVzdCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1lbWVyYWxkLTkwMCBtYi00IGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJvcmRlci1iIGJvcmRlci1lbWVyYWxkLTEwMCBwYi0yIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBbX2pzeChTaG9wcGluZ0JhZywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBSZW1lZGlhdGlvbiBCaWxsIG9mIE1hdGVyaWFscyAoIiwgcm9vbS5uYW1lLCAiKSJdIH0pLCBfanN4cygidGFibGUiLCB7IGNsYXNzTmFtZTogInctZnVsbCB0ZXh0LXNtIHRleHQtbGVmdCIsIGNoaWxkcmVuOiBbX2pzeCgidGhlYWQiLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtNTAgdGV4dC1lbWVyYWxkLTkwMCBmb250LWJvbGQgYm9yZGVyLWIgYm9yZGVyLWVtZXJhbGQtMjAwIiwgY2hpbGRyZW46IF9qc3hzKCJ0ciIsIHsgY2hpbGRyZW46IFtfanN4KCJ0aCIsIHsgY2xhc3NOYW1lOiAicC0zIiwgY2hpbGRyZW46ICJJdGVtIC8gRXF1aXBtZW50IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMyIsIGNoaWxkcmVuOiAiUmVxdWlyZWQgUXR5IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMyIsIGNoaWxkcmVuOiAiUmVhc29uIC8gSGF6YXJkIiB9KV0gfSkgfSksIF9qc3goInRib2R5IiwgeyBjbGFzc05hbWU6ICJkaXZpZGUteSBkaXZpZGUtc2xhdGUtMTAwIiwgY2hpbGRyZW46IHJvb21JdGVtcy5tYXAoKGl0ZW0sIGlkeCkgPT4gKF9qc3hzKCJ0ciIsIHsgY2xhc3NOYW1lOiAiaG92ZXI6Ymctc2xhdGUtNTAiLCBjaGlsZHJlbjogW19qc3goInRkIiwgeyBjbGFzc05hbWU6ICJwLTMgZm9udC1tZWRpdW0gdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogaXRlbS5pdGVtIH0pLCBfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0zIiwgY2hpbGRyZW46IF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtMTAwIHRleHQtZW1lcmFsZC04MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCB3aGl0ZXNwYWNlLW5vd3JhcCIsIGNoaWxkcmVuOiBpdGVtLnF1YW50aXR5IH0pIH0pLCBfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0zIHRleHQtc2xhdGUtNTAwIHRleHQteHMgaXRhbGljIiwgY2hpbGRyZW46IGl0ZW0ucmVhc29uIH0pXSB9LCBpZHgpKSkgfSldIH0pXSB9LCByb29tLmlkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogIm10LTEyIHRleHQtY2VudGVyIHByaW50OmhpZGRlbiBwYi0xMiIsIGNoaWxkcmVuOiBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRWaWV3KCdkYXNoYm9hcmQnKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgaG92ZXI6dGV4dC1ibHVlLTkwMCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTIgbXgtYXV0byIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBSZXR1cm4gdG8gRGFzaGJvYXJkIl0gfSkgfSldIH0pXSB9KSk7CiAgICB9CiAgICAvLyBEYXNoYm9hcmQgLi4uIChyZXN0IHVuY2hhbmdlZCkKICAgIGNvbnN0IHBlbmRpbmdSb29tc0NvdW50ID0gc3RhdGUucm9vbXMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdwZW5kaW5nJykubGVuZ3RoOwogICAgY29uc3QgZXJyb3JSb29tc0NvdW50ID0gc3RhdGUucm9vbXMuZmlsdGVyKHIgPT4gci5jYXB0dXJlcy5zb21lKGMgPT4gYy5lcnJvcikpLmxlbmd0aDsKICAgIHJldHVybiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWluLWgtc2NyZWVuIGJnLXNsYXRlLTUwIGZsZXggZmxleC1jb2wiLCBjaGlsZHJlbjogW19qc3goInN0eWxlIiwgeyBjaGlsZHJlbjogR2xvYmFsUHJpbnRTdHlsZXMgfSksIF9qc3goQWN0aXZpdHlMb2dNb2RhbCwgeyBsb2dzOiBzdGF0ZS5sb2dzLCBpc09wZW46IHN0YXRlLnNob3dMb2dzLCBvbkNsb3NlOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHNob3dMb2dzOiBmYWxzZSB9KSkgfSksIF9qc3goIm5hdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBzdGlja3kgdG9wLTAgei0xMCBzaHJpbmstMCIsIGNoaWxkcmVuOiBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy01eGwgbXgtYXV0byBweC00IGgtMTYgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGB3LTggaC04IHJvdW5kZWQtbGcgJHtzdGF0ZS5zY29wZS5sZW5ndGggPiAwID8gU0NPUEVfQ09ORklHW3N0YXRlLnNjb3BlWzBdXS5jb2xvciA6ICdiZy1zbGF0ZS01MDAnfSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXdoaXRlYCwgY2hpbGRyZW46IHN0YXRlLnNjb3BlLmluY2x1ZGVzKCdGYWNpbGl0eScpID8gX2pzeChDbGlwYm9hcmRDaGVjaywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSA6IF9qc3goU2hpZWxkLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGZsZXgtY29sIiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1ibHVlLTkwMCB0ZXh0LXNtIGxlYWRpbmctdGlnaHQiLCBjaGlsZHJlbjogc3RhdGUuY29tcGFueU5hbWUgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0xIHRleHQteHMgdGV4dC1zbGF0ZS01MDAiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRydW5jYXRlIG1heC13LVsyMDBweF0iLCBjaGlsZHJlbjogc3RhdGUuc2l0ZU5hbWUgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogIm14LTEiLCBjaGlsZHJlbjogIlx1MjAyMiIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRydW5jYXRlIG1heC13LVsyMDBweF0iLCBjaGlsZHJlbjogc3RhdGUuc2NvcGUubWFwKHMgPT4gU0NPUEVfQ09ORklHW3NdLmxhYmVsKS5qb2luKCcsICcpIH0pXSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyIsIGNoaWxkcmVuOiBbX2pzeCgiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHNob3dMb2dzOiB0cnVlIH0pKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgaG92ZXI6dGV4dC1ibHVlLTYwMCBwLTIgcm91bmRlZC1mdWxsIGhvdmVyOmJnLXNsYXRlLTUwIHRyYW5zaXRpb24tY29sb3JzIiwgdGl0bGU6ICJWaWV3IEFjdGl2aXR5IExvZyIsIGNoaWxkcmVuOiBfanN4KEhpc3RvcnksIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSkgfSksIHN0YXRlLnJvb21zLnNvbWUociA9PiByLnN0YXR1cyA9PT0gJ2FuYWx5emVkJyAmJiAhci5jYXB0dXJlcy5zb21lKGMgPT4gYy5lcnJvcikpICYmIChfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRWaWV3KCdyZXBvcnQnKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS02MDAgaG92ZXI6dGV4dC1ibHVlLTkwMCBmb250LW1lZGl1bSB0ZXh0LXNtIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRyYW5zaXRpb24tY29sb3JzIiwgY2hpbGRyZW46IFtfanN4KEZpbGVUZXh0LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIFNpdGUgUmVwb3J0Il0gfSkpXSB9KV0gfSkgfSksIF9qc3hzKCJtYWluIiwgeyBjbGFzc05hbWU6IGBtYXgtdy01eGwgbXgtYXV0byBwLTYgdy1mdWxsICR7c3RhdGUucm9vbXMubGVuZ3RoID09PSAwID8gJ2ZsZXgtMSBmbGV4IGZsZXgtY29sJyA6ICcnfWAsIGNoaWxkcmVuOiBbKHBlbmRpbmdSb29tc0NvdW50ID4gMCB8fCBlcnJvclJvb21zQ291bnQgPiAwKSAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgbWItOCBwLTYgcm91bmRlZC14bCB0ZXh0LXdoaXRlIHNoYWRvdy1sZyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gJHtlcnJvclJvb21zQ291bnQgPiAwID8gJ2JnLWFtYmVyLTcwMCcgOiAnYmctaW5kaWdvLTkwMCd9YCwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3hzKCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC14bCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW2Vycm9yUm9vbXNDb3VudCA+IDAgPyBfanN4KEFsZXJ0Q2lyY2xlLCB7IGNsYXNzTmFtZTogInctNSBoLTUgdGV4dC1hbWJlci0yMDAiIH0pIDogX2pzeChTcGFya2xlcywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IHRleHQtaW5kaWdvLTMwMCIgfSksIGVycm9yUm9vbXNDb3VudCA+IDAgPyAiRmFpbHVyZXMgRGV0ZWN0ZWQiIDogIkFjdGlvbiBSZXF1aXJlZCJdIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXdoaXRlLzgwIHRleHQtc20gbXQtMSIsIGNoaWxkcmVuOiBlcnJvclJvb21zQ291bnQgPiAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgJHtlcnJvclJvb21zQ291bnR9IGFyZWEocykgZmFpbGVkIGFuYWx5c2lzLiBQbGVhc2UgY2hlY2sgaW50ZXJuZXQgYW5kIHJldHJ5LmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGAke3BlbmRpbmdSb29tc0NvdW50fSBhcmVhKHMpIGFyZSBxdWV1ZWQgZm9yIGFuYWx5c2lzLiBSdW4gYmF0Y2ggcHJvY2Vzc2luZy5gIH0pXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogaGFuZGxlQmF0Y2hBbmFseXplLCBkaXNhYmxlZDogc3RhdGUubG9hZGluZywgY2xhc3NOYW1lOiAiYmctd2hpdGUgdGV4dC1pbmRpZ28tOTAwIHB4LTYgcHktMyByb3VuZGVkLWxnIGZvbnQtYm9sZCBob3ZlcjpiZy1pbmRpZ28tNTAgdHJhbnNpdGlvbi1jb2xvcnMgc2hhZG93LWxnIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIiwgY2hpbGRyZW46IFtzdGF0ZS5sb2FkaW5nID8gX2pzeChMb2FkZXIyLCB7IGNsYXNzTmFtZTogInctNSBoLTUgYW5pbWF0ZS1zcGluIiB9KSA6IGVycm9yUm9vbXNDb3VudCA+IDAgPyBfanN4KFJlZnJlc2hDdywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSA6IF9qc3goUGxheSwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgZXJyb3JSb29tc0NvdW50ID4gMCA/ICJSZXRyeSBBbGwgRmFpbGVkIiA6ICJBbmFseXplIEFsbCBQZW5kaW5nIl0gfSldIH0pKSwgc3RhdGUucm9vbXMubGVuZ3RoID4gMCAmJiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGxnOmdyaWQtY29scy0zIGdhcC02IG1iLTgiLCBjaGlsZHJlbjogc3RhdGUucm9vbXMubWFwKChyb29tKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aHVtYiA9IHJvb20uY2FwdHVyZXNbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1BlbmRpbmcgPSByb29tLnN0YXR1cyA9PT0gJ3BlbmRpbmcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzRXJyb3IgPSByb29tLmNhcHR1cmVzLnNvbWUoYyA9PiBjLmVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjb3JlID0gIWlzUGVuZGluZyAmJiAhaGFzRXJyb3IgJiYgcm9vbS5jYXB0dXJlcy5sZW5ndGggPiAwID8gTWF0aC5yb3VuZChyb29tLmNhcHR1cmVzLnJlZHVjZSgoYWNjLCBjKSA9PiBhY2MgKyAoYy5hbmFseXNpcz8uc2NvcmUgfHwgMCksIDApIC8gcm9vbS5jYXB0dXJlcy5sZW5ndGgpIDogMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoX2pzeHMoImRpdiIsIHsgb25DbGljazogKCkgPT4geyBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGFjdGl2ZVJvb21JZDogcm9vbS5pZCwgdmlldzogJ3Jvb20tZGV0YWlsJyB9KSk7IH0sIGNsYXNzTmFtZTogYGJnLXdoaXRlIHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBvdmVyZmxvdy1oaWRkZW4gaG92ZXI6c2hhZG93LW1kIGN1cnNvci1wb2ludGVyIHRyYW5zaXRpb24tYWxsIGdyb3VwICR7aGFzRXJyb3IgPyAnYm9yZGVyLXJlZC0zMDAnIDogaXNQZW5kaW5nID8gJ2JvcmRlci1hbWJlci0yMDAnIDogJ2JvcmRlci1zbGF0ZS0yMDAgaG92ZXI6Ym9yZGVyLWJsdWUtNDAwJ31gLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInJlbGF0aXZlIGgtNDggYmctc2xhdGUtMTAwIiwgY2hpbGRyZW46IFtfanN4KCJpbWciLCB7IHNyYzogdGh1bWIub3ZlcmxheUltYWdlIHx8IHRodW1iLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogYHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIHRyYW5zaXRpb24tdHJhbnNmb3JtIGdyb3VwLWhvdmVyOnNjYWxlLTEwNSAke2lzUGVuZGluZyB8fCBoYXNFcnJvciA/ICdvcGFjaXR5LTgwIGdyYXlzY2FsZS1bMC41XScgOiAnJ31gIH0pLCBpc1BlbmRpbmcgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTIgcmlnaHQtMiBiZy1hbWJlci01MDAgdGV4dC13aGl0ZSBweC0yIHB5LTEgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBzaGFkb3ctc20gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiLCBjaGlsZHJlbjogW19qc3goQ2xvY2ssIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSksICIgUGVuZGluZyJdIH0pKSA6IGhhc0Vycm9yID8gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC0yIHJpZ2h0LTIgYmctcmVkLTUwMCB0ZXh0LXdoaXRlIHB4LTIgcHktMSByb3VuZGVkIHRleHQteHMgZm9udC1ib2xkIHNoYWRvdy1zbSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSIsIGNoaWxkcmVuOiBbX2pzeChBbGVydFRyaWFuZ2xlLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiIEZhaWxlZCJdIH0pKSA6IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMiByaWdodC0yIGJnLXdoaXRlLzkwIGJhY2tkcm9wLWJsdXIgcHgtMiBweS0xIHJvdW5kZWQgdGV4dC14cyBmb250LWJvbGQgc2hhZG93LXNtIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogWyJTY29yZTogIiwgc2NvcmVdIH0pKSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgYm90dG9tLTIgcmlnaHQtMiBiZy1ibGFjay81MCB0ZXh0LXdoaXRlIHB4LTIgcHktMSByb3VuZGVkIHRleHQteHMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiLCBjaGlsZHJlbjogW19qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiICIsIHJvb20uY2FwdHVyZXMubGVuZ3RoXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0xIiwgY2hpbGRyZW46IF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTYwMCB0ZXh0LVsxMHB4XSBmb250LWJvbGQgcHgtMS41IHB5LTAuNSByb3VuZGVkIHVwcGVyY2FzZSB0cmFja2luZy13aWRlIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KSB9KSwgX2pzeCgiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHRydW5jYXRlIHRleHQtbGciLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIG10LTEgZmxleCBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2hpbGRyZW46IG5ldyBEYXRlKHJvb20udGltZXN0YW1wKS50b0xvY2FsZURhdGVTdHJpbmcoKSB9KSwgcm9vbS5ldmFjdWF0aW9uUGxhbiAmJiBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1ibHVlLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSBmb250LW1lZGl1bSIsIGNoaWxkcmVuOiBbX2pzeChNYXBJY29uLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiIFBsYW4gUmVhZHkiXSB9KV0gfSldIH0pXSB9LCByb29tLmlkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pIH0pKSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGAKICAgICAgICAgICAgcmVsYXRpdmUgdHJhbnNpdGlvbi1hbGwgZ3JvdXAKICAgICAgICAgICAgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2ZsZXgtMSBib3JkZXItNCBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgYmctc2xhdGUtMTAwLzUwIHJvdW5kZWQtM3hsIGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLVs1MDBweF0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdiZy13aGl0ZSByb3VuZGVkLTJ4bCBib3JkZXItMiBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgcC04IHNoYWRvdy1zbSd9CiAgICAgICAgICBgLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXctbWQgbXgtYXV0byB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGAKICAgICAgICAgICAgICByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgbXgtYXV0byBtYi00CiAgICAgICAgICAgICAgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAndy0yNCBoLTI0IGJnLXdoaXRlIHNoYWRvdy14bCB0ZXh0LWJsdWUtNjAwJyA6ICd3LTE2IGgtMTYgYmctYmx1ZS01MCB0ZXh0LWJsdWUtNjAwJ30KICAgICAgICAgICAgYCwgY2hpbGRyZW46IF9qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogYCR7c3RhdGUucm9vbXMubGVuZ3RoID09PSAwID8gJ3ctMTAgaC0xMCcgOiAndy04IGgtOCd9YCB9KSB9KSwgX2pzeCgiaDIiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTIgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAndGV4dC0zeGwnIDogJ3RleHQteGwnfWAsIGNoaWxkcmVuOiBzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAnU3RhcnQgSW5zcGVjdGlvbicgOiAnQWRkIE5ldyBBcmVhJyB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgbWItOCB0ZXh0LWxnIiwgY2hpbGRyZW46IHN0YXRlLnJvb21zLmxlbmd0aCA9PT0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgQ2FwdHVyZSBvciB1cGxvYWQgcGhvdG9zIHRvIGJlZ2luIHlvdXIgJHtzdGF0ZS5zY29wZS5sZW5ndGggPiAxID8gJ0NvbWJpbmVkJyA6IFNDT1BFX0NPTkZJR1tzdGF0ZS5zY29wZVswXSB8fCAnT0hTJ10ubGFiZWx9IGF1ZGl0LmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogYFVwbG9hZCBwaG90b3Mgb3IgY2FwdHVyZSBpbWFnZXMgb2YgdGhlIG5ldyBhcmVhLmAgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC1jb2wgc206ZmxleC1yb3cgZ2FwLTQganVzdGlmeS1jZW50ZXIiLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IGNhbWVyYUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtOCBweS0zIHJvdW5kZWQteGwgZm9udC1ib2xkIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIFRha2UgUGhvdG8iXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gZmlsZUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImJnLXdoaXRlIHRleHQtYmx1ZS03MDAgYm9yZGVyIGJvcmRlci1ibHVlLTIwMCBweC04IHB5LTMgcm91bmRlZC14bCBmb250LWJvbGQgaG92ZXI6YmctYmx1ZS01MCB0cmFuc2l0aW9uLWNvbG9ycyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeChVcGxvYWQsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgVXBsb2FkIEdhbGxlcnkiXSB9KV0gfSldIH0pIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogImZpbGUiLCByZWY6IGZpbGVJbnB1dFJlZiwgY2xhc3NOYW1lOiAiaGlkZGVuIiwgYWNjZXB0OiAiaW1hZ2UvKiIsIG11bHRpcGxlOiB0cnVlLCBvbkNoYW5nZTogaGFuZGxlSW1hZ2VTZWxlY3QgfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAiZmlsZSIsIHJlZjogY2FtZXJhSW5wdXRSZWYsIGNsYXNzTmFtZTogImhpZGRlbiIsIGFjY2VwdDogImltYWdlLyoiLCBjYXB0dXJlOiAiZW52aXJvbm1lbnQiLCBvbkNoYW5nZTogaGFuZGxlSW1hZ2VTZWxlY3QgfSldIH0pXSB9KSk7Cn0KY29uc3Qgcm9vdCA9IGNyZWF0ZVJvb3QoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKSk7CnJvb3QucmVuZGVyKF9qc3goQ29tcGxpYW5jZUluc3BlY3RvckFwcCwge30pKTsK","@":"data:application/javascript;base64,aW1wb3J0IHsganN4IGFzIF9qc3gsIGpzeHMgYXMgX2pzeHMgfSBmcm9tICJyZWFjdC9qc3gtcnVudGltZSI7CmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB7IGNyZWF0ZVJvb3QgfSBmcm9tICdyZWFjdC1kb20vY2xpZW50JzsKaW1wb3J0IHsgQ2FtZXJhLCBVcGxvYWQsIENoZXZyb25MZWZ0LCBDaGVja0NpcmNsZSwgQWxlcnRUcmlhbmdsZSwgRmlsZVRleHQsIFByaW50ZXIsIFNoaWVsZCwgRmxhbWUsIExlYWYsIFV0ZW5zaWxzLCBYLCBMb2FkZXIyLCBNYXAgYXMgTWFwSWNvbiwgQ2hlY2tTcXVhcmUsIEJ1aWxkaW5nLCBMYXllcnMsIE1hcFBpbiwgVXNlciwgQnJpZWZjYXNlLCBDaGVjaywgR2xvYmUsIFNwYXJrbGVzLCBBcnJvd1JpZ2h0LCBHYXZlbCwgQ2xvY2ssIFBsYXksIExvY2ssIFNob3BwaW5nQmFnLCBHcmlwVmVydGljYWwsIEltYWdlSWNvbiwgUmVmcmVzaEN3LCBBbGVydENpcmNsZSwgQ2xpcGJvYXJkQ2hlY2ssIExheW91dERhc2hib2FyZCwgVGh1bWJzVXAsIFRodW1ic0Rvd24sIEFjdGl2aXR5LCBTY3JvbGxUZXh0LCBIaXN0b3J5IH0gZnJvbSAnbHVjaWRlLXJlYWN0JzsKaW1wb3J0IHsgR29vZ2xlR2VuQUksIFR5cGUgfSBmcm9tICJAZ29vZ2xlL2dlbmFpIjsKLy8gLS0tIEFJIFNldHVwIC0tLQpjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5BSSh7IGFwaUtleTogcHJvY2Vzcy5lbnYuQVBJX0tFWSB9KTsKY29uc3QgU0NPUEVfQ09ORklHID0gewogICAgT0hTOiB7CiAgICAgICAgbGFiZWw6ICdPY2N1cGF0aW9uYWwgSGVhbHRoICYgU2FmZXR5JywKICAgICAgICBpY29uOiBTaGllbGQsCiAgICAgICAgY29sb3I6ICdiZy1ibHVlLTYwMCcsCiAgICAgICAgZm9jdXM6ICdzbGlwL3RyaXAgaGF6YXJkcywgd29ya2luZyBhdCBoZWlnaHRzLCBlbGVjdHJpY2FsIHNhZmV0eSwgbWFjaGluZSBndWFyZGluZywgUFBFIGNvbXBsaWFuY2UsIGFuZCBjbGVhciBmbG9vciBtYXJraW5ncyAoZ3JlZW4gc2FmZSB3YWxrd2F5cywgeWVsbG93L2JsYWNrIHplYnJhIGNyb3NzaW5ncyBhcm91bmQgbWFjaGluZXMpLicsCiAgICAgICAgc3RhbmRhcmRzOiAnSVNPIDQ1MDAxOjIwMTggKE9IJlMgTWFuYWdlbWVudCksIE9TSEEgMTkxMCAoR2VuZXJhbCBJbmR1c3RyeSksIExvY2FsIEZhY3RvcmllcyBBY3RzIChMYXRlc3QgQW1lbmRtZW50cyksIEFOU0kvQVNTUCBaMTAuMCcsCiAgICAgICAgZG9jdW1lbnRzOiAnSGF6YXJkIElkZW50aWZpY2F0aW9uICYgUmlzayBBc3Nlc3NtZW50IChISVJBKSwgUFBFIElzc3VhbmNlIFJlZ2lzdGVyLCBNYWNoaW5lcnkgSW5zcGVjdGlvbiBDaGVja2xpc3RzLCBMb2Nrb3V0L1RhZ291dCAoTE9UTykgTG9ncywgU2FmZXR5IFRyYWluaW5nIEF0dGVuZGFuY2UgUmVjb3JkcycsCiAgICAgICAgaGV4OiAnIzI1NjNlYicKICAgIH0sCiAgICBGaXJlOiB7CiAgICAgICAgbGFiZWw6ICdGaXJlIFNhZmV0eScsCiAgICAgICAgaWNvbjogRmxhbWUsCiAgICAgICAgY29sb3I6ICdiZy1yZWQtNjAwJywKICAgICAgICBmb2N1czogJ2Jsb2NrZWQgZXhpdHMsIGV4dGluZ3Vpc2hlciBhY2Nlc3NpYmlsaXR5LCBzaWduYWdlLCBmbGFtbWFibGUgc3RvcmFnZSwgYW5kIHNwcmlua2xlciBvYnN0cnVjdGlvbi4nLAogICAgICAgIHN0YW5kYXJkczogJ05GUEEgMTAxIChMaWZlIFNhZmV0eSBDb2RlKSwgTkZQQSAxMCAoUG9ydGFibGUgRXh0aW5ndWlzaGVycyksIE5GUEEgNzIgKEZpcmUgQWxhcm0gQ29kZSksIElTTyA3MDEwIChTYWZldHkgU2lnbnMpLCBMb2NhbCBGaXJlIENvZGVzJywKICAgICAgICBkb2N1bWVudHM6ICdGaXJlIEV4dGluZ3Vpc2hlciBJbnNwZWN0aW9uIFRhZ3MsIEZpcmUgQWxhcm0gU3lzdGVtIFRlc3QgUmVwb3J0cywgRW1lcmdlbmN5IEV2YWN1YXRpb24gRHJpbGwgTG9ncywgRmlyZSBTYWZldHkgUGxhbiwgSG90IFdvcmsgUGVybWl0cycsCiAgICAgICAgaGV4OiAnI2RjMjYyNicKICAgIH0sCiAgICBFbnZpcm9ubWVudGFsOiB7CiAgICAgICAgbGFiZWw6ICdFbnZpcm9ubWVudGFsJywKICAgICAgICBpY29uOiBMZWFmLAogICAgICAgIGNvbG9yOiAnYmctZ3JlZW4tNjAwJywKICAgICAgICBmb2N1czogJ2NoZW1pY2FsIHNwaWxscywgd2FzdGUgc2VncmVnYXRpb24sIHNlY29uZGFyeSBjb250YWlubWVudCwgYW5kIGVtaXNzaW9uIGNvbnRyb2wuJywKICAgICAgICBzdGFuZGFyZHM6ICdJU08gMTQwMDE6MjAxNSAoRW52aXJvbm1lbnRhbCBNYW5hZ2VtZW50KSwgRVBBIDQwIENGUiAoSGF6YXJkb3VzIFdhc3RlKSwgTG9jYWwgRW52aXJvbm1lbnRhbCBQcm90ZWN0aW9uIEFjdHMnLAogICAgICAgIGRvY3VtZW50czogJ1dhc3RlIERpc3Bvc2FsIE1hbmlmZXN0cywgU3BpbGwgUHJldmVudGlvbiBDb250cm9sICYgQ291bnRlcm1lYXN1cmUgKFNQQ0MpIFBsYW4sIFNhZmV0eSBEYXRhIFNoZWV0cyAoU0RTKSwgQWlyIEVtaXNzaW9ucyBNb25pdG9yaW5nIExvZ3MnLAogICAgICAgIGhleDogJyMxNmEzNGEnCiAgICB9LAogICAgR01QOiB7CiAgICAgICAgbGFiZWw6ICdGb29kIFNhZmV0eSAoR01QL0hBQ0NQKScsCiAgICAgICAgaWNvbjogVXRlbnNpbHMsCiAgICAgICAgY29sb3I6ICdiZy10ZWFsLTYwMCcsCiAgICAgICAgZm9jdXM6ICdoeWdpZW5lLCBjcm9zcy1jb250YW1pbmF0aW9uLCBwZXN0IGNvbnRyb2wsIGhhaXJuZXRzL2JlYXJkIG5ldHMsIGpld2VscnksIHBlcnNvbmFsIGl0ZW1zIG9uIHByZXAgc3VyZmFjZXMsIHNhbml0YXRpb24sIGFuZCBmb3JlaWduIG1hdGVyaWFsIGNvbnRyb2wuJywKICAgICAgICBzdGFuZGFyZHM6ICdGU1NDIDIyMDAwIHY2LCBJU08gMjIwMDA6MjAxOCwgQ09ERVggQWxpbWVudGFyaXVzIEdlbmVyYWwgUHJpbmNpcGxlcyBvZiBGb29kIEh5Z2llbmUsIEZEQSAyMSBDRlIgUGFydCAxMTAnLAogICAgICAgIGRvY3VtZW50czogJ01hc3RlciBDbGVhbmluZyBTY2hlZHVsZSwgUGVzdCBDb250cm9sIFNlcnZpY2UgUmVwb3J0cywgU3RhZmYgSGVhbHRoICYgSHlnaWVuZSBSZWNvcmRzLCBUZW1wZXJhdHVyZSBDb250cm9sIExvZ3MsIEFsbGVyZ2VuIE1hbmFnZW1lbnQgUGxhbicsCiAgICAgICAgaGV4OiAnIzBkOTQ4OCcKICAgIH0sCiAgICBTZWN1cml0eTogewogICAgICAgIGxhYmVsOiAnU2VjdXJpdHkgJiBTdXJ2ZWlsbGFuY2UnLAogICAgICAgIGljb246IExvY2ssCiAgICAgICAgY29sb3I6ICdiZy1wdXJwbGUtNjAwJywKICAgICAgICBmb2N1czogJ2JsaW5kIHNwb3RzLCBwb29yIGxpZ2h0aW5nLCB3ZWFrIGVudHJ5IHBvaW50cywgbWlzc2luZyBjYW1lcmEgY292ZXJhZ2UsIGludHJ1c2lvbiByaXNrcywgcGVyaW1ldGVyIGludGVncml0eSwgYW5kIGFjY2VzcyBjb250cm9sIGdhcHMuJywKICAgICAgICBzdGFuZGFyZHM6ICdJU08gMjcwMDE6MjAxMyBBbm5leCBBLjExIChQaHlzaWNhbCBTZWN1cml0eSksIEFOU0kvQVNJUyBQQVAuMS0yMDEyIChQaHlzaWNhbCBBc3NldCBQcm90ZWN0aW9uKSwgQ1BURUQgUHJpbmNpcGxlcycsCiAgICAgICAgZG9jdW1lbnRzOiAnQ0NUViBTeXN0ZW0gTWFpbnRlbmFuY2UgTG9ncywgVmlzaXRvciBBY2Nlc3MgQ29udHJvbCBSZWdpc3RlciwgU2VjdXJpdHkgSW5jaWRlbnQgUmVwb3J0cywgS2V5ICYgQWNjZXNzIENhcmQgQ29udHJvbCBQb2xpY3ksIFBlcmltZXRlciBTZWN1cml0eSBQYXRyb2wgTG9ncycsCiAgICAgICAgaGV4OiAnIzkzMzNlYScKICAgIH0sCiAgICBGYWNpbGl0eTogewogICAgICAgIGxhYmVsOiAnRmFjaWxpdHkgTWFuYWdlbWVudCAoSVNPIDQxMDAxKScsCiAgICAgICAgaWNvbjogQ2xpcGJvYXJkQ2hlY2ssCiAgICAgICAgY29sb3I6ICdiZy1pbmRpZ28tNjAwJywKICAgICAgICBmb2N1czogJ2V4dGVyaW9yL2ludGVyaW9yIGNvbmRpdGlvbnMsIE1FUCB2aXN1YWxzLCBmaXJlIHNhZmV0eSwgc2VjdXJpdHksIGFzc2V0cywgY2xlYW5saW5lc3MsIGNvbnRyYWN0b3IgY29tcGxpYW5jZS4nLAogICAgICAgIHN0YW5kYXJkczogJ0lTTyA0MTAwMToyMDE4IChGYWNpbGl0eSBNYW5hZ2VtZW50KSwgQVNUTSBFMjAxOC0xNSAoUHJvcGVydHkgQ29uZGl0aW9uIEFzc2Vzc21lbnRzKSwgSW50ZXJuYXRpb25hbCBCdWlsZGluZyBDb2RlIChJQkMpIENoYXB0ZXIgMTAnLAogICAgICAgIGRvY3VtZW50czogJ1ByZXZlbnRpdmUgTWFpbnRlbmFuY2UgKFBNKSBTY2hlZHVsZSwgQXNzZXQgUmVnaXN0ZXIgJiBDb25kaXRpb24gQXNzZXNzbWVudCwgQ29udHJhY3RvciBXb3JrIFBlcm1pdHMsIENsZWFuaW5nIFNlcnZpY2UgTGV2ZWwgQWdyZWVtZW50cyAoU0xBKSwgQnVpbGRpbmcgSW5zcGVjdGlvbiBSZXBvcnRzJywKICAgICAgICBoZXg6ICcjNGY0NmU1JwogICAgfQp9OwovLyAtLS0gR2xvYmFsIFN0eWxlcyAoUHJpbnQgT3B0aW1pemF0aW9uKSAtLS0KY29uc3QgR2xvYmFsUHJpbnRTdHlsZXMgPSBgCiAgQG1lZGlhIHByaW50IHsKICAgIEBwYWdlIHsKICAgICAgc2l6ZTogQTQ7CiAgICAgIG1hcmdpbjogMTJtbSAxNW1tOyAvKiBTbGlnaHRseSB0aWdodGVyIG1hcmdpbnMgZm9yIGJldHRlciBmaXQgKi8KICAgIH0KICAgIGh0bWwsIGJvZHkgewogICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIGJhY2tncm91bmQ6IHdoaXRlOwogICAgICBmb250LWZhbWlseTogJ0hlbHZldGljYSBOZXVlJywgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsKICAgICAgZm9udC1zaXplOiAxMHB0OwogICAgICBsaW5lLWhlaWdodDogMS40OwogICAgICBjb2xvcjogIzBmMTcyYTsKICAgICAgLXdlYmtpdC1wcmludC1jb2xvci1hZGp1c3Q6IGV4YWN0ICFpbXBvcnRhbnQ7CiAgICAgIHByaW50LWNvbG9yLWFkanVzdDogZXhhY3QgIWltcG9ydGFudDsKICAgIH0KICAgIAogICAgLyogTGF5b3V0IEhlbHBlcnMgKi8KICAgIC5wcmludC1icmVhay1iZWZvcmUgeyBwYWdlLWJyZWFrLWJlZm9yZTogYWx3YXlzICFpbXBvcnRhbnQ7IGJyZWFrLWJlZm9yZTogcGFnZSAhaW1wb3J0YW50OyB9CiAgICAucHJpbnQtYnJlYWstYWZ0ZXIgeyBwYWdlLWJyZWFrLWFmdGVyOiBhbHdheXMgIWltcG9ydGFudDsgYnJlYWstYWZ0ZXI6IHBhZ2UgIWltcG9ydGFudDsgfQogICAgLnByaW50LW5vLWJyZWFrIHsgcGFnZS1icmVhay1pbnNpZGU6IGF2b2lkICFpbXBvcnRhbnQ7IGJyZWFrLWluc2lkZTogYXZvaWQgIWltcG9ydGFudDsgfQogICAgCiAgICAvKiBDb3ZlciBQYWdlICovCiAgICAucHJpbnQtY292ZXItcGFnZSB7CiAgICAgIG1pbi1oZWlnaHQ6IDk4dmg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgcGFnZS1icmVhay1hZnRlcjogYWx3YXlzOwogICAgfQogICAgCiAgICAvKiBUeXBvZ3JhcGh5IE92ZXJyaWRlcyBmb3IgUHJpbnQgKi8KICAgIGgxIHsgZm9udC1zaXplOiAyMnB0ICFpbXBvcnRhbnQ7IGxpbmUtaGVpZ2h0OiAxLjIgIWltcG9ydGFudDsgY29sb3I6ICMwZjE3MmEgIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMC41Y20gIWltcG9ydGFudDsgfQogICAgaDIgeyBmb250LXNpemU6IDE2cHQgIWltcG9ydGFudDsgbWFyZ2luLWJvdHRvbTogMC4zY20gIWltcG9ydGFudDsgY29sb3I6ICMxZTI5M2IgIWltcG9ydGFudDsgYnJlYWstYWZ0ZXI6IGF2b2lkOyB9CiAgICBoMyB7IGZvbnQtc2l6ZTogMTJwdCAhaW1wb3J0YW50OyBtYXJnaW4tYm90dG9tOiAwLjJjbSAhaW1wb3J0YW50OyBjb2xvcjogIzMzNDE1NSAhaW1wb3J0YW50OyBicmVhay1hZnRlcjogYXZvaWQ7IH0KICAgIHAsIGxpLCB0ZCB7IGZvbnQtc2l6ZTogOXB0ICFpbXBvcnRhbnQ7IH0KICAgIAogICAgLyogUmVtb3ZlIFdlYiBVSSBjbHV0dGVyICovCiAgICAubm8tcHJpbnQsIGJ1dHRvbiwgbmF2LCBpbnB1dFt0eXBlPSJ0ZXh0Il0sIGlucHV0W3R5cGU9ImZpbGUiXSwgLm92ZXJsYXktc2xpZGVyLWhhbmRsZSwgLnByaW50LWhpZGRlbiB7CiAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBDbGVhbiBDYXJkIFN0eWxlIGZvciBQcmludCAqLwogICAgLnByaW50LWNhcmQtY2xlYW4gewogICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50OwogICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsKICAgICAgYm94LXNoYWRvdzogbm9uZSAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgICAgIG1hcmdpbi1ib3R0b206IDAuM2NtICFpbXBvcnRhbnQ7CiAgICB9CiAgICAKICAgIC8qIEJvcmRlcnMgZm9yIFNlY3Rpb25zICovCiAgICAucHJpbnQtc2VjdGlvbi1ib3JkZXIgewogICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2UyZThmMCAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgICAgbWFyZ2luLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgIH0KCiAgICAvKiBPcHRpbWl6ZWQgR3JpZCBmb3IgSW1hZ2VzICovCiAgICAucHJpbnQtZ3JpZC0yIHsKICAgICAgZGlzcGxheTogZ3JpZCAhaW1wb3J0YW50OwogICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnIgIWltcG9ydGFudDsKICAgICAgZ2FwOiA1bW0gIWltcG9ydGFudDsKICAgICAgbWFyZ2luLWJvdHRvbTogMC40Y20gIWltcG9ydGFudDsKICAgIH0KICAgIAogICAgLnByaW50LWltYWdlLWNvbXBhY3QgewogICAgICAgIGhlaWdodDogMTYwcHggIWltcG9ydGFudDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmYWZjOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjYmQ1ZTE7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgfQogICAgCiAgICAvKiBQcm9mZXNzaW9uYWwgVGFibGUgU3R5bGluZyAqLwogICAgdGFibGUucHJpbnQtdGFibGUgeyAKICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsgCiAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7IAogICAgICBtYXJnaW4tYm90dG9tOiAwLjVjbSAhaW1wb3J0YW50OyAKICAgICAgZm9udC1zaXplOiA5cHQgIWltcG9ydGFudDsKICAgIH0KICAgIHRhYmxlLnByaW50LXRhYmxlIHRoIHsgCiAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjMzM0MTU1ICFpbXBvcnRhbnQ7IAogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmNWY5ICFpbXBvcnRhbnQ7CiAgICAgIHRleHQtYWxpZ246IGxlZnQ7IAogICAgICBwYWRkaW5nOiA2cHggOHB4ICFpbXBvcnRhbnQ7IAogICAgICBmb250LXdlaWdodDogNzAwICFpbXBvcnRhbnQ7IAogICAgICBjb2xvcjogIzBmMTcyYSAhaW1wb3J0YW50OyAKICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICAgIH0KICAgIHRhYmxlLnByaW50LXRhYmxlIHRkIHsgCiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZTJlOGYwICFpbXBvcnRhbnQ7IAogICAgICBwYWRkaW5nOiA2cHggOHB4ICFpbXBvcnRhbnQ7IAogICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOwogICAgfQogICAgdGFibGUucHJpbnQtdGFibGUgdHI6bnRoLWNoaWxkKGV2ZW4pIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZmFmYyAhaW1wb3J0YW50OwogICAgfQogICAgCiAgICAvKiBTcGVjaWZpYyBNYW5pZmVzdCBTdHlsaW5nICovCiAgICAucmVtZWRpYXRpb24tbWFuaWZlc3QgewogICAgICBtYXJnaW4tdG9wOiAxY207CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjYmQ1ZTE7CiAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgcGFkZGluZzogMDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgcGFnZS1icmVhay1pbnNpZGU6IGF2b2lkOwogICAgfQogICAgLnJlbWVkaWF0aW9uLWhlYWRlciB7CiAgICAgIGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiA4cHggMTJweDsKICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7CiAgICAgIGZvbnQtc2l6ZTogMTBwdDsKICAgICAgLXdlYmtpdC1wcmludC1jb2xvci1hZGp1c3Q6IGV4YWN0ICFpbXBvcnRhbnQ7CiAgICAgIHByaW50LWNvbG9yLWFkanVzdDogZXhhY3QgIWltcG9ydGFudDsKICAgIH0KICB9CmA7Ci8vIC0tLSBDb21wb25lbnRzIC0tLQpjb25zdCBBY3Rpdml0eUxvZ01vZGFsID0gKHsgbG9ncywgaXNPcGVuLCBvbkNsb3NlIH0pID0+IHsKICAgIGlmICghaXNPcGVuKQogICAgICAgIHJldHVybiBudWxsOwogICAgcmV0dXJuIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImZpeGVkIGluc2V0LTAgYmctc2xhdGUtOTAwLzUwIGJhY2tkcm9wLWJsdXItc20gei1bMTAwXSBmbGV4IGp1c3RpZnktZW5kIiwgY2hpbGRyZW46IF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInctZnVsbCBtYXgtdy1tZCBiZy13aGl0ZSBoLWZ1bGwgc2hhZG93LTJ4bCBmbGV4IGZsZXgtY29sIGFuaW1hdGUtZmFkZS1pbiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC00IGJvcmRlci1iIGJvcmRlci1zbGF0ZS0yMDAgZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIGJnLXNsYXRlLTUwIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiB0ZXh0LXNsYXRlLTgwMCBmb250LWJvbGQiLCBjaGlsZHJlbjogW19qc3goSGlzdG9yeSwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBJbnNwZWN0aW9uIEFjdGl2aXR5IExvZyJdIH0pLCBfanN4KCJidXR0b24iLCB7IG9uQ2xpY2s6IG9uQ2xvc2UsIGNsYXNzTmFtZTogInAtMiBob3ZlcjpiZy1zbGF0ZS0yMDAgcm91bmRlZC1mdWxsIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IF9qc3goWCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleC0xIG92ZXJmbG93LXktYXV0byBwLTQgc3BhY2UteS00IiwgY2hpbGRyZW46IGxvZ3MubGVuZ3RoID09PSAwID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgcHktMTAiLCBjaGlsZHJlbjogIk5vIGFjdGl2aXR5IHJlY29yZGVkIHlldC4iIH0pKSA6IChsb2dzLm1hcCgobG9nKSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMyIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibXQtMSIsIGNoaWxkcmVuOiBbbG9nLnR5cGUgPT09ICdhaScgJiYgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ3LTYgaC02IHJvdW5kZWQtZnVsbCBiZy1pbmRpZ28tMTAwIHRleHQtaW5kaWdvLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciIsIGNoaWxkcmVuOiBfanN4KFNwYXJrbGVzLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pIH0pLCBsb2cudHlwZSA9PT0gJ2luZm8nICYmIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy02IGgtNiByb3VuZGVkLWZ1bGwgYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIiwgY2hpbGRyZW46IF9qc3goU2Nyb2xsVGV4dCwgeyBjbGFzc05hbWU6ICJ3LTMgaC0zIiB9KSB9KSwgbG9nLnR5cGUgPT09ICdzdWNjZXNzJyAmJiBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInctNiBoLTYgcm91bmRlZC1mdWxsIGJnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciIsIGNoaWxkcmVuOiBfanN4KENoZWNrLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pIH0pLCBsb2cudHlwZSA9PT0gJ2Vycm9yJyAmJiBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInctNiBoLTYgcm91bmRlZC1mdWxsIGJnLXJlZC0xMDAgdGV4dC1yZWQtNjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIiwgY2hpbGRyZW46IF9qc3goQWxlcnRDaXJjbGUsIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSkgfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4LTEiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLXN0YXJ0IiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTgwMCIsIGNoaWxkcmVuOiBsb2cuYWN0aW9uIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBmb250LW1vbm8iLCBjaGlsZHJlbjogbmV3IERhdGUobG9nLnRpbWVzdGFtcCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkgfSldIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNjAwIG10LTAuNSIsIGNoaWxkcmVuOiBsb2cuZGV0YWlscyB9KV0gfSldIH0sIGxvZy5pZCkpKSkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCBib3JkZXItdCBib3JkZXItc2xhdGUtMjAwIHRleHQtY2VudGVyIHRleHQteHMgdGV4dC1zbGF0ZS00MDAiLCBjaGlsZHJlbjogW2xvZ3MubGVuZ3RoLCAiIFRvdGFsIEV2ZW50cyBSZWNvcmRlZCJdIH0pXSB9KSB9KSk7Cn07CmNvbnN0IEltYWdlQ29tcGFyZVNsaWRlciA9ICh7IG9yaWdpbmFsLCBvdmVybGF5LCBsYWJlbE9yaWdpbmFsID0gIk9yaWdpbmFsIiwgbGFiZWxPdmVybGF5ID0gIkFuYWx5c2lzIiB9KSA9PiB7CiAgICBjb25zdCBbc2xpZGVyUG9zaXRpb24sIHNldFNsaWRlclBvc2l0aW9uXSA9IHVzZVN0YXRlKDUwKTsKICAgIGNvbnN0IFtpc0RyYWdnaW5nLCBzZXRJc0RyYWdnaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTsKICAgIGNvbnN0IGNvbnRhaW5lclJlZiA9IHVzZVJlZihudWxsKTsKICAgIGNvbnN0IGhhbmRsZU1vdmUgPSAoY2xpZW50WCkgPT4gewogICAgICAgIGlmICghY29udGFpbmVyUmVmLmN1cnJlbnQpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCByZWN0ID0gY29udGFpbmVyUmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgY29uc3QgeCA9IE1hdGgubWF4KDAsIE1hdGgubWluKGNsaWVudFggLSByZWN0LmxlZnQsIHJlY3Qud2lkdGgpKTsKICAgICAgICBjb25zdCBwZXJjZW50ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCAoeCAvIHJlY3Qud2lkdGgpICogMTAwKSk7CiAgICAgICAgc2V0U2xpZGVyUG9zaXRpb24ocGVyY2VudCk7CiAgICB9OwogICAgY29uc3Qgb25Nb3VzZURvd24gPSAoZSkgPT4gewogICAgICAgIHNldElzRHJhZ2dpbmcodHJ1ZSk7CiAgICAgICAgaGFuZGxlTW92ZShlLmNsaWVudFgpOwogICAgfTsKICAgIGNvbnN0IG9uVG91Y2hTdGFydCA9IChlKSA9PiB7CiAgICAgICAgc2V0SXNEcmFnZ2luZyh0cnVlKTsKICAgICAgICBoYW5kbGVNb3ZlKGUudG91Y2hlc1swXS5jbGllbnRYKTsKICAgIH07CiAgICB1c2VFZmZlY3QoKCkgPT4gewogICAgICAgIGNvbnN0IGhhbmRsZVdpbmRvd01vdmUgPSAoZSkgPT4gewogICAgICAgICAgICBpZiAoaXNEcmFnZ2luZykKICAgICAgICAgICAgICAgIGhhbmRsZU1vdmUoZS5jbGllbnRYKTsKICAgICAgICB9OwogICAgICAgIGNvbnN0IGhhbmRsZVdpbmRvd1VwID0gKCkgPT4gc2V0SXNEcmFnZ2luZyhmYWxzZSk7CiAgICAgICAgY29uc3QgaGFuZGxlVG91Y2hNb3ZlID0gKGUpID0+IHsKICAgICAgICAgICAgaWYgKGlzRHJhZ2dpbmcpCiAgICAgICAgICAgICAgICBoYW5kbGVNb3ZlKGUudG91Y2hlc1swXS5jbGllbnRYKTsKICAgICAgICB9OwogICAgICAgIGlmIChpc0RyYWdnaW5nKSB7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVXaW5kb3dNb3ZlKTsKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVUb3VjaE1vdmUpOwogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBoYW5kbGVXaW5kb3dNb3ZlKTsKICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBoYW5kbGVUb3VjaE1vdmUpOwogICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBoYW5kbGVXaW5kb3dVcCk7CiAgICAgICAgfTsKICAgIH0sIFtpc0RyYWdnaW5nXSk7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IHJlZjogY29udGFpbmVyUmVmLCBjbGFzc05hbWU6ICJyZWxhdGl2ZSB3LWZ1bGwgaC05NiByb3VuZGVkLXhsIG92ZXJmbG93LWhpZGRlbiBjdXJzb3ItY29sLXJlc2l6ZSBzZWxlY3Qtbm9uZSBzaGFkb3ctc20gYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgZ3JvdXAgdG91Y2gtbm9uZSBwcmludDpoaWRkZW4iLCBvbk1vdXNlRG93bjogb25Nb3VzZURvd24sIG9uVG91Y2hTdGFydDogb25Ub3VjaFN0YXJ0LCBjaGlsZHJlbjogW19qc3goImltZyIsIHsgc3JjOiBvdmVybGF5LCBjbGFzc05hbWU6ICJhYnNvbHV0ZSBpbnNldC0wIHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIiwgYWx0OiAiQW5hbHlzaXMiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC00IHJpZ2h0LTQgYmctYmx1ZS05MDAvODAgdGV4dC13aGl0ZSB0ZXh0LXhzIGZvbnQtYm9sZCBweC0yIHB5LTEgcm91bmRlZCBiYWNrZHJvcC1ibHVyLXNtIHBvaW50ZXItZXZlbnRzLW5vbmUgei0xMCIsIGNoaWxkcmVuOiBsYWJlbE92ZXJsYXkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGluc2V0LTAgdy1mdWxsIGgtZnVsbCBvdmVyZmxvdy1oaWRkZW4iLCBzdHlsZTogeyBjbGlwUGF0aDogYGluc2V0KDAgJHsxMDAgLSBzbGlkZXJQb3NpdGlvbn0lIDAgMClgIH0sIGNoaWxkcmVuOiBbX2pzeCgiaW1nIiwgeyBzcmM6IG9yaWdpbmFsLCBjbGFzc05hbWU6ICJhYnNvbHV0ZSBpbnNldC0wIHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIiwgYWx0OiAiT3JpZ2luYWwiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC00IGxlZnQtNCBiZy1zbGF0ZS05MDAvODAgdGV4dC13aGl0ZSB0ZXh0LXhzIGZvbnQtYm9sZCBweC0yIHB5LTEgcm91bmRlZCBiYWNrZHJvcC1ibHVyLXNtIHBvaW50ZXItZXZlbnRzLW5vbmUiLCBjaGlsZHJlbjogbGFiZWxPcmlnaW5hbCB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTAgYm90dG9tLTAgdy0wLjUgYmctd2hpdGUgY3Vyc29yLWNvbC1yZXNpemUgei0yMCBvdmVybGF5LXNsaWRlci1oYW5kbGUiLCBzdHlsZTogeyBsZWZ0OiBgJHtzbGlkZXJQb3NpdGlvbn0lYCB9LCBjaGlsZHJlbjogX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMS8yIGxlZnQtMS8yIC10cmFuc2xhdGUteC0xLzIgLXRyYW5zbGF0ZS15LTEvMiB3LTggaC04IGJnLXdoaXRlIHJvdW5kZWQtZnVsbCBzaGFkb3ctbGcgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1ibHVlLTYwMCBib3JkZXIgYm9yZGVyLXNsYXRlLTEwMCIsIGNoaWxkcmVuOiBfanN4KEdyaXBWZXJ0aWNhbCwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSBib3R0b20tNCBsZWZ0LTEvMiAtdHJhbnNsYXRlLXgtMS8yIGJnLWJsYWNrLzQwIHRleHQtd2hpdGUgdGV4dC1bMTBweF0gZm9udC1ib2xkIHB4LTMgcHktMSByb3VuZGVkLWZ1bGwgYmFja2Ryb3AtYmx1ci1zbSBwb2ludGVyLWV2ZW50cy1ub25lIG9wYWNpdHktMCBncm91cC1ob3ZlcjpvcGFjaXR5LTEwMCB0cmFuc2l0aW9uLW9wYWNpdHkiLCBjaGlsZHJlbjogIkRyYWcgdG8gY29tcGFyZSIgfSldIH0pKTsKfTsKZnVuY3Rpb24gQW5hbHlzaXNEaXNwbGF5KHsgYW5hbHlzaXMsIGNvbXBhY3QgPSBmYWxzZSwgaGlkZUl0ZW1zID0gZmFsc2UgfSkgewogICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIEZhY2lsaXR5IEluc3BlY3Rpb24gcmVzdWx0IChoYXMgZGV0YWlsZWRGaW5kaW5ncykKICAgIGNvbnN0IGlzRmFjaWxpdHkgPSAhIWFuYWx5c2lzLmRldGFpbGVkRmluZGluZ3M7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHNwYWNlLXktNCBwcmludDpzcGFjZS15LTMgJHtjb21wYWN0ID8gJ3RleHQteHMnIDogJyd9YCwgY2hpbGRyZW46IFshY29tcGFjdCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIHAtNCBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQtc2VjdGlvbi1ib3JkZXIiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC00IiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6IGB0ZXh0LTN4bCBmb250LWJvbGQgJHtnZXRTY29yZUNvbG9yKGFuYWx5c2lzLnNjb3JlKX1gLCBjaGlsZHJlbjogW2FuYWx5c2lzLnNjb3JlLCAiLzEwMCJdIH0pLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiQ29tcGxpYW5jZSBTY29yZSIgfSksIGFuYWx5c2lzLmNhdGVnb3J5ICYmIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtaW5kaWdvLTYwMCBiZy1pbmRpZ28tNTAgcHgtMiBweS0wLjUgcm91bmRlZCBib3JkZXIgYm9yZGVyLWluZGlnby0xMDAgbXQtMSBpbmxpbmUtYmxvY2siLCBjaGlsZHJlbjogYW5hbHlzaXMuY2F0ZWdvcnkgfSkpXSB9KV0gfSksIGFuYWx5c2lzLnJpc2tMZXZlbCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgcHgtMyBweS0xIHJvdW5kZWQgdGV4dC14cyBmb250LWJvbGQgdXBwZXJjYXNlIGJvcmRlciAke2FuYWx5c2lzLnJpc2tMZXZlbCA9PT0gJ0hpZ2gnID8gJ2JnLXJlZC0xMDAgdGV4dC1yZWQtNzAwIGJvcmRlci1yZWQtMjAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmFseXNpcy5yaXNrTGV2ZWwgPT09ICdNZWRpdW0nID8gJ2JnLW9yYW5nZS0xMDAgdGV4dC1vcmFuZ2UtNzAwIGJvcmRlci1vcmFuZ2UtMjAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTcwMCBib3JkZXItZ3JlZW4tMjAwJ31gLCBjaGlsZHJlbjogW2FuYWx5c2lzLnJpc2tMZXZlbCwgIiBSaXNrIl0gfSkpXSB9KSksIGlzRmFjaWxpdHkgPyAoCiAgICAgICAgICAgIC8vIEZBQ0lMSVRZIE1PREU6IERldGFpbGVkIEZpbmRpbmdzIFRhYmxlCiAgICAgICAgICAgIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgb3ZlcmZsb3ctaGlkZGVuIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTUwIHAtMiBib3JkZXItYiBib3JkZXItc2xhdGUtMjAwIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB0ZXh0LXhzIHVwcGVyY2FzZSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LWJsYWNrIiwgY2hpbGRyZW46IFtfanN4KENsaXBib2FyZENoZWNrLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIEluc3BlY3Rpb24gRmluZGluZ3MiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJkaXZpZGUteSBkaXZpZGUtc2xhdGUtMTAwIiwgY2hpbGRyZW46IGFuYWx5c2lzLmRldGFpbGVkRmluZGluZ3M/Lm1hcCgoZmluZGluZywgaSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtMyB0ZXh0LXNtIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0xIiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6IGBmb250LWJvbGQgJHtmaW5kaW5nLnR5cGUgPT09ICdHb29kIGNvbmRpdGlvbicgPyAndGV4dC1ncmVlbi03MDAnIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZGluZy50eXBlID09PSAnU2FmZXR5IGhhemFyZCcgPyAndGV4dC1yZWQtNzAwJyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5kaW5nLnR5cGUgPT09ICdNYWpvciBkZWZlY3QnID8gJ3RleHQtcmVkLTYwMCcgOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmRpbmcudHlwZSA9PT0gJ01pbm9yIGlzc3VlJyA/ICd0ZXh0LW9yYW5nZS02MDAnIDogJ3RleHQtc2xhdGUtNzAwJ31gLCBjaGlsZHJlbjogZmluZGluZy50eXBlIH0pLCBmaW5kaW5nLnJpc2sgIT09ICdOb25lJyAmJiAoX2pzeHMoInNwYW4iLCB7IGNsYXNzTmFtZTogYHRleHQtWzEwcHhdIHVwcGVyY2FzZSBmb250LWJvbGQgcHgtMS41IHB5LTAuNSByb3VuZGVkICR7ZmluZGluZy5yaXNrID09PSAnSGlnaCcgPyAnYmctcmVkLTEwMCB0ZXh0LXJlZC04MDAnIDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZGluZy5yaXNrID09PSAnTWVkaXVtJyA/ICdiZy1vcmFuZ2UtMTAwIHRleHQtb3JhbmdlLTgwMCcgOiAnYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwJ31gLCBjaGlsZHJlbjogW2ZpbmRpbmcucmlzaywgIiBSaXNrIl0gfSkpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTgwMCBtYi0xIiwgY2hpbGRyZW46IGZpbmRpbmcuaXNzdWUgfSksIGZpbmRpbmcucmVjb21tZW5kYXRpb24gJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNTAwIHRleHQteHMgaXRhbGljIGJnLXNsYXRlLTUwIHAtMS41IHJvdW5kZWQgZmxleCBnYXAtMSIsIGNoaWxkcmVuOiBbX2pzeChBcnJvd1JpZ2h0LCB7IGNsYXNzTmFtZTogInctMyBoLTMgbXQtMC41IHNocmluay0wIiB9KSwgIiAiLCBmaW5kaW5nLnJlY29tbWVuZGF0aW9uXSB9KSldIH0sIGkpKSkgfSldIH0pKSA6ICgKICAgICAgICAgICAgLy8gU1RBTkRBUkQgTU9ERTogSGF6YXJkcyBMaXN0CiAgICAgICAgICAgIGFuYWx5c2lzLmhhemFyZHMubGVuZ3RoID4gMCAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgcC00IGJnLXJlZC01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItcmVkLTEwMCBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LXJlZC05MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiAke2NvbXBhY3QgPyAndGV4dC1zbScgOiAnJ30gcHJpbnQ6dGV4dC1zbGF0ZS04MDAgcHJpbnQ6dXBwZXJjYXNlIHByaW50OnRleHQteHNgLCBjaGlsZHJlbjogW19qc3goQWxlcnRUcmlhbmdsZSwgeyBjbGFzc05hbWU6IGNvbXBhY3QgPyAidy0zIGgtMyIgOiAidy00IGgtNCIgfSksICIgSWRlbnRpZmllZCBSaXNrcyJdIH0pLCBfanN4KCJ1bCIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xIHByaW50OnNwYWNlLXktMSIsIGNoaWxkcmVuOiBhbmFseXNpcy5oYXphcmRzLm1hcCgoaCwgaSkgPT4gKF9qc3hzKCJsaSIsIHsgY2xhc3NOYW1lOiBgdGV4dC1yZWQtODAwIGZsZXggaXRlbXMtc3RhcnQgZ2FwLTIgJHtjb21wYWN0ID8gJ3RleHQteHMnIDogJ3RleHQtc20nfSBwcmludDp0ZXh0LXNsYXRlLTcwMGAsIGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAibXQtMS41IHctMS41IGgtMS41IGJnLXJlZC00MDAgcm91bmRlZC1mdWxsIGZsZXgtc2hyaW5rLTAgcHJpbnQ6Ymctc2xhdGUtNDAwIiB9KSwgX2pzeCgic3BhbiIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9faHRtbDogaC5yZXBsYWNlKC9cKlwqKC4qPylcKlwqL2csICc8c3Ryb25nPiQxPC9zdHJvbmc+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KV0gfSwgaSkpKSB9KV0gfSkpKSwgIWlzRmFjaWxpdHkgJiYgYW5hbHlzaXMucmVjb21tZW5kZWRJdGVtcyAmJiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLmxlbmd0aCA+IDAgJiYgIWNvbXBhY3QgJiYgIWhpZGVJdGVtcyAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC00IGJnLWVtZXJhbGQtNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWVtZXJhbGQtMTAwIHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtZW1lcmFsZC05MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LXNsYXRlLTgwMCBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14cyIsIGNoaWxkcmVuOiBbX2pzeChTaG9wcGluZ0JhZywgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSwgIiBSZXF1aXJlZCBTYWZldHkgSXRlbXMiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIGdhcC0yIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciB0ZXh0LXNtIGJnLXdoaXRlIHAtMiByb3VuZGVkIGJvcmRlciBib3JkZXItZW1lcmFsZC0xMDAiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtZW1lcmFsZC04MDAiLCBjaGlsZHJlbjogaXRlbS5pdGVtIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIGJsb2NrIiwgY2hpbGRyZW46IGl0ZW0ucmVhc29uIH0pXSB9KSwgX2pzeHMoInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtMTAwIHRleHQtZW1lcmFsZC04MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCB3aGl0ZXNwYWNlLW5vd3JhcCIsIGNoaWxkcmVuOiBbIlF0eTogIiwgaXRlbS5xdWFudGl0eV0gfSldIH0sIGkpKSkgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiaGlkZGVuIHByaW50OmJsb2NrIiwgY2hpbGRyZW46IF9qc3hzKCJ0YWJsZSIsIHsgY2xhc3NOYW1lOiAicHJpbnQtdGFibGUiLCBjaGlsZHJlbjogW19qc3goInRoZWFkIiwgeyBjaGlsZHJlbjogX2pzeHMoInRyIiwgeyBjaGlsZHJlbjogW19qc3goInRoIiwgeyBjaGlsZHJlbjogIkl0ZW0gLyBFcXVpcG1lbnQiIH0pLCBfanN4KCJ0aCIsIHsgY2hpbGRyZW46ICJRdHkiIH0pLCBfanN4KCJ0aCIsIHsgY2hpbGRyZW46ICJSZWFzb24iIH0pXSB9KSB9KSwgX2pzeCgidGJvZHkiLCB7IGNoaWxkcmVuOiBhbmFseXNpcy5yZWNvbW1lbmRlZEl0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gKF9qc3hzKCJ0ciIsIHsgY2hpbGRyZW46IFtfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIiwgY2hpbGRyZW46IGl0ZW0uaXRlbSB9KSwgX2pzeCgidGQiLCB7IGNsYXNzTmFtZTogIndoaXRlc3BhY2Utbm93cmFwIiwgY2hpbGRyZW46IGl0ZW0ucXVhbnRpdHkgfSksIF9qc3goInRkIiwgeyBjbGFzc05hbWU6ICJpdGFsaWMgdGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogaXRlbS5yZWFzb24gfSldIH0sIGkpKSkgfSldIH0pIH0pXSB9KSksIGFuYWx5c2lzLnJlbGV2YW50U3RhbmRhcmRzICYmIGFuYWx5c2lzLnJlbGV2YW50U3RhbmRhcmRzLmxlbmd0aCA+IDAgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHAtNCBiZy1ibHVlLTUwIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ibHVlLTEwMCBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgJHtjb21wYWN0ID8gJ3RleHQtc20nIDogJyd9IHByaW50OnRleHQtc2xhdGUtODAwIHByaW50OnVwcGVyY2FzZSBwcmludDp0ZXh0LXhzYCwgY2hpbGRyZW46IFtfanN4KEdhdmVsLCB7IGNsYXNzTmFtZTogY29tcGFjdCA/ICJ3LTMgaC0zIiA6ICJ3LTQgaC00IiB9KSwgIiBBcHBsaWNhYmxlIExhdyAmIFN0YW5kYXJkcyJdIH0pLCBfanN4KCJ1bCIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0yIHByaW50OnNwYWNlLXktMSIsIGNoaWxkcmVuOiBhbmFseXNpcy5yZWxldmFudFN0YW5kYXJkcy5tYXAoKHMsIGkpID0+IChfanN4cygibGkiLCB7IGNsYXNzTmFtZTogInRleHQtc20gYmctd2hpdGUgcC0yIHJvdW5kZWQgYm9yZGVyIGJvcmRlci1ibHVlLTEwMCBzaGFkb3ctc20gZmxleCBmbGV4LWNvbCBnYXAtMSBwcmludDpib3JkZXItbm9uZSBwcmludDpzaGFkb3ctbm9uZSBwcmludDpiZy10cmFuc3BhcmVudCBwcmludDpwLTAgcHJpbnQ6bWItMSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtYmx1ZS04MDAgZm9udC1tb25vIHRleHQteHMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgcHJpbnQ6dGV4dC1zbGF0ZS04MDAgcHJpbnQ6dGV4dC1bOXB0XSIsIGNoaWxkcmVuOiBbcy5zdGFuZGFyZElkLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2xvY2FsJykgPyAoX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYmctaW5kaWdvLTEwMCB0ZXh0LWluZGlnby03MDAgcHgtMS41IHB5LTAuNSByb3VuZGVkLVszcHhdIHRleHQtWzEwcHhdIHVwcGVyY2FzZSB0cmFja2luZy13aWRlciBwcmludDpib3JkZXIgcHJpbnQ6Ym9yZGVyLXNsYXRlLTQwMCBwcmludDpiZy13aGl0ZSBwcmludDp0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiTG9jYWwgTGF3IiB9KSkgOiAoX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNjAwIHB4LTEuNSBweS0wLjUgcm91bmRlZC1bM3B4XSB0ZXh0LVsxMHB4XSB1cHBlcmNhc2UgdHJhY2tpbmctd2lkZXIgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS00MDAgcHJpbnQ6Ymctd2hpdGUgcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkludGwuIFN0ZCIgfSkpLCBzLnN0YW5kYXJkSWQucmVwbGFjZSgvXFsuKj9cXS9nLCAnJykudHJpbSgpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTcwMCBsZWFkaW5nLXNudWcgcHJpbnQ6cGwtMCIsIGNoaWxkcmVuOiBzLmRlc2NyaXB0aW9uIH0pXSB9LCBpKSkpIH0pXSB9KSksIGFuYWx5c2lzLm1pc3NpbmdEb2N1bWVudHMgJiYgYW5hbHlzaXMubWlzc2luZ0RvY3VtZW50cy5sZW5ndGggPiAwICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6IGBwLTQgYmctYW1iZXItNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWFtYmVyLTEwMCBwcmludC1jYXJkLWNsZWFuICR7Y29tcGFjdCA/ICdwLTInIDogJyd9YCwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWFtYmVyLTkwMCBtYi0yIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yICR7Y29tcGFjdCA/ICd0ZXh0LXNtJyA6ICcnfSBwcmludDp0ZXh0LXNsYXRlLTgwMCBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14c2AsIGNoaWxkcmVuOiBbX2pzeChGaWxlVGV4dCwgeyBjbGFzc05hbWU6IGNvbXBhY3QgPyAidy0zIGgtMyIgOiAidy00IGgtNCIgfSksICIgQXVkaXQgRG9jdW1lbnRhdGlvbiBHYXBzIl0gfSksIF9qc3goInVsIiwgeyBjbGFzc05hbWU6ICJsaXN0LWRpc2MgcGwtNSBzcGFjZS15LTEgcHJpbnQ6cGwtNCIsIGNoaWxkcmVuOiBhbmFseXNpcy5taXNzaW5nRG9jdW1lbnRzLm1hcCgoZG9jLCBpKSA9PiAoX2pzeCgibGkiLCB7IGNsYXNzTmFtZTogYHRleHQtYW1iZXItODAwICR7Y29tcGFjdCA/ICd0ZXh0LXhzJyA6ICd0ZXh0LXNtJ30gcHJpbnQ6dGV4dC1zbGF0ZS03MDBgLCBjaGlsZHJlbjogZG9jIH0sIGkpKSkgfSldIH0pKSwgIWNvbXBhY3QgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQtbm8tYnJlYWsiLCBjaGlsZHJlbjogW19qc3goImgzIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgbWItMSBwcmludDp1cHBlcmNhc2UgcHJpbnQ6dGV4dC14cyIsIGNoaWxkcmVuOiAiQXNzZXNzbWVudCBTdW1tYXJ5IiB9KSwgX2pzeHMoInAiLCB7IGNsYXNzTmFtZTogInRleHQtc20gdGV4dC1zbGF0ZS02MDAgaXRhbGljIiwgY2hpbGRyZW46IFsiXCIiLCBhbmFseXNpcy5zdW1tYXJ5LCAiXCIiXSB9KV0gfSkpXSB9KSk7Cn0KZnVuY3Rpb24gZ2V0U2NvcmVDb2xvcihzY29yZSkgewogICAgaWYgKHNjb3JlID49IDgwKQogICAgICAgIHJldHVybiAndGV4dC1ncmVlbi02MDAnOwogICAgaWYgKHNjb3JlID49IDUwKQogICAgICAgIHJldHVybiAndGV4dC1vcmFuZ2UtNTAwJzsKICAgIHJldHVybiAndGV4dC1yZWQtNjAwJzsKfQpmdW5jdGlvbiBRckhlYWRlcih7IHRpdGxlLCBzdWJUaXRsZSwgc2l0ZU5hbWUsIGNvbXBhbnlOYW1lLCBpbnNwZWN0b3JOYW1lLCBkYXRlLCBsb2dvLCB0aGVtZUNvbG9yIH0pIHsKICAgIC8vIFVzZSB0aGUgc3BlY2lmaWMgcHJvZHVjdGlvbiBVUkwgcHJvdmlkZWQgYnkgdGhlIHVzZXIKICAgIGNvbnN0IGJhc2VVcmwgPSAiaHR0cHM6Ly9jb21wbGlhbmNlLWluc3BlY3Rvci0yNDEwNjc1MzEyMDYudXMtd2VzdDEucnVuLmFwcC8iOwogICAgLy8gQ29uc3RydWN0IGEgZnVuY3Rpb25hbCBVUkwgdGhhdCBpbmNsdWRlcyBjb250ZXh0CiAgICBjb25zdCBxclBheWxvYWQgPSBgJHtiYXNlVXJsfT9yZXBvcnQ9JHtlbmNvZGVVUklDb21wb25lbnQodGl0bGUpfSZzaXRlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHNpdGVOYW1lKX0mZGF0ZT0ke2VuY29kZVVSSUNvbXBvbmVudChkYXRlKX1gOwogICAgLy8gTGFyZ2VyIHNpemUgZm9yIGJldHRlciBzY2FubmluZyByZWxpYWJpbGl0eSB3aGVuIHByaW50ZWQKICAgIGNvbnN0IHFyVXJsID0gYGh0dHBzOi8vYXBpLnFyc2VydmVyLmNvbS92MS9jcmVhdGUtcXItY29kZS8/c2l6ZT0xNTB4MTUwJmRhdGE9JHtlbmNvZGVVUklDb21wb25lbnQocXJQYXlsb2FkKX1gOwogICAgY29uc3QgcHJpbWFyeUNvbG9yID0gdGhlbWVDb2xvciB8fCAnIzBmMTcyYSc7IC8vIERlZmF1bHQgc2xhdGUtOTAwCiAgICAvLyBDaGVjayBpZiB3ZSBhcmUgaW4gRmFjaWxpdHkgbW9kZSB0byBjaGFuZ2UgdGhlIEFwcCBUaXRsZQogICAgY29uc3QgaXNGYWNpbGl0eSA9IHN1YlRpdGxlLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgY29uc3QgYXBwVGl0bGUgPSBpc0ZhY2lsaXR5ID8gIkluc3BlY3QzNjBQcm86IEZhY2lsaXR5IFZpc3VhbCBJbnNwZWN0aW9uIiA6ICJDb21wbGlhbmNlIEluc3BlY3RvciI7CiAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJvcmRlci1iLTIgcGItNCBtYi02IHByaW50Om1iLTgiLCBzdHlsZTogeyBib3JkZXJDb2xvcjogcHJpbWFyeUNvbG9yIH0sIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCIsIGNoaWxkcmVuOiBbbG9nbyA/IChfanN4KCJpbWciLCB7IHNyYzogbG9nbywgYWx0OiAiQ29tcGFueSBMb2dvIiwgY2xhc3NOYW1lOiAiaC0xNiB3LWF1dG8gb2JqZWN0LWNvbnRhaW4gbWF4LXctWzEyMHB4XSBwcmludDpibG9jayIgfSkpIDogKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy0xNiBoLTE2IHJvdW5kZWQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC13aGl0ZSBwcmludDpoaWRkZW4iLCBzdHlsZTogeyBiYWNrZ3JvdW5kQ29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogaXNGYWNpbGl0eSA/IF9qc3goQ2xpcGJvYXJkQ2hlY2ssIHsgY2xhc3NOYW1lOiAidy0xMCBoLTEwIiB9KSA6IF9qc3goU2hpZWxkLCB7IGNsYXNzTmFtZTogInctMTAgaC0xMCIgfSkgfSkpLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImgxIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTN4bCBmb250LWJvbGQgdXBwZXJjYXNlIHRyYWNraW5nLXRpZ2h0IHByaW50OnRleHQtMnhsIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogYXBwVGl0bGUgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1sZyBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgcHJpbnQ6dGV4dC1ibGFjayIsIGNoaWxkcmVuOiBjb21wYW55TmFtZSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIGZvbnQtbWVkaXVtIHByaW50OnRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46IHNpdGVOYW1lIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC1jb2wgaXRlbXMtZW5kIGdhcC0yIiwgY2hpbGRyZW46IFtfanN4KCJpbWciLCB7IHNyYzogcXJVcmwsIGFsdDogIlNjYW4gZm9yIERpZ2l0YWwgUmVwb3J0IiwgY2xhc3NOYW1lOiAidy0yNCBoLTI0IGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHAtMSBibG9jayBwcmludDpib3JkZXItYmxhY2siIH0pLCBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1bMTBweF0gdGV4dC1zbGF0ZS01MDAgZm9udC1tb25vIHRleHQtcmlnaHQgdy0yNCBsZWFkaW5nLXRpZ2h0IHByaW50OnRleHQtYmxhY2siLCBjaGlsZHJlbjogWyJTY2FuIGZvciIsIF9qc3goImJyIiwge30pLCAiRGlnaXRhbCBSZXBvcnQiXSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC00IGdyaWQgZ3JpZC1jb2xzLTQgZ2FwLTQgdGV4dC14cyB0ZXh0LXNsYXRlLTYwMCBmb250LW1vbm8gYm9yZGVyLXQgYm9yZGVyLXNsYXRlLTIwMCBwdC0yIHByaW50OmJvcmRlci1zbGF0ZS00MDAgcHJpbnQ6dGV4dC1ibGFjayIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBibG9jayB1cHBlcmNhc2UgdGV4dC1bMTBweF0gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkluc3BlY3RvciIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCIsIGNoaWxkcmVuOiBpbnNwZWN0b3JOYW1lIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBibG9jayB1cHBlcmNhc2UgdGV4dC1bMTBweF0gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogIkRhdGUiIH0pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQiLCBjaGlsZHJlbjogZGF0ZSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS00MDAgYmxvY2sgdXBwZXJjYXNlIHRleHQtWzEwcHhdIHByaW50OnRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46ICJTY29wZSIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCIsIGNoaWxkcmVuOiBzdWJUaXRsZSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtcmlnaHQiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNDAwIGJsb2NrIHVwcGVyY2FzZSB0ZXh0LVsxMHB4XSBwcmludDp0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiAiUmVmIiB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIiwgY2hpbGRyZW46IHRpdGxlIH0pXSB9KV0gfSldIH0pKTsKfQovLyAtLS0gTWFpbiBBcHAgLS0tCmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENvbXBsaWFuY2VJbnNwZWN0b3JBcHAoKSB7CiAgICBjb25zdCBbc3RhdGUsIHNldFN0YXRlXSA9IHVzZVN0YXRlKHsKICAgICAgICB2aWV3OiAnc2V0dXAnLAogICAgICAgIHNjb3BlOiBbJ09IUyddLAogICAgICAgIGNvbXBhbnlOYW1lOiAnJywKICAgICAgICBzaXRlTmFtZTogJycsCiAgICAgICAgaW5zcGVjdG9yTmFtZTogJycsCiAgICAgICAgY29tcGFueUxvZ286IG51bGwsCiAgICAgICAgaW5zcGVjdGlvbkRhdGU6IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCksCiAgICAgICAgZ2VvTG9jYXRpb246ICcnLAogICAgICAgIHJvb21zOiBbXSwKICAgICAgICBhY3RpdmVSb29tSWQ6IG51bGwsCiAgICAgICAgc3RhZ2luZ0ltYWdlczogW10sCiAgICAgICAgc3RhZ2luZ1Jvb21OYW1lOiAnJywKICAgICAgICBzdGFnaW5nRGVwYXJ0bWVudDogJycsCiAgICAgICAgc3RhZ2luZ0dlbmVyYXRlUGxhbjogZmFsc2UsCiAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgbG9hZGluZ01lc3NhZ2U6ICcnLAogICAgICAgIGxvZ3M6IFtdLAogICAgICAgIHNob3dMb2dzOiBmYWxzZQogICAgfSk7CiAgICAvLyBIZWxwZXIgdG8gbG9nIGFjdGl2aXRpZXMKICAgIGNvbnN0IGFkZExvZyA9IChhY3Rpb24sIGRldGFpbHMgPSAnJywgdHlwZSA9ICdpbmZvJykgPT4gewogICAgICAgIHNldFN0YXRlKHMgPT4gKHsKICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgbG9nczogW3sKICAgICAgICAgICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLAogICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgICAgICBhY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgZGV0YWlscywKICAgICAgICAgICAgICAgICAgICB0eXBlCiAgICAgICAgICAgICAgICB9LCAuLi5zLmxvZ3NdCiAgICAgICAgfSkpOwogICAgfTsKICAgIGNvbnN0IFtjdXN0b21RdWVyeSwgc2V0Q3VzdG9tUXVlcnldID0gdXNlU3RhdGUoJycpOwogICAgY29uc3QgZmlsZUlucHV0UmVmID0gdXNlUmVmKG51bGwpOwogICAgY29uc3QgY2FtZXJhSW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7CiAgICBjb25zdCBsb2dvSW5wdXRSZWYgPSB1c2VSZWYobnVsbCk7CiAgICAvLyBBdXRvLWRldGVjdCBHZW9Mb2NhdGlvbiBvbiBNb3VudAogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBkZXRlY3RMb2NhdGlvbigpOwogICAgfSwgW10pOwogICAgY29uc3QgZGV0ZWN0TG9jYXRpb24gPSAoKSA9PiB7CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogJ0RldGVjdGluZy4uLicgfSkpOwogICAgICAgIGlmICgiZ2VvbG9jYXRpb24iIGluIG5hdmlnYXRvcikgewogICAgICAgICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKChwb3NpdGlvbikgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbG9jID0gYCR7cG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLnRvRml4ZWQoNSl9LCAke3Bvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUudG9GaXhlZCg1KX1gOwogICAgICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogbG9jIH0pKTsKICAgICAgICAgICAgICAgIC8vIE5vdGU6IGNhbid0IGFjY2VzcyBhZGRMb2cgZGlyZWN0bHkgaGVyZSBkdWUgdG8gY2xvc3VyZSwgYnV0IHdlIGFyZSBzZXR0aW5nIHN0YXRlCiAgICAgICAgICAgIH0sIChlcnJvcikgPT4gewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiR2VvTG9jYXRpb24gRXJyb3I6IiwgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGdlb0xvY2F0aW9uOiBzLmdlb0xvY2F0aW9uID09PSAnRGV0ZWN0aW5nLi4uJyA/ICcnIDogcy5nZW9Mb2NhdGlvbiB9KSk7CiAgICAgICAgICAgIH0sIHsgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLCB0aW1lb3V0OiA1MDAwLCBtYXhpbXVtQWdlOiAwIH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJHZW9sb2NhdGlvbiBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgYnJvd3Nlci4iKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBnZW9Mb2NhdGlvbjogJycgfSkpOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBzZXRWaWV3ID0gKHZpZXcpID0+IHsKICAgICAgICBzZXRTdGF0ZShzID0+IHsKICAgICAgICAgICAgLy8gTG9nIHJlcG9ydCBnZW5lcmF0aW9uIHNwZWNpZmljYWxseQogICAgICAgICAgICBsZXQgbmV3TG9ncyA9IHMubG9nczsKICAgICAgICAgICAgaWYgKHZpZXcgPT09ICdyZXBvcnQnKSB7CiAgICAgICAgICAgICAgICBuZXdMb2dzID0gW3sKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdSZXBvcnQgR2VuZXJhdGVkJywKICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogYFZpZXdpbmcgcmVwb3J0IGZvciAke3Mucm9vbXMubGVuZ3RofSBhcmVhcy4gU2NvcGU6ICR7cy5zY29wZS5qb2luKCcsICcpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJwogICAgICAgICAgICAgICAgICAgIH0sIC4uLnMubG9nc107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHsgLi4ucywgdmlldywgbG9nczogbmV3TG9ncyB9OwogICAgICAgIH0pOwogICAgfTsKICAgIGNvbnN0IHRvZ2dsZVNjb3BlID0gKHNjb3BlKSA9PiB7CiAgICAgICAgc2V0U3RhdGUocyA9PiB7CiAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBzLnNjb3BlLmluY2x1ZGVzKHNjb3BlKTsKICAgICAgICAgICAgbGV0IG5ld1Njb3BlID0gcy5zY29wZTsKICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgIG5ld1Njb3BlID0gcy5zY29wZS5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSBzY29wZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAocy5zY29wZS5sZW5ndGggPj0gMikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gczsgLy8gTGltaXQgdG8gMiBzY29wZXMKICAgICAgICAgICAgICAgIG5ld1Njb3BlID0gWy4uLnMuc2NvcGUsIHNjb3BlXTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4geyAuLi5zLCBzY29wZTogbmV3U2NvcGUgfTsKICAgICAgICB9KTsKICAgIH07CiAgICBjb25zdCBoYW5kbGVTdGFydFNlc3Npb24gPSAoKSA9PiB7CiAgICAgICAgaWYgKCFzdGF0ZS5zaXRlTmFtZSB8fCAhc3RhdGUuY29tcGFueU5hbWUgfHwgIXN0YXRlLmluc3BlY3Rvck5hbWUpIHsKICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBmaWxsIGluIENvbXBhbnksIEZhY2lsaXR5LCBhbmQgSW5zcGVjdG9yIG5hbWVzIHRvIHN0YXJ0LiIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChzdGF0ZS5zY29wZS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYXQgbGVhc3Qgb25lIGluc3BlY3Rpb24gc2NvcGUuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYWRkTG9nKCdTZXNzaW9uIEluaXRpYWxpemVkJywgYEluc3BlY3RvcjogJHtzdGF0ZS5pbnNwZWN0b3JOYW1lfSwgU2l0ZTogJHtzdGF0ZS5zaXRlTmFtZX0sIFNjb3BlOiAke3N0YXRlLnNjb3BlLmpvaW4oJywgJyl9YCk7CiAgICAgICAgc2V0VmlldygnZGFzaGJvYXJkJyk7CiAgICB9OwogICAgY29uc3QgaGFuZGxlTG9nb1NlbGVjdCA9IChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0LmZpbGVzICYmIGUudGFyZ2V0LmZpbGVzWzBdKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBlLnRhcmdldC5maWxlc1swXTsKICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChldikgPT4gewogICAgICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBjb21wYW55TG9nbzogZXYudGFyZ2V0Py5yZXN1bHQgfSkpOwogICAgICAgICAgICB9OwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgaGFuZGxlSW1hZ2VTZWxlY3QgPSAoZSkgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5maWxlcykgewogICAgICAgICAgICBjb25zdCBuZXdGaWxlcyA9IEFycmF5LmZyb20oZS50YXJnZXQuZmlsZXMpOwogICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7CiAgICAgICAgICAgICAgICAuLi5zLAogICAgICAgICAgICAgICAgdmlldzogJ3N0YWdpbmcnLAogICAgICAgICAgICAgICAgc3RhZ2luZ0ltYWdlczogWy4uLnMuc3RhZ2luZ0ltYWdlcywgLi4ubmV3RmlsZXNdLAogICAgICAgICAgICAgICAgc3RhZ2luZ1Jvb21OYW1lOiBzLnN0YWdpbmdSb29tTmFtZSB8fCBgQXJlYSAke3Mucm9vbXMubGVuZ3RoICsgMX1gCiAgICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgaGFuZGxlU2F2ZVN0YWdpbmcgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgaWYgKHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoID09PSAwKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiB0cnVlLCBsb2FkaW5nTWVzc2FnZTogJ1NhdmluZyBhcmVhIHRvIGluc3BlY3Rpb24gcXVldWUuLi4nIH0pKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBjYXB0dXJlcyA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBzdGF0ZS5zdGFnaW5nSW1hZ2VzW2ldOwogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0RGF0YSA9IGF3YWl0IGZpbGVUb0Jhc2U2NChmaWxlKTsKICAgICAgICAgICAgICAgIGNhcHR1cmVzLnB1c2goewogICAgICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpICsgJy0nICsgaSwKICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbEltYWdlOiBgZGF0YToke2ZpbGUudHlwZX07YmFzZTY0LCR7YmFzZTY0RGF0YX1gLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgbmV3Um9vbSA9IHsKICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBuYW1lOiBzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsCiAgICAgICAgICAgICAgICBkZXBhcnRtZW50OiBzdGF0ZS5zdGFnaW5nRGVwYXJ0bWVudCB8fCAnR2VuZXJhbCcsCiAgICAgICAgICAgICAgICBjYXB0dXJlczogY2FwdHVyZXMsCiAgICAgICAgICAgICAgICBnZW5lcmF0ZVBsYW5SZXF1ZXN0OiBzdGF0ZS5zdGFnaW5nR2VuZXJhdGVQbGFuLAogICAgICAgICAgICAgICAgY3VzdG9tQ2hlY2tzOiBbXSwKICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSwKICAgICAgICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGFkZExvZygnQXJlYSBBZGRlZCcsIGBBZGRlZCAiJHtuZXdSb29tLm5hbWV9IiB3aXRoICR7Y2FwdHVyZXMubGVuZ3RofSBpbWFnZXMuIFBsYW4gUmVxdWVzdGVkOiAke3N0YXRlLnN0YWdpbmdHZW5lcmF0ZVBsYW59YCwgJ2luZm8nKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoewogICAgICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgICAgIHJvb21zOiBbLi4ucy5yb29tcywgbmV3Um9vbV0sCiAgICAgICAgICAgICAgICBzdGFnaW5nSW1hZ2VzOiBbXSwKICAgICAgICAgICAgICAgIHN0YWdpbmdSb29tTmFtZTogJycsCiAgICAgICAgICAgICAgICBzdGFnaW5nRGVwYXJ0bWVudDogJycsCiAgICAgICAgICAgICAgICBzdGFnaW5nR2VuZXJhdGVQbGFuOiBmYWxzZSwKICAgICAgICAgICAgICAgIHZpZXc6ICdkYXNoYm9hcmQnLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgIGFsZXJ0KCdGYWlsZWQgdG8gc2F2ZSBhcmVhLicpOwogICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGxvYWRpbmc6IGZhbHNlIH0pKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgYW5hbHl6ZVJvb20gPSBhc3luYyAocm9vbSkgPT4gewogICAgICAgIGxldCBldmFjdWF0aW9uUGxhblVyaSA9IHJvb20uZXZhY3VhdGlvblBsYW47CiAgICAgICAgYWRkTG9nKCdBSSBBbmFseXNpcyBTdGFydGVkJywgYEFuYWx5emluZyByb29tOiAiJHtyb29tLm5hbWV9IiAoJHtyb29tLmNhcHR1cmVzLmxlbmd0aH0gdmlld3BvaW50cykuIE1vZGVsOiBnZW1pbmktMi41LWZsYXNoYCwgJ2FpJyk7CiAgICAgICAgLy8gR2VuZXJhdGUgRXZhY3VhdGlvbiBQbGFuIGlmIHJlcXVlc3RlZCBhbmQgbm90IGFscmVhZHkgcHJlc2VudAogICAgICAgIGlmIChyb29tLmdlbmVyYXRlUGxhblJlcXVlc3QgJiYgIWV2YWN1YXRpb25QbGFuVXJpICYmIHJvb20uY2FwdHVyZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjb25zdCBiYXNlNjRGdWxsID0gcm9vbS5jYXB0dXJlc1swXS5vcmlnaW5hbEltYWdlOwogICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gYmFzZTY0RnVsbC5zcGxpdCgnLCcpWzFdOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYWRkTG9nKCdQbGFuIEdlbmVyYXRpb24gU3RhcnRlZCcsIGBHZW5lcmF0aW5nIGV2YWN1YXRpb24gcGxhbiBmb3IgJHtyb29tLm5hbWV9Li4uYCwgJ2FpJyk7CiAgICAgICAgICAgICAgICBldmFjdWF0aW9uUGxhblVyaSA9IGF3YWl0IGdlbmVyYXRlRXZhY3VhdGlvblBsYW4oYmFzZTY0RGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlBsYW4gZ2VuZXJhdGlvbiBmYWlsZWQiLCBlKTsKICAgICAgICAgICAgICAgIGFkZExvZygnUGxhbiBHZW5lcmF0aW9uIEZhaWxlZCcsIGBFcnJvciBnZW5lcmF0aW5nIHBsYW4gZm9yICR7cm9vbS5uYW1lfWAsICdlcnJvcicpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnN0IHVwZGF0ZWRDYXB0dXJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHJvb20uY2FwdHVyZXMubWFwKGFzeW5jIChjYXB0dXJlKSA9PiB7CiAgICAgICAgICAgIGlmIChjYXB0dXJlLmFuYWx5c2lzKQogICAgICAgICAgICAgICAgcmV0dXJuIGNhcHR1cmU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCBiYXNlNjREYXRhID0gY2FwdHVyZS5vcmlnaW5hbEltYWdlLnNwbGl0KCcsJylbMV07CiAgICAgICAgICAgICAgICBjb25zdCBbdGV4dEFuYWx5c2lzLCBvdmVybGF5SW1hZ2VdID0gYXdhaXQgUHJvbWlzZS5hbGwoWwogICAgICAgICAgICAgICAgICAgIHBlcmZvcm1UZXh0QW5hbHlzaXMoYmFzZTY0RGF0YSwgc3RhdGUuc2NvcGUsIHN0YXRlLmdlb0xvY2F0aW9uKSwKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZU92ZXJsYXkoYmFzZTY0RGF0YSwgc3RhdGUuc2NvcGUpCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgLi4uY2FwdHVyZSwKICAgICAgICAgICAgICAgICAgICBhbmFseXNpczogdGV4dEFuYWx5c2lzLAogICAgICAgICAgICAgICAgICAgIG92ZXJsYXlJbWFnZTogb3ZlcmxheUltYWdlLAogICAgICAgICAgICAgICAgICAgIGVycm9yOiB1bmRlZmluZWQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEFuYWx5c2lzIGZhaWxlZCBmb3IgY2FwdHVyZSAke2NhcHR1cmUuaWR9YCwgZSk7CiAgICAgICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gIkFJIEFuYWx5c2lzIGZhaWxlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4iOwogICAgICAgICAgICAgICAgaWYgKGUubWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoJzQyOScpKQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiU2VydmljZSBpcyBidXN5IChSYXRlIExpbWl0IEV4Y2VlZGVkKS4gUGxlYXNlIHJldHJ5IGluIGEgbW9tZW50LiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCc1MDMnKSB8fCBlLm1lc3NhZ2UuaW5jbHVkZXMoJzUwMCcpKQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAiQUkgU2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUGxlYXNlIHJldHJ5LiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5tZXNzYWdlLmluY2x1ZGVzKCdTYWZldHknKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gIkltYWdlIGZsYWdnZWQgYnkgc2FmZXR5IGZpbHRlcnMuIFVuYWJsZSB0byBwcm9jZXNzLiI7CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBgQW5hbHlzaXMgRXJyb3I6ICR7ZS5tZXNzYWdlfWA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIC4uLmNhcHR1cmUsCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yTWVzc2FnZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgIH0pKTsKICAgICAgICBjb25zdCBmYWlsdXJlQ291bnQgPSB1cGRhdGVkQ2FwdHVyZXMuZmlsdGVyKGMgPT4gYy5lcnJvcikubGVuZ3RoOwogICAgICAgIGlmIChmYWlsdXJlQ291bnQgPiAwKSB7CiAgICAgICAgICAgIGFkZExvZygnQUkgQW5hbHlzaXMgQ29tcGxldGUgKFdpdGggRXJyb3JzKScsIGAke2ZhaWx1cmVDb3VudH0vJHt1cGRhdGVkQ2FwdHVyZXMubGVuZ3RofSBpbWFnZXMgZmFpbGVkIHRvIGFuYWx5emUgaW4gJHtyb29tLm5hbWV9LmAsICdlcnJvcicpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYWRkTG9nKCdBSSBBbmFseXNpcyBTdWNjZXNzZnVsJywgYFN1Y2Nlc3NmdWxseSBhbmFseXplZCAke3Jvb20ubmFtZX0uYCwgJ3N1Y2Nlc3MnKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgLi4ucm9vbSwKICAgICAgICAgICAgY2FwdHVyZXM6IHVwZGF0ZWRDYXB0dXJlcywKICAgICAgICAgICAgZXZhY3VhdGlvblBsYW46IGV2YWN1YXRpb25QbGFuVXJpLAogICAgICAgICAgICBzdGF0dXM6ICdhbmFseXplZCcKICAgICAgICB9OwogICAgfTsKICAgIGNvbnN0IGhhbmRsZUJhdGNoQW5hbHl6ZSA9IGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCBwZW5kaW5nUm9vbXMgPSBzdGF0ZS5yb29tcy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ3BlbmRpbmcnIHx8IHIuY2FwdHVyZXMuc29tZShjID0+IGMuZXJyb3IpKTsKICAgICAgICBpZiAocGVuZGluZ1Jvb21zLmxlbmd0aCA9PT0gMCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGFkZExvZygnQmF0Y2ggQW5hbHlzaXMgSW5pdGlhdGVkJywgYFF1ZXVlZCAke3BlbmRpbmdSb29tcy5sZW5ndGh9IHJvb21zIGZvciBiYXRjaCBwcm9jZXNzaW5nLmAsICdpbmZvJyk7CiAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiB0cnVlLCBsb2FkaW5nTWVzc2FnZTogYE9wdGltaXppbmcgd29ya2Zsb3c6IEFuYWx5emluZyAke3BlbmRpbmdSb29tcy5sZW5ndGh9IGFyZWEocykgc2ltdWx0YW5lb3VzbHkuLi5gIH0pKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBhbmFseXplZFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChwZW5kaW5nUm9vbXMubWFwKHJvb20gPT4gYW5hbHl6ZVJvb20ocm9vbSkpKTsKICAgICAgICAgICAgY29uc3QgdXBkYXRlZFJvb21zID0gc3RhdGUucm9vbXMubWFwKHIgPT4gewogICAgICAgICAgICAgICAgY29uc3QgYW5hbHl6ZWQgPSBhbmFseXplZFJlc3VsdHMuZmluZChhciA9PiBhci5pZCA9PT0gci5pZCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYW5hbHl6ZWQgfHwgcjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsKICAgICAgICAgICAgICAgIC4uLnMsCiAgICAgICAgICAgICAgICByb29tczogdXBkYXRlZFJvb21zLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgICAgICBsb2FkaW5nTWVzc2FnZTogJycKICAgICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICAgICAgICBhZGRMb2coJ0JhdGNoIEFuYWx5c2lzIEZhaWxlZCcsICdBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkIGR1cmluZyBiYXRjaCBwcm9jZXNzaW5nLicsICdlcnJvcicpOwogICAgICAgICAgICBhbGVydCgiQmF0Y2ggYW5hbHlzaXMgaW50ZXJydXB0ZWQuIFBsZWFzZSB0cnkgYWdhaW4uIik7CiAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgbG9hZGluZzogZmFsc2UgfSkpOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBoYW5kbGVHZW5lcmF0ZVBsYW5Gb3JSb29tID0gYXN5bmMgKHJvb21JZCkgPT4gewogICAgICAgIGNvbnN0IHJvb20gPSBzdGF0ZS5yb29tcy5maW5kKHIgPT4gci5pZCA9PT0gcm9vbUlkKTsKICAgICAgICBpZiAoIXJvb20gfHwgcm9vbS5jYXB0dXJlcy5sZW5ndGggPT09IDApCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGxvYWRpbmc6IHRydWUsIGxvYWRpbmdNZXNzYWdlOiAnR2VuZXJhdGluZyBBSSBFdmFjdWF0aW9uIFBsYW4uLi4nIH0pKTsKICAgICAgICBhZGRMb2coJ01hbnVhbCBQbGFuIEdlbmVyYXRpb24nLCBgVXNlciByZXF1ZXN0ZWQgcGxhbiBnZW5lcmF0aW9uIGZvciAke3Jvb20ubmFtZX1gLCAnYWknKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBiYXNlNjQgPSByb29tLmNhcHR1cmVzWzBdLm9yaWdpbmFsSW1hZ2Uuc3BsaXQoJywnKVsxXTsKICAgICAgICAgICAgY29uc3QgcGxhblVyaSA9IGF3YWl0IGdlbmVyYXRlRXZhY3VhdGlvblBsYW4oYmFzZTY0KTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoewogICAgICAgICAgICAgICAgLi4ucywKICAgICAgICAgICAgICAgIHJvb21zOiBzLnJvb21zLm1hcChyID0+IHIuaWQgPT09IHJvb21JZCA/IHsgLi4uciwgZXZhY3VhdGlvblBsYW46IHBsYW5VcmkgfSA6IHIpLAogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBhZGRMb2coJ1BsYW4gR2VuZXJhdGlvbiBTdWNjZXNzZnVsJywgYFBsYW4gY3JlYXRlZCBmb3IgJHtyb29tLm5hbWV9YCwgJ3N1Y2Nlc3MnKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICAgICAgYWRkTG9nKCdQbGFuIEdlbmVyYXRpb24gRmFpbGVkJywgYEZhaWxlZCB0byBnZW5lcmF0ZSBwbGFuIGZvciAke3Jvb20ubmFtZX1gLCAnZXJyb3InKTsKICAgICAgICAgICAgc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBsb2FkaW5nOiBmYWxzZSB9KSk7CiAgICAgICAgICAgIGFsZXJ0KCJGYWlsZWQgdG8gZ2VuZXJhdGUgcGxhbiIpOwogICAgICAgIH0KICAgIH07CiAgICAvLyAuLi4gKHBlcmZvcm1DdXN0b21BbmFseXNpcywgZmlsZVRvQmFzZTY0LCBwZXJmb3JtVGV4dEFuYWx5c2lzLCBnZW5lcmF0ZU92ZXJsYXksIGdlbmVyYXRlRXZhY3VhdGlvblBsYW4gaGVscGVycyByZW1haW4gc2FtZSkgLi4uCiAgICBjb25zdCBmaWxlVG9CYXNlNjQgPSAoZmlsZSkgPT4gewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoKSA9PiByZXNvbHZlKHJlYWRlci5yZXN1bHQuc3BsaXQoJywnKVsxXSk7CiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0OwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKICAgICAgICB9KTsKICAgIH07CiAgICBjb25zdCBwZXJmb3JtVGV4dEFuYWx5c2lzID0gYXN5bmMgKGJhc2U2NEltYWdlLCBzY29wZXMsIGxvY2F0aW9uKSA9PiB7CiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDb25maWdzID0gc2NvcGVzLm1hcChzID0+IFNDT1BFX0NPTkZJR1tzXSk7CiAgICAgICAgY29uc3QgbGFiZWxzID0gc2VsZWN0ZWRDb25maWdzLm1hcChjID0+IGMubGFiZWwpLmpvaW4oJywgJyk7CiAgICAgICAgY29uc3QgZm9jdXNlcyA9IHNlbGVjdGVkQ29uZmlncy5tYXAoYyA9PiBjLmZvY3VzKS5qb2luKCc7ICcpOwogICAgICAgIGNvbnN0IHN0YW5kYXJkcyA9IHNlbGVjdGVkQ29uZmlncy5tYXAoYyA9PiBjLnN0YW5kYXJkcykuam9pbignOyAnKTsKICAgICAgICBjb25zdCBleHBlY3RlZERvY3MgPSBzZWxlY3RlZENvbmZpZ3MubWFwKGMgPT4gYy5kb2N1bWVudHMpLmpvaW4oJzsgJyk7CiAgICAgICAgY29uc3QgaXNGYWNpbGl0eVNjb3BlID0gc2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgICAgIGNvbnN0IGxvY0NvbnRleHQgPSBsb2NhdGlvbiAmJiBsb2NhdGlvbiAhPT0gJ0ZldGNoaW5nLi4uJyAmJiBsb2NhdGlvbiAhPT0gJ0RldGVjdGluZy4uLicKICAgICAgICAgICAgPyBgVGhlIGluc3BlY3Rpb24gaXMgdGFraW5nIHBsYWNlIGF0IHNwZWNpZmljIGxvY2F0aW9uOiAiJHtsb2NhdGlvbn0iLiBZb3UgTVVTVCBpbmZlciB0aGUgY291bnRyeS9yZWdpb24gYW5kIGFwcGx5IHRoZSBzcGVjaWZpYyBsb2NhbCBsYXdzL2NvZGVzIHJlbGV2YW50IHRvIHRoaXMganVyaXNkaWN0aW9uIGZvciBlYWNoIHNjb3BlLmAKICAgICAgICAgICAgOiBgVGhlIGluc3BlY3Rpb24gbG9jYXRpb24gaXMgZ2VuZXJpYy91bmtub3duLiBBcHBseSBJbnRlcm5hdGlvbmFsIEJlc3QgUHJhY3RpY2VzIChJU08vTkZQQSkuYDsKICAgICAgICBjb25zdCByZXNwb25zZVNjaGVtYSA9IHsKICAgICAgICAgICAgdHlwZTogVHlwZS5PQkpFQ1QsCiAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgIHNjb3JlOiB7IHR5cGU6IFR5cGUuTlVNQkVSLCBkZXNjcmlwdGlvbjogIkNvbXBsaWFuY2Ugc2NvcmUgMC0xMDAiIH0sCiAgICAgICAgICAgICAgICBoYXphcmRzOiB7IHR5cGU6IFR5cGUuQVJSQVksIGl0ZW1zOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0sIGRlc2NyaXB0aW9uOiAiTGlzdCBvZiBoYXphcmRzIChTdW1tYXJ5KS4iIH0sCiAgICAgICAgICAgICAgICB6b25pbmdJc3N1ZXM6IHsgdHlwZTogVHlwZS5TVFJJTkcsIGRlc2NyaXB0aW9uOiAiQW5hbHlzaXMgb2YgbWFya2luZ3MuIiB9LAogICAgICAgICAgICAgICAgc3VtbWFyeTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJFeGVjdXRpdmUgc3VtbWFyeS4iIH0sCiAgICAgICAgICAgICAgICByZWxldmFudFN0YW5kYXJkczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuQVJSQVksCiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogVHlwZS5PQkpFQ1QsCiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YW5kYXJkSWQ6IHsgdHlwZTogVHlwZS5TVFJJTkcgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBtaXNzaW5nRG9jdW1lbnRzOiB7IHR5cGU6IFR5cGUuQVJSQVksIGl0ZW1zOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0gfSwKICAgICAgICAgICAgICAgIHJlY29tbWVuZGVkSXRlbXM6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBUeXBlLkFSUkFZLAogICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuT0JKRUNULAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogeyB0eXBlOiBUeXBlLlNUUklORyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uOiB7IHR5cGU6IFR5cGUuU1RSSU5HIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJPbmUgb2YgdGhlIDkgc3BlY2lmaWMgZmFjaWxpdHkgY2F0ZWdvcmllcyBpZiBhcHBsaWNhYmxlLiIgfSwKICAgICAgICAgICAgICAgIHJpc2tMZXZlbDogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJPdmVyYWxsIHJpc2sgbGV2ZWwgZm9yIHRoaXMgaW1hZ2U6IExvdywgTWVkaXVtLCBvciBIaWdoLiIgfSwKICAgICAgICAgICAgICAgIGRldGFpbGVkRmluZGluZ3M6IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBUeXBlLkFSUkFZLAogICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFR5cGUuT0JKRUNULAogICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZTogeyB0eXBlOiBUeXBlLlNUUklORyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogeyB0eXBlOiBUeXBlLlNUUklORywgZGVzY3JpcHRpb246ICJHb29kIGNvbmRpdGlvbiwgTWlub3IgaXNzdWUsIE1ham9yIGRlZmVjdCwgU2FmZXR5IGhhemFyZCwgb3IgQ29tcGxpYW5jZSBnYXAiIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaXNrOiB7IHR5cGU6IFR5cGUuU1RSSU5HLCBkZXNjcmlwdGlvbjogIkxvdywgTWVkaXVtLCBIaWdoLCBvciBOb25lIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb21tZW5kYXRpb246IHsgdHlwZTogVHlwZS5TVFJJTkcsIGRlc2NyaXB0aW9uOiAiUHJldmVudGl2ZS9Db3JyZWN0aXZlL0ltcHJvdmVtZW50IGFjdGlvbiIgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICByZXF1aXJlZDogWyJzY29yZSIsICJoYXphcmRzIiwgInpvbmluZ0lzc3VlcyIsICJzdW1tYXJ5IiwgInJlbGV2YW50U3RhbmRhcmRzIiwgIm1pc3NpbmdEb2N1bWVudHMiLCAicmVjb21tZW5kZWRJdGVtcyJdCiAgICAgICAgfTsKICAgICAgICBsZXQgcHJvbXB0ID0gYAogICAgICBDb250ZXh0OiAke2xvY0NvbnRleHR9CiAgICAgIFRhc2s6IEFuYWx5emUgT05MWSBmb3IgdGhlIGZvbGxvd2luZyBjb21wbGlhbmNlIHNjb3BlczogJHtsYWJlbHN9LiAKICAgICAgQ1JJVElDQUw6IFNUUklDVExZIElHTk9SRSBhbnkgaXNzdWVzLCBoYXphcmRzLCBvciBub24tY29tcGxpYW5jZSB0aGF0IGZhbGxzIG91dHNpZGUgb2YgdGhlc2Ugc2VsZWN0ZWQgc2NvcGVzLgogICAgICAKICAgICAgMS4gSlVSSVNESUNUSU9OICYgU0NPUEUgTUFQUElORzogCiAgICAgIEJhc2VkIG9uIHRoZSBsb2NhdGlvbiAiJHtsb2NhdGlvbn0iLCBhcHBseSBzcGVjaWZpYyBMb2NhbCBMZWdpc2xhdGlvbiBhbmQgSW50ZXJuYXRpb25hbCBTdGFuZGFyZHM6CiAgICAgICR7c3RhbmRhcmRzfQoKICAgICAgMi4gQ09NQklORUQgQU5BTFlTSVM6CiAgICAgIC0gRm9jdXMgT05MWSBvbjogJHtmb2N1c2VzfS4gCiAgICBgOwogICAgICAgIGlmIChpc0ZhY2lsaXR5U2NvcGUpIHsKICAgICAgICAgICAgcHJvbXB0ICs9IGAKICAgICAgICBTUEVDSUZJQyBJTlNUUlVDVElPTlMgRk9SIElTTyA0MTAwMSBGQUNJTElUWSBJTlNQRUNUSU9OOgogICAgICAgIEEuIENMQVNTSUZZIHRoZSBpbWFnZSBpbnRvIEVYQUNUTFkgT05FIG9mIHRoZXNlIDkgY2F0ZWdvcmllczoKICAgICAgICAgICAxLiBFeHRlcmlvciBGYWNpbGl0eSAoV2FsbHMsIGZhw6dhZGUsIHJvb2YsIGJvdW5kYXJ5LCBwYXJraW5nKQogICAgICAgICAgIDIuIEludGVyaW9yIEZhY2lsaXR5IChGbG9vcnMsIGNlaWxpbmdzLCB3YWxscywgZG9vcnMsIHN0YWlycykKICAgICAgICAgICAzLiBNRVAgU3lzdGVtcyAoVmlzdWFsIE9ubHkgLSBFbGVjdHJpY2FsLCBIVkFDLCBQbHVtYmluZykKICAgICAgICAgICA0LiBGaXJlICYgTGlmZSBTYWZldHkgKEV4dGluZ3Vpc2hlcnMsIGV4aXRzLCBzcHJpbmtsZXJzKQogICAgICAgICAgIDUuIEZhY2lsaXR5IFNlY3VyaXR5IChDQ1RWLCBhY2Nlc3MsIGJvdW5kYXJ5KQogICAgICAgICAgIDYuIEVudmlyb25tZW50YWwgJiBTdXN0YWluYWJpbGl0eSAoV2FzdGUsIGNoZW1pY2FscywgbGVha3MpCiAgICAgICAgICAgNy4gQXNzZXQgQ29uZGl0aW9uIChFcXVpcG1lbnQsIGxhYmVscywgcmFja2luZykKICAgICAgICAgICA4LiBDbGVhbmxpbmVzcyAmIEhvdXNla2VlcGluZyAoQ2x1dHRlciwgc3BpbGxzLCBwZXN0KQogICAgICAgICAgIDkuIENvbnRyYWN0b3IgQ29tcGxpYW5jZSAoUFBFLCBiYXJyaWNhZGluZywgdG9vbHMpCgogICAgICAgIEIuIElERU5USUZZIEZJTkRJTkdTIGZvciAnZGV0YWlsZWRGaW5kaW5ncyc6CiAgICAgICAgICAgLSBGb3IgZWFjaCBvYnNlcnZhdGlvbiwgZGV0ZXJtaW5lIHRoZSBUeXBlOiAnR29vZCBjb25kaXRpb24nLCAnTWlub3IgaXNzdWUnLCAnTWFqb3IgZGVmZWN0JywgJ1NhZmV0eSBoYXphcmQnLCBvciAnQ29tcGxpYW5jZSBnYXAnLgogICAgICAgICAgIC0gQXNzaWduIGEgUmlzayBMZXZlbDogJ0xvdycsICdNZWRpdW0nLCAnSGlnaCcsIG9yICdOb25lJy4KICAgICAgICAgICAtIFByb3ZpZGUgYSBSZWNvbW1lbmRhdGlvbiAoUHJldmVudGl2ZSwgQ29ycmVjdGl2ZSwgb3IgSW1wcm92ZW1lbnQpLgogICAgICAgIAogICAgICAgIEMuIFNDT1JFOgogICAgICAgICAgIC0gUHJvdmlkZSBhbiBvdmVyYWxsIHNjb3JlICgwLTEwMCkgZm9yIHRoaXMgaW1hZ2UgYmFzZWQgb24gdGhlIGZpbmRpbmdzLgogICAgICAgIGA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwcm9tcHQgKz0gYAogICAgICAgIC0gQ29tcGFyZSB2aXN1YWwgZXZpZGVuY2UgYWdhaW5zdCB0aGVzZSBTUEVDSUZJQyBpbmZlcnJlZCBsb2NhbCBsYXdzLgogICAgICAgIC0gRm9yIE9IUywgcHJpb3JpdGl6ZSB0cmlwIGhhemFyZHMsIGd1YXJkcywgYW5kIG1hcmtpbmdzLgogICAgICAgIGA7CiAgICAgICAgfQogICAgICAgIHByb21wdCArPSBgCiAgICAgIDMuIFJFTUVESUFUSU9OIElURU1TIChCSUxMIE9GIE1BVEVSSUFMUyk6CiAgICAgIC0gSWRlbnRpZnkgcGh5c2ljYWwgaXRlbXMgbmVlZGVkIHRvIGZpeCB0aGVzZSBoYXphcmRzLgoKICAgICAgNC4gUkVQT1JUSU5HIChTVEFOREFSRFMgJiBET0NVTUVOVFMpOgogICAgICAtIEluICdyZWxldmFudFN0YW5kYXJkcycsIGxpc3Qgc3BlY2lmaWMgbGF3cyBmb3VuZC4KICAgICAgLSBJbiAnbWlzc2luZ0RvY3VtZW50cycsIGluZmVyIHJlcXVpcmVkIGNvbXBsaWFuY2UgZG9jdW1lbnRzIGZyb20gdGhpcyByZWZlcmVuY2UgbGlzdDogWyR7ZXhwZWN0ZWREb2NzfV0uIAogICAgICAtIE9OTFkgbGlzdCBkb2N1bWVudHMgdGhhdCBhcmUgbGlrZWx5IG1pc3Npbmcgb3IgcmVxdWlyZWQgYmFzZWQgb24gdGhlIHZpc3VhbCBldmlkZW5jZSBkZXRlY3RlZCAoZS5nLiBpZiBhIG1hY2hpbmUgaXMgdW5ndWFyZGVkLCBmbGFnICdSaXNrIEFzc2Vzc21lbnQnIGFuZCAnTWFpbnRlbmFuY2UgTG9ncycpLiBEbyBub3QgbGlzdCBhbGwuCiAgICBgOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2VuQUkubW9kZWxzLmdlbmVyYXRlQ29udGVudCh7CiAgICAgICAgICAgICAgICBtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gnLAogICAgICAgICAgICAgICAgY29udGVudHM6IHsgcGFydHM6IFt7IGlubGluZURhdGE6IHsgbWltZVR5cGU6ICdpbWFnZS9qcGVnJywgZGF0YTogYmFzZTY0SW1hZ2UgfSB9LCB7IHRleHQ6IHByb21wdCB9XSB9LAogICAgICAgICAgICAgICAgY29uZmlnOiB7IHJlc3BvbnNlTWltZVR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJywgcmVzcG9uc2VTY2hlbWE6IHJlc3BvbnNlU2NoZW1hIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IHRleHQgPSByZXNwb25zZS50ZXh0OwogICAgICAgICAgICBpZiAoIXRleHQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVtcHR5IHJlc3BvbnNlIGZyb20gQUkgbW9kZWwuIik7CiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRleHQpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVGV4dCBBbmFseXNpcyBFcnJvcjoiLCBlcnJvcik7CiAgICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgIH07CiAgICBjb25zdCBwZXJmb3JtQ3VzdG9tQW5hbHlzaXMgPSBhc3luYyAoaW1hZ2VzLCBxdWVyeSwgbG9jYXRpb24pID0+IHsKICAgICAgICAvLyAuLi4gKEV4aXN0aW5nIGN1c3RvbSBhbmFseXNpcyBpbXBsKSAuLi4KICAgICAgICBjb25zdCBpbWFnZVBhcnRzID0gaW1hZ2VzLm1hcChpbWcgPT4gKHsKICAgICAgICAgICAgaW5saW5lRGF0YTogeyBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLCBkYXRhOiBpbWcuc3BsaXQoJywnKVsxXSB9CiAgICAgICAgfSkpOwogICAgICAgIGNvbnN0IHByb21wdCA9IGAKICAgICAgQ29udGV4dDogSW5zcGVjdGlvbiBhdCAke2xvY2F0aW9ufS4KICAgICAgVGFzazogQW5hbHl6ZSB0aGUgcHJvdmlkZWQgaW1hZ2VzIG9mIHRoaXMgcm9vbS9hcmVhIHNwZWNpZmljYWxseSBhZ2FpbnN0IHRoZSBmb2xsb3dpbmcgc3RhbmRhcmQvcmVxdWlyZW1lbnQ6ICIke3F1ZXJ5fSIuCiAgICAgIAogICAgICBQcm92aWRlIGEgY29uY2lzZSBidXQgcHJvZmVzc2lvbmFsIGFzc2Vzc21lbnQgcmVwb3J0IGluY2x1ZGluZzoKICAgICAgMS4gQ29tcGxpYW5jZSBWZXJkaWN0IChDb21wbGlhbnQgLyBOb24tQ29tcGxpYW50IC8gTmVlZHMgUmV2aWV3KQogICAgICAyLiBTcGVjaWZpYyBPYnNlcnZhdGlvbnMgcmVsYXRlZCBzcGVjaWZpY2FsbHkgdG8gIiR7cXVlcnl9IiBiYXNlZCBvbiB2aXN1YWwgZXZpZGVuY2UuCiAgICAgIDMuIENpdGF0aW9uIG9mIGxpa2VseSBhcHBsaWNhYmxlIGNsYXVzZXMgb2YgdGhlIHJlcXVlc3RlZCBzdGFuZGFyZCAoaWYga25vd24pIG9yIGdlbmVyYWwgYmVzdCBwcmFjdGljZXMuCiAgICAgIDQuIFJlY29tbWVuZGVkIFJlbWVkaWF0aW9uIHN0ZXBzIGlmIGFwcGxpY2FibGUuCiAgICAgIAogICAgICBGb3JtYXQgdGhlIG91dHB1dCBpbiBjbGVhbiBNYXJrZG93bi4KICAgIGA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5BSS5tb2RlbHMuZ2VuZXJhdGVDb250ZW50KHsKICAgICAgICAgICAgICAgIG1vZGVsOiAnZ2VtaW5pLTIuNS1mbGFzaCcsCiAgICAgICAgICAgICAgICBjb250ZW50czogeyBwYXJ0czogWy4uLmltYWdlUGFydHMsIHsgdGV4dDogcHJvbXB0IH1dIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0IHx8ICJObyByZXNwb25zZSBnZW5lcmF0ZWQuIjsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkN1c3RvbSBBbmFseXNpcyBFcnJvcjoiLCBlcnJvcik7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRmFpbGVkIHRvIGNvbnN1bHQgQUkgY29uc3VsdGFudC4iKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgZ2VuZXJhdGVPdmVybGF5ID0gYXN5bmMgKGJhc2U2NEltYWdlLCBzY29wZXMpID0+IHsKICAgICAgICAvLyAuLi4gKEV4aXN0aW5nIG92ZXJsYXkgaW1wbCkgLi4uCiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDb25maWdzID0gc2NvcGVzLm1hcChzID0+IFNDT1BFX0NPTkZJR1tzXSk7CiAgICAgICAgY29uc3QgbGFiZWxzID0gc2VsZWN0ZWRDb25maWdzLm1hcChjID0+IGMubGFiZWwpLmpvaW4oJyBhbmQgJyk7CiAgICAgICAgbGV0IGV4YW1wbGVzID0gIidIQVpBUkQnIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdPSFMnKSkKICAgICAgICAgICAgZXhhbXBsZXMgKz0gIiwgJ1RSSVAgSEFaQVJEJywgJ01JU1NJTkcgR1VBUkQnLCAnU0FGRSBXQUxLV0FZJyI7CiAgICAgICAgaWYgKHNjb3Blcy5pbmNsdWRlcygnRmlyZScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQkxPQ0tFRCBFWElUJywgJ0ZJUkUgUklTSycsICdFWFRJTkdVSVNIRVInIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdTZWN1cml0eScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQkxJTkQgU1BPVCcsICdXRUFLIEVOVFJZJywgJ05PIENDVFYnIjsKICAgICAgICBpZiAoc2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpKQogICAgICAgICAgICBleGFtcGxlcyArPSAiLCAnQ1JBQ0snLCAnTEVBSycsICdEQU1BR0VEIEFTU0VUJywgJ0NMVVRURVInIjsKICAgICAgICBjb25zdCBwcm9tcHQgPSBgCiAgICAgIFJlZHJhdyB0aGUgaW1hZ2Ugd2l0aCBzYWZldHkvaW5zcGVjdGlvbiBvdmVybGF5cyBPTkxZIGZvciAke2xhYmVsc30uCiAgICAgIAogICAgICAxLiBERVRFQ1QgSEFaQVJEUyAoUkVEIEJvdW5kaW5nIEJveGVzICYgVGV4dCk6CiAgICAgICAgIC0gSWRlbnRpZnkgaGF6YXJkcyByZWxldmFudCB0byAke2xhYmVsc30uCiAgICAgICAgICR7c2NvcGVzLmluY2x1ZGVzKCdPSFMnKSA/IGAKICAgICAgICAgLSBDUklUSUNBTCBPSFMgVEFTSzogRGV0ZWN0IFRSSVAgSEFaQVJEUy4gTGFiZWwgYXMgJ1RSSVAgSEFaQVJEJy4KICAgICAgICAgLSBDUklUSUNBTCBPSFMgVEFTSzogRGV0ZWN0IFVOR1VBUkRFRCBNQUNISU5FUlkuIExhYmVsIGFzICdOTyBHVUFSRCcuCiAgICAgICAgIC0gQ1JJVElDQUwgT0hTIFRBU0s6IElmIGluZHVzdHJpYWwgbWFjaGluZXMgTEFDSyB5ZWxsb3cvYmxhY2sgc2FmZXR5IHpvbmluZywgRFJBVyBWSVJUVUFMIFlFTExPVy9CTEFDSyBESUFHT05BTCBTVFJJUEVTIG9uIHRoZSBmbG9vciBzdXJyb3VuZGluZyB0aGUgbWFjaGluZS5gIDogIiJ9CiAgICAgICAgICR7c2NvcGVzLmluY2x1ZGVzKCdGYWNpbGl0eScpID8gYAogICAgICAgICAtIERldGVjdCB2aXN1YWwgZGVmZWN0cyAoY3JhY2tzLCBzdGFpbnMsIGxlYWtzLCBjbHV0dGVyKS4gTGFiZWwgY2xlYXJseSAoZS5nLiwgJ1dBTEwgQ1JBQ0snLCAnV0FURVIgTEVBSycpLmAgOiAiIn0KICAgICAgICAgLSBMYWJlbCBhbGwgaGF6YXJkcyBjbGVhcmx5IChlLmcuLCAke2V4YW1wbGVzfSkuCgogICAgICAyLiBERVRFQ1QgUE9TSVRJVkUgQ09NUExJQU5DRSAoR1JFRU4gQm91bmRpbmcgQm94ZXMgJiBUZXh0KToKICAgICAgICAgLSBMYWJlbCBhcyAnQ09NUExJQU5UJyBvciAnR09PRCBDT05ESVRJT04nLgoKICAgICAgMy4gVklTVUFMIFFVQUxJVFk6CiAgICAgICAgIC0gRW5zdXJlIHRleHQgaXMgVVBQRVJDQVNFLCBMRUdJQkxFLCBhbmQgU1BFTExFRCBDT1JSRUNUTFkuCiAgICBgOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2VuQUkubW9kZWxzLmdlbmVyYXRlQ29udGVudCh7CiAgICAgICAgICAgICAgICBtb2RlbDogJ2dlbWluaS0yLjUtZmxhc2gtaW1hZ2UnLAogICAgICAgICAgICAgICAgY29udGVudHM6IHsgcGFydHM6IFt7IGlubGluZURhdGE6IHsgbWltZVR5cGU6ICdpbWFnZS9qcGVnJywgZGF0YTogYmFzZTY0SW1hZ2UgfSB9LCB7IHRleHQ6IHByb21wdCB9XSB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcmVzcG9uc2UuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cyB8fCBbXSkgewogICAgICAgICAgICAgICAgaWYgKHBhcnQuaW5saW5lRGF0YSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYGRhdGE6JHtwYXJ0LmlubGluZURhdGEubWltZVR5cGV9O2Jhc2U2NCwke3BhcnQuaW5saW5lRGF0YS5kYXRhfWA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCJPdmVybGF5IGdlbmVyYXRpb24gZmFpbGVkLCByZXR1cm5pbmcgb3JpZ2luYWwuIiwgZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBgZGF0YTppbWFnZS9qcGVnO2Jhc2U2NCwke2Jhc2U2NEltYWdlfWA7CiAgICB9OwogICAgY29uc3QgZ2VuZXJhdGVFdmFjdWF0aW9uUGxhbiA9IGFzeW5jIChiYXNlNjRJbWFnZSkgPT4gewogICAgICAgIC8vIC4uLiAoRXhpc3RpbmcgcGxhbiBpbXBsKSAuLi4KICAgICAgICBjb25zdCBwcm9tcHQgPSBgCiAgICAgIENyZWF0ZSBhIHByb2Zlc3Npb25hbCBldmFjdWF0aW9uIHBsYW4gZmxvb3IgbWFwIGJhc2VkIG9uIHRoaXMgaW1hZ2UuCiAgICAgIDEuIERyYXcgYSBjbGVhciB3aGl0ZSBmbG9vciBwbGFuIHdpdGggYmxhY2sgd2FsbHMuCiAgICAgIDIuIEFERCBGTE9PUiBNQVJLSU5HUzogRHJhdyBkaXN0aW5jdCBHcmVlbiBwYXRod2F5cy9hcnJvd3Mgb24gdGhlIGZsb29yIGluZGljYXRpbmcgdGhlIHNhZmUgZXhpdCByb3V0ZS4KICAgICAgMy4gTWFyayAnRU1FUkdFTkNZIEVYSVQnIGxvY2F0aW9ucyB3aXRoIHN0YW5kYXJkIEdyZWVuL1doaXRlIGV4aXQgc2lnbnMuCiAgICAgIDQuIEFkZCBSZWQgaWNvbnMgZm9yIEZpcmUgRXh0aW5ndWlzaGVycyBpZiByZWxldmFudCB0byB0aGUgbG9jYXRpb24uCiAgICAgIDUuIFRpdGxlIHRoZSB0b3AgJ0VWQUNVQVRJT04gUExBTicuCiAgICAgIDYuIENSSVRJQ0FMOiBFbnN1cmUgdGhlIHRpdGxlIGFuZCAnRVhJVCcgc2lnbnMgYXJlIFNQRUxMRUQgQ09SUkVDVExZIGFuZCBhcmUgY3Jpc3AvbGVnaWJsZS4KICAgIGA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5BSS5tb2RlbHMuZ2VuZXJhdGVDb250ZW50KHsKICAgICAgICAgICAgICAgIG1vZGVsOiAnZ2VtaW5pLTIuNS1mbGFzaC1pbWFnZScsCiAgICAgICAgICAgICAgICBjb250ZW50czogeyBwYXJ0czogW3sgaW5saW5lRGF0YTogeyBtaW1lVHlwZTogJ2ltYWdlL2pwZWcnLCBkYXRhOiBiYXNlNjRJbWFnZSB9IH0sIHsgdGV4dDogcHJvbXB0IH1dIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiByZXNwb25zZS5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzIHx8IFtdKSB7CiAgICAgICAgICAgICAgICBpZiAocGFydC5pbmxpbmVEYXRhKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBgZGF0YToke3BhcnQuaW5saW5lRGF0YS5taW1lVHlwZX07YmFzZTY0LCR7cGFydC5pbmxpbmVEYXRhLmRhdGF9YDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLndhcm4oIkV2YWN1YXRpb24gcGxhbiBnZW5lcmF0aW9uIGZhaWxlZC4iLCBlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGBkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCR7YmFzZTY0SW1hZ2V9YDsKICAgIH07CiAgICAvLyAuLi4gKFZpZXdzKSAuLi4KICAgIGlmIChzdGF0ZS5sb2FkaW5nKSB7CiAgICAgICAgLy8gLi4uCiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtNTAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcC02IiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4KExvYWRlcjIsIHsgY2xhc3NOYW1lOiAidy0xMiBoLTEyIHRleHQtYmx1ZS02MDAgYW5pbWF0ZS1zcGluIG1iLTQiIH0pLCBfanN4KCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC14bCBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogIlByb2Nlc3NpbmcgQXVkaXQuLi4iIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTUwMCBtdC0yIiwgY2hpbGRyZW46IHN0YXRlLmxvYWRpbmdNZXNzYWdlIH0pXSB9KSk7CiAgICB9CiAgICAvLyBTZXR1cCBWaWV3CiAgICBpZiAoc3RhdGUudmlldyA9PT0gJ3NldHVwJykgewogICAgICAgIC8vIC4uLiAoU2V0dXAgdmlldyBsb2dpYyB1bmNoYW5nZWQpIC4uLgogICAgICAgIGNvbnN0IGlzUmVhZHkgPSBzdGF0ZS5jb21wYW55TmFtZSAmJiBzdGF0ZS5zaXRlTmFtZSAmJiBzdGF0ZS5pbnNwZWN0b3JOYW1lICYmIHN0YXRlLnNjb3BlLmxlbmd0aCA+IDA7CiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtMTAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtNCBtZDpwLTYgZm9udC1zYW5zIiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSByb3VuZGVkLTN4bCBzaGFkb3ctMnhsIG92ZXJmbG93LWhpZGRlbiBtYXgtdy02eGwgdy1mdWxsIGdyaWQgZ3JpZC1jb2xzLTEgbGc6Z3JpZC1jb2xzLTEyIG1pbi1oLVs2MDBweF0iLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImxnOmNvbC1zcGFuLTUgYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1zbGF0ZS05MDAgdmlhLWJsdWUtOTAwIHRvLWluZGlnby05MDAgcC04IG1kOnAtMTIgdGV4dC13aGl0ZSBmbGV4IGZsZXgtY29sIGp1c3RpZnktYmV0d2VlbiByZWxhdGl2ZSBvdmVyZmxvdy1oaWRkZW4iLCBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTAgcmlnaHQtMCB3LTY0IGgtNjQgYmctd2hpdGUvNSByb3VuZGVkLWZ1bGwgLXRyYW5zbGF0ZS15LTEvMiB0cmFuc2xhdGUteC0xLzIgYmx1ci0zeGwiIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGJvdHRvbS0wIGxlZnQtMCB3LTY0IGgtNjQgYmctYmx1ZS01MDAvMjAgcm91bmRlZC1mdWxsIHRyYW5zbGF0ZS15LTEvMiAtdHJhbnNsYXRlLXgtMS8yIGJsdXItM3hsIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicmVsYXRpdmUgei0xMCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMgbWItNiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZS8xMCBiYWNrZHJvcC1ibHVyIHAtMiByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItd2hpdGUvMjAiLCBjaGlsZHJlbjogX2pzeChTaGllbGQsIHsgY2xhc3NOYW1lOiAidy04IGgtOCB0ZXh0LWJsdWUtMzAwIiB9KSB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRyYWNraW5nLXdpZGVzdCB0ZXh0LXNtIHRleHQtYmx1ZS0yMDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJDb21wbGlhbmNlR3VhcmQgQUkiIH0pXSB9KSwgX2pzeHMoImgxIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTR4bCBtZDp0ZXh0LTV4bCBmb250LWJsYWNrIGxlYWRpbmctdGlnaHQgbWItNiIsIGNoaWxkcmVuOiBbIkludGVsbGlnZW50ICIsIF9qc3goImJyIiwge30pLCBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXRyYW5zcGFyZW50IGJnLWNsaXAtdGV4dCBiZy1ncmFkaWVudC10by1yIGZyb20tYmx1ZS0yMDAgdG8td2hpdGUiLCBjaGlsZHJlbjogIkF1ZGl0ICYgU2FmZXR5IiB9KSwgIiAiLCBfanN4KCJiciIsIHt9KSwgIkNvbXBsaWFuY2UuIl0gfSksIF9qc3goInAiLCB7IGNsYXNzTmFtZTogInRleHQtYmx1ZS0yMDAgdGV4dC1sZyBsZWFkaW5nLXJlbGF4ZWQgbWItOCBtYXgtdy1tZCIsIGNoaWxkcmVuOiAiVHJhbnNmb3JtIHlvdXIgaW5zcGVjdGlvbiB3b3JrZmxvdyB3aXRoIHJlYWwtdGltZSBBSSBoYXphcmQgZGV0ZWN0aW9uLCBhdXRvbWF0ZWQgcmVndWxhdG9yeSBtYXBwaW5nLCBhbmQgaW5zdGFudCByZXBvcnRpbmcuIiB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAibXQtMTIgdGV4dC14cyB0ZXh0LWJsdWUtNDAwLzYwIGZvbnQtbW9ubyIsIGNoaWxkcmVuOiAidjIuNi4wIFx1MjAyMiBQb3dlcmVkIGJ5IEdlbWluaSAyLjUgRmxhc2giIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJsZzpjb2wtc3Bhbi03IHAtOCBtZDpwLTEyIGJnLXdoaXRlIGZsZXggZmxleC1jb2wganVzdGlmeS1jZW50ZXIiLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXcteGwgbXgtYXV0byB3LWZ1bGwiLCBjaGlsZHJlbjogW19qc3goImgyIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgdGV4dC1zbGF0ZS04MDAgbWItMiIsIGNoaWxkcmVuOiAiU3RhcnQgSW5zcGVjdGlvbiBTZXNzaW9uIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgbWItOCIsIGNoaWxkcmVuOiAiRW50ZXIgc2Vzc2lvbiBkZXRhaWxzIHRvIGNvbmZpZ3VyZSB0aGUgQUkgY29udGV4dC4iIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImdyaWQgZ3JpZC1jb2xzLTEgbWQ6Z3JpZC1jb2xzLTIgZ2FwLTUiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInNwYWNlLXktMS41IiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJDb21wYW55IE5hbWUiIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSIsIGNoaWxkcmVuOiBbX2pzeChCcmllZmNhc2UsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgbGVmdC0zIHRvcC0zIHctNCBoLTQgdGV4dC1zbGF0ZS00MDAiIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogInRleHQiLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcGwtMTAgcC0yLjUgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTgwMCBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1ibHVlLTUwMCBvdXRsaW5lLW5vbmUgdHJhbnNpdGlvbi1hbGwiLCBwbGFjZWhvbGRlcjogImUuZy4gQWNtZSBJbmR1c3RyaWVzIiwgdmFsdWU6IHN0YXRlLmNvbXBhbnlOYW1lLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgY29tcGFueU5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEuNSIsIGNoaWxkcmVuOiBbX2pzeCgibGFiZWwiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiRmFjaWxpdHkgLyBTaXRlIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicmVsYXRpdmUiLCBjaGlsZHJlbjogW19qc3goQnVpbGRpbmcsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgbGVmdC0zIHRvcC0zIHctNCBoLTQgdGV4dC1zbGF0ZS00MDAiIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogInRleHQiLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcGwtMTAgcC0yLjUgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTgwMCBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1ibHVlLTUwMCBvdXRsaW5lLW5vbmUgdHJhbnNpdGlvbi1hbGwiLCBwbGFjZWhvbGRlcjogImUuZy4gV2FyZWhvdXNlIEIiLCB2YWx1ZTogc3RhdGUuc2l0ZU5hbWUsIG9uQ2hhbmdlOiAoZSkgPT4gc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBzaXRlTmFtZTogZS50YXJnZXQudmFsdWUgfSkpIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInNwYWNlLXktMS41IiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJJbnNwZWN0b3IiIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSIsIGNoaWxkcmVuOiBbX2pzeChVc2VyLCB7IGNsYXNzTmFtZTogImFic29sdXRlIGxlZnQtMyB0b3AtMyB3LTQgaC00IHRleHQtc2xhdGUtNDAwIiB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJ0ZXh0IiwgY2xhc3NOYW1lOiAidy1mdWxsIHBsLTEwIHAtMi41IGJnLXNsYXRlLTUwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHJvdW5kZWQtbGcgdGV4dC1zbGF0ZS04MDAgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctYmx1ZS01MDAgb3V0bGluZS1ub25lIHRyYW5zaXRpb24tYWxsIiwgcGxhY2Vob2xkZXI6ICJGdWxsIE5hbWUiLCB2YWx1ZTogc3RhdGUuaW5zcGVjdG9yTmFtZSwgb25DaGFuZ2U6IChlKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGluc3BlY3Rvck5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEuNSIsIGNoaWxkcmVuOiBbX2pzeCgibGFiZWwiLCB7IGNsYXNzTmFtZTogInRleHQteHMgZm9udC1ib2xkIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiR2VvLUxvY2F0aW9uIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJ0ZXh0IiwgY2xhc3NOYW1lOiAiZmxleC0xIHAtMi41IGJnLXNsYXRlLTUwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHJvdW5kZWQtbGcgdGV4dC1zbGF0ZS04MDAgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctYmx1ZS01MDAgb3V0bGluZS1ub25lIHRleHQtc20iLCBwbGFjZWhvbGRlcjogIkNpdHkvUmVnaW9uIiwgdmFsdWU6IHN0YXRlLmdlb0xvY2F0aW9uLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgZ2VvTG9jYXRpb246IGUudGFyZ2V0LnZhbHVlIH0pKSB9KSwgX2pzeCgiYnV0dG9uIiwgeyBvbkNsaWNrOiBkZXRlY3RMb2NhdGlvbiwgY2xhc3NOYW1lOiAicHgtMyBiZy1zbGF0ZS0xMDAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTUwMCBob3Zlcjp0ZXh0LWJsdWUtNjAwIGhvdmVyOmJvcmRlci1ibHVlLTMwMCB0cmFuc2l0aW9uLWNvbG9ycyIsIGNoaWxkcmVuOiBfanN4KE1hcFBpbiwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KV0gfSldIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xLjUiLCBjaGlsZHJlbjogW19qc3goImxhYmVsIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCB1cHBlcmNhc2UiLCBjaGlsZHJlbjogIkNvbXBhbnkgTG9nbyAoT3B0aW9uYWwpIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IGxvZ29JbnB1dFJlZi5jdXJyZW50Py5jbGljaygpLCBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBweC00IHB5LTIgYmctc2xhdGUtNTAgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgcm91bmRlZC1sZyB0ZXh0LXNsYXRlLTYwMCBob3ZlcjpiZy1zbGF0ZS0xMDAgdGV4dC1zbSBmb250LW1lZGl1bSIsIGNoaWxkcmVuOiBbX2pzeChJbWFnZUljb24sIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgVXBsb2FkIExvZ28iXSB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJmaWxlIiwgcmVmOiBsb2dvSW5wdXRSZWYsIGNsYXNzTmFtZTogImhpZGRlbiIsIGFjY2VwdDogImltYWdlLyoiLCBvbkNoYW5nZTogaGFuZGxlTG9nb1NlbGVjdCB9KSwgc3RhdGUuY29tcGFueUxvZ28gJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJnLWdyZWVuLTUwIHRleHQtZ3JlZW4tNzAwIHB4LTMgcHktMS41IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ncmVlbi0xMDAgdGV4dC14cyBmb250LWJvbGQiLCBjaGlsZHJlbjogW19qc3goQ2hlY2ssIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSksICIgTG9nbyBVcGxvYWRlZCJdIH0pKV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJwdC00IGJvcmRlci10IGJvcmRlci1zbGF0ZS0xMDAiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciBtYi0zIiwgY2hpbGRyZW46IFtfanN4KCJsYWJlbCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgdXBwZXJjYXNlIiwgY2hpbGRyZW46ICJTZWxlY3QgSW5zcGVjdGlvbiBTY29wZXMiIH0pLCBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiBgdGV4dC14cyBmb250LWJvbGQgJHtzdGF0ZS5zY29wZS5sZW5ndGggPj0gMiA/ICd0ZXh0LWFtYmVyLTYwMCcgOiAndGV4dC1zbGF0ZS00MDAnfWAsIGNoaWxkcmVuOiBbc3RhdGUuc2NvcGUubGVuZ3RoLCAiLzIgU2VsZWN0ZWQiXSB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBnYXAtMyIsIGNoaWxkcmVuOiBPYmplY3Qua2V5cyhTQ09QRV9DT05GSUcpLm1hcCgoc2NvcGVLZXkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZiA9IFNDT1BFX0NPTkZJR1tzY29wZUtleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IEljb24gPSBjb25mLmljb247CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBzdGF0ZS5zY29wZS5pbmNsdWRlcyhzY29wZUtleSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSAhaXNTZWxlY3RlZCAmJiBzdGF0ZS5zY29wZS5sZW5ndGggPj0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiB0b2dnbGVTY29wZShzY29wZUtleSksIGRpc2FibGVkOiBpc0Rpc2FibGVkLCBjbGFzc05hbWU6IGAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlIHAtMyByb3VuZGVkLXhsIGJvcmRlciB0cmFuc2l0aW9uLWFsbCB0ZXh0LWxlZnQgZmxleCBpdGVtcy1zdGFydCBnYXAtMyBncm91cAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtpc1NlbGVjdGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnYmctYmx1ZS01MCBib3JkZXItYmx1ZS01MDAgcmluZy0xIHJpbmctYmx1ZS01MDAgc2hhZG93LXNtJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogaXNEaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICdiZy1zbGF0ZS01MCBib3JkZXItc2xhdGUtMTAwIG9wYWNpdHktNTAgY3Vyc29yLW5vdC1hbGxvd2VkJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdiZy13aGl0ZSBib3JkZXItc2xhdGUtMjAwIGhvdmVyOmJvcmRlci1ibHVlLTMwMCBob3ZlcjpiZy1zbGF0ZS01MCd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC0yIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnMgc2hyaW5rLTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7aXNTZWxlY3RlZCA/IGNvbmYuY29sb3IgKyAnIHRleHQtd2hpdGUnIDogaXNEaXNhYmxlZCA/ICdiZy1zbGF0ZS0xMDAgdGV4dC1zbGF0ZS0zMDAnIDogJ2JnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTQwMCBncm91cC1ob3Zlcjp0ZXh0LXNsYXRlLTYwMCd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCwgY2hpbGRyZW46IF9qc3goSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LXNtICR7aXNTZWxlY3RlZCA/ICd0ZXh0LWJsdWUtOTAwJyA6IGlzRGlzYWJsZWQgPyAndGV4dC1zbGF0ZS00MDAnIDogJ3RleHQtc2xhdGUtNzAwJ31gLCBjaGlsZHJlbjogY29uZi5sYWJlbCB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LVsxMHB4XSB0ZXh0LXNsYXRlLTQwMCBtdC0wLjUgbGVhZGluZy10aWdodCIsIGNoaWxkcmVuOiBjb25mLnN0YW5kYXJkcy5zcGxpdCgnLCcpWzBdIH0pXSB9KSwgaXNTZWxlY3RlZCAmJiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMyByaWdodC0zIiwgY2hpbGRyZW46IF9qc3goQ2hlY2tDaXJjbGUsIHsgY2xhc3NOYW1lOiAidy00IGgtNCB0ZXh0LWJsdWUtNjAwIiB9KSB9KSldIH0sIHNjb3BlS2V5KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSldIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiBoYW5kbGVTdGFydFNlc3Npb24sIGRpc2FibGVkOiAhaXNSZWFkeSwgY2xhc3NOYW1lOiBgCiAgICAgICAgICAgICAgICAgICAgICAgIHctZnVsbCBweS00IHJvdW5kZWQteGwgZm9udC1ib2xkIHRleHQtbGcgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTMgdHJhbnNpdGlvbi1hbGwgbXQtNgogICAgICAgICAgICAgICAgICAgICAgICAke2lzUmVhZHkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWdyYWRpZW50LXRvLXIgZnJvbS1ibHVlLTcwMCB0by1pbmRpZ28tODAwIHRleHQtd2hpdGUgc2hhZG93LXhsIHNoYWRvdy1ibHVlLTkwMC8yMCBob3ZlcjpzaGFkb3ctMnhsIHRyYW5zZm9ybSBob3ZlcjotdHJhbnNsYXRlLXktMC41JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnYmctc2xhdGUtMTAwIHRleHQtc2xhdGUtNDAwIGN1cnNvci1ub3QtYWxsb3dlZCd9CiAgICAgICAgICAgICAgICAgICAgICBgLCBjaGlsZHJlbjogWyJJbml0aWFsaXplIEluc3BlY3Rpb24gIiwgX2pzeChBcnJvd1JpZ2h0LCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pXSB9KV0gfSldIH0pIH0pXSB9KV0gfSkpOwogICAgfQogICAgLy8gU3RhZ2luZyBWaWV3CiAgICBpZiAoc3RhdGUudmlldyA9PT0gJ3N0YWdpbmcnKSB7CiAgICAgICAgLy8gLi4uIChTdGFnaW5nIGxvZ2ljIGxvZ2ljIHVuY2hhbmdlZCkgLi4uCiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtNTAgcC02IiwgY2hpbGRyZW46IFtfanN4KCJzdHlsZSIsIHsgY2hpbGRyZW46IEdsb2JhbFByaW50U3R5bGVzIH0pLCBfanN4KCJuYXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIGJvcmRlci1iIGJvcmRlci1zbGF0ZS0yMDAgc3RpY2t5IHRvcC0wIHotMTAgcC00IG1iLTYgcm91bmRlZC14bCBzaGFkb3ctc20iLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHZpZXc6ICdkYXNoYm9hcmQnLCBzdGFnaW5nSW1hZ2VzOiBbXSB9KSksIGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRleHQtc2xhdGUtNjAwIGZvbnQtbWVkaXVtIGhvdmVyOnRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogW19qc3goQ2hldnJvbkxlZnQsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgQ2FuY2VsIFVwbG9hZCJdIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc20gZm9udC1ib2xkIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogc3RhdGUuc2l0ZU5hbWUgfSldIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy0zeGwgbXgtYXV0byIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgcm91bmRlZC0yeGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHAtOCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgiaDIiLCB7IGNsYXNzTmFtZTogInRleHQtMnhsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIiwgY2hpbGRyZW46ICJBZGQgTmV3IFNwYWNlIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgdGV4dC1zbSIsIGNoaWxkcmVuOiAiVXBsb2FkIGltYWdlcyB0byBhbmFseXplIGhhemFyZHMiIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGdhcC0yIiwgY2hpbGRyZW46IHN0YXRlLnNjb3BlLm1hcChzID0+IChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQteHMgcHgtMiBweS0xIHJvdW5kZWQgZm9udC1ib2xkIGJvcmRlciAke3MgPT09ICdGaXJlJyA/ICdiZy1yZWQtNTAgdGV4dC1yZWQtODAwIGJvcmRlci1yZWQtMTAwJyA6ICdiZy1ibHVlLTUwIHRleHQtYmx1ZS04MDAgYm9yZGVyLWJsdWUtMTAwJ31gLCBjaGlsZHJlbjogU0NPUEVfQ09ORklHW3NdLmxhYmVsIH0sIHMpKSkgfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC02IG1iLTYiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeHMoImxhYmVsIiwgeyBjbGFzc05hbWU6ICJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtc2xhdGUtNzAwIG1iLTIgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goTGF5ZXJzLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIERlcGFydG1lbnQgLyBTZWN0aW9uIl0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAidGV4dCIsIHZhbHVlOiBzdGF0ZS5zdGFnaW5nRGVwYXJ0bWVudCwgb25DaGFuZ2U6IChlKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHN0YWdpbmdEZXBhcnRtZW50OiBlLnRhcmdldC52YWx1ZSB9KSksIGNsYXNzTmFtZTogInctZnVsbCBwLTMgYm9yZGVyIGJvcmRlci1zbGF0ZS0zMDAgcm91bmRlZC1sZyIsIHBsYWNlaG9sZGVyOiAiZS5nLiBQcm9kdWN0aW9uIEZsb29yLCBXYXJlaG91c2UuLi4iIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4cygibGFiZWwiLCB7IGNsYXNzTmFtZTogImJsb2NrIHRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1zbGF0ZS03MDAgbWItMiBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeChCdWlsZGluZywgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSwgIiBSb29tIC8gQXJlYSBOYW1lIl0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAidGV4dCIsIHZhbHVlOiBzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsIG9uQ2hhbmdlOiAoZSkgPT4gc2V0U3RhdGUocyA9PiAoeyAuLi5zLCBzdGFnaW5nUm9vbU5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pKSwgY2xhc3NOYW1lOiAidy1mdWxsIHAtMyBib3JkZXIgYm9yZGVyLXNsYXRlLTMwMCByb3VuZGVkLWxnIiwgcGxhY2Vob2xkZXI6ICJlLmcuIExpbmUgNCwgTWl4aW5nIEFyZWEsIE9mZmljZSAyMDEuLi4iIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1iLTYgcC00IGJnLWJsdWUtNTAgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWJsdWUtMTAwIGZsZXggaXRlbXMtc3RhcnQgZ2FwLTMiLCBjaGlsZHJlbjogW19qc3goImlucHV0IiwgeyB0eXBlOiAiY2hlY2tib3giLCBpZDogImdlblBsYW4iLCBjaGVja2VkOiBzdGF0ZS5zdGFnaW5nR2VuZXJhdGVQbGFuLCBvbkNoYW5nZTogKGUpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgc3RhZ2luZ0dlbmVyYXRlUGxhbjogZS50YXJnZXQuY2hlY2tlZCB9KSksIGNsYXNzTmFtZTogIm10LTEgdy01IGgtNSB0ZXh0LWJsdWUtNjAwIHJvdW5kZWQiIH0pLCBfanN4cygibGFiZWwiLCB7IGh0bWxGb3I6ICJnZW5QbGFuIiwgY2xhc3NOYW1lOiAiY3Vyc29yLXBvaW50ZXIiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIiwgY2hpbGRyZW46IFtfanN4KE1hcEljb24sIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgQUkgRXZhY3VhdGlvbiBQbGFuIl0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LWJsdWUtODAwIiwgY2hpbGRyZW46ICJBdXRvbWF0aWNhbGx5IGdlbmVyYXRlIGEgc2NoZW1hdGljIGV2YWN1YXRpb24gcGxhbiBiYXNlZCBvbiB0aGUgZmlyc3QgaW1hZ2UgdXBsb2FkZWQuIiB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0yIG1kOmdyaWQtY29scy00IGdhcC00IG1iLTgiLCBjaGlsZHJlbjogW3N0YXRlLnN0YWdpbmdJbWFnZXMubWFwKChmaWxlLCBpZHgpID0+IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSBhc3BlY3Qtc3F1YXJlIGJnLXNsYXRlLTEwMCByb3VuZGVkLWxnIG92ZXJmbG93LWhpZGRlbiBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCIsIGNoaWxkcmVuOiBbX2pzeCgiaW1nIiwgeyBzcmM6IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSksIGNsYXNzTmFtZTogInctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIG9wYWNpdHktODAiIH0pLCBfanN4KCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHNldFN0YXRlKHMgPT4gKHsgLi4ucywgc3RhZ2luZ0ltYWdlczogcy5zdGFnaW5nSW1hZ2VzLmZpbHRlcigoXywgaSkgPT4gaSAhPT0gaWR4KSB9KSksIGNsYXNzTmFtZTogImFic29sdXRlIHRvcC0xIHJpZ2h0LTEgYmctcmVkLTUwMCB0ZXh0LXdoaXRlIHAtMSByb3VuZGVkLWZ1bGwgc2hhZG93IiwgY2hpbGRyZW46IF9qc3goWCwgeyBjbGFzc05hbWU6ICJ3LTMgaC0zIiB9KSB9KSwgaWR4ID09PSAwICYmIHN0YXRlLnN0YWdpbmdHZW5lcmF0ZVBsYW4gJiYgKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgYm90dG9tLTEgbGVmdC0xIGJnLWJsdWUtNjAwIHRleHQtd2hpdGUgdGV4dC1bMTBweF0gcHgtMS41IHB5LTAuNSByb3VuZGVkIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiAiUkVGIiB9KSldIH0sIGlkeCkpKSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gY2FtZXJhSW5wdXRSZWYuY3VycmVudD8uY2xpY2soKSwgY2xhc3NOYW1lOiAiYXNwZWN0LXNxdWFyZSBiZy1ibHVlLTUwIHJvdW5kZWQtbGcgYm9yZGVyLTIgYm9yZGVyLWRhc2hlZCBib3JkZXItYmx1ZS0yMDAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1ibHVlLTYwMCBob3ZlcjpiZy1ibHVlLTEwMCB0cmFuc2l0aW9uLWNvbG9ycyIsIGNoaWxkcmVuOiBbX2pzeChDYW1lcmEsIHsgY2xhc3NOYW1lOiAidy04IGgtOCBtYi0xIiB9KSwgX2pzeCgic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQiLCBjaGlsZHJlbjogIlRha2UgUGhvdG8iIH0pXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gZmlsZUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImFzcGVjdC1zcXVhcmUgYmctc2xhdGUtNTAgcm91bmRlZC1sZyBib3JkZXItMiBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgaG92ZXI6Ym9yZGVyLWJsdWUtNDAwIGhvdmVyOnRleHQtYmx1ZS01MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW19qc3goVXBsb2FkLCB7IGNsYXNzTmFtZTogInctOCBoLTggbWItMSIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRleHQteHMiLCBjaGlsZHJlbjogIlVwbG9hZCIgfSldIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIHB0LTQgYm9yZGVyLXQgYm9yZGVyLXNsYXRlLTEwMCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIGl0YWxpYyIsIGNoaWxkcmVuOiAiSW1hZ2VzIHdpbGwgYmUgcXVldWVkIGZvciBiYXRjaCBhbmFseXNpcy4iIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiBoYW5kbGVTYXZlU3RhZ2luZywgZGlzYWJsZWQ6IHN0YXRlLnN0YWdpbmdJbWFnZXMubGVuZ3RoID09PSAwIHx8ICFzdGF0ZS5zdGFnaW5nUm9vbU5hbWUsIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtNiBweS0zIHJvdW5kZWQtbGcgZm9udC1ib2xkIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW19qc3goQ2hlY2tTcXVhcmUsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgU2F2ZSB0byBRdWV1ZSJdIH0pXSB9KV0gfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAiZmlsZSIsIHJlZjogZmlsZUlucHV0UmVmLCBjbGFzc05hbWU6ICJoaWRkZW4iLCBhY2NlcHQ6ICJpbWFnZS8qIiwgbXVsdGlwbGU6IHRydWUsIG9uQ2hhbmdlOiBoYW5kbGVJbWFnZVNlbGVjdCB9KSwgX2pzeCgiaW5wdXQiLCB7IHR5cGU6ICJmaWxlIiwgcmVmOiBjYW1lcmFJbnB1dFJlZiwgY2xhc3NOYW1lOiAiaGlkZGVuIiwgYWNjZXB0OiAiaW1hZ2UvKiIsIGNhcHR1cmU6ICJlbnZpcm9ubWVudCIsIG9uQ2hhbmdlOiBoYW5kbGVJbWFnZVNlbGVjdCB9KV0gfSldIH0pKTsKICAgIH0KICAgIC8vIFJvb20gRGV0YWlsIFZpZXcKICAgIGlmIChzdGF0ZS52aWV3ID09PSAncm9vbS1kZXRhaWwnKSB7CiAgICAgICAgY29uc3Qgcm9vbSA9IHN0YXRlLnJvb21zLmZpbmQociA9PiByLmlkID09PSBzdGF0ZS5hY3RpdmVSb29tSWQpOwogICAgICAgIGlmICghcm9vbSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgY29uc3QgaXNQZW5kaW5nID0gcm9vbS5zdGF0dXMgPT09ICdwZW5kaW5nJzsKICAgICAgICBjb25zdCBoYXNFcnJvcnMgPSByb29tLmNhcHR1cmVzLnNvbWUoYyA9PiBjLmVycm9yKTsKICAgICAgICBjb25zdCBwcmltYXJ5Q29sb3IgPSBTQ09QRV9DT05GSUdbc3RhdGUuc2NvcGVbMF1dLmhleDsKICAgICAgICBjb25zdCBpc0ZhY2lsaXR5T3JPSFMgPSBzdGF0ZS5zY29wZS5pbmNsdWRlcygnRmFjaWxpdHknKSB8fCBzdGF0ZS5zY29wZS5pbmNsdWRlcygnT0hTJykgfHwgc3RhdGUuc2NvcGUuaW5jbHVkZXMoJ0ZpcmUnKTsKICAgICAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1pbi1oLXNjcmVlbiBiZy1zbGF0ZS01MCBwcmludDpiZy13aGl0ZSIsIGNoaWxkcmVuOiBbX2pzeCgic3R5bGUiLCB7IGNoaWxkcmVuOiBHbG9iYWxQcmludFN0eWxlcyB9KSwgX2pzeCgibmF2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSBib3JkZXItYiBib3JkZXItc2xhdGUtMjAwIHAtNCBzdGlja3kgdG9wLTAgei0xMCBwcmludDpoaWRkZW4iLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXctNXhsIG14LWF1dG8gZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHZpZXc6ICdkYXNoYm9hcmQnIH0pKSwgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgdGV4dC1zbGF0ZS02MDAgZm9udC1tZWRpdW0gaG92ZXI6dGV4dC1ibHVlLTkwMCIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBCYWNrIHRvIERhc2hib2FyZCJdIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiaDEiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWxnIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMiIsIGNoaWxkcmVuOiAhaXNQZW5kaW5nICYmICFoYXNFcnJvcnMgJiYgKF9qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHdpbmRvdy5wcmludCgpLCBjbGFzc05hbWU6ICJiZy1ibHVlLTYwMCB0ZXh0LXdoaXRlIHB4LTQgcHktMiByb3VuZGVkLWxnIHRleHQtc20gZm9udC1tZWRpdW0gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgc2hhZG93LXNtIiwgY2hpbGRyZW46IFtfanN4KFByaW50ZXIsIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgUHJpbnQgUm9vbSBSZXBvcnQiXSB9KSkgfSldIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy01eGwgbXgtYXV0byBwLTYgc3BhY2UteS04IHByaW50OnAtMCBwcmludDptLTAgcHJpbnQ6dy1mdWxsIHByaW50Om1heC13LW5vbmUgcHJpbnQ6c3BhY2UteS0yIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJwcmludDpoaWRkZW4gYmctd2hpdGUgcC02IHJvdW5kZWQteGwgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgc2hhZG93LXNtIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgZm9udC1ib2xkIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4cygicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTcwMCBweC0yIHB5LTAuNSByb3VuZGVkIHRleHQteHMgZm9udC1ib2xkIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KSwgIlx1MjAyMiAiLCByb29tLmNhcHR1cmVzLmxlbmd0aCwgIiBWaWV3cG9pbnRzIl0gfSldIH0pLCAoaXNQZW5kaW5nIHx8IGhhc0Vycm9ycykgJiYgKF9qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFN0YXRlKHMgPT4gKHsgLi4ucywgbG9hZGluZzogdHJ1ZSwgbG9hZGluZ01lc3NhZ2U6IGBBbmFseXppbmcgJHtyb29tLm5hbWV9Li4uYCB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmFseXplUm9vbShyb29tKS50aGVuKHVwZGF0ZWRSb29tID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTdGF0ZShzID0+ICh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb21zOiBzLnJvb21zLm1hcChyID0+IHIuaWQgPT09IHVwZGF0ZWRSb29tLmlkID8gdXBkYXRlZFJvb20gOiByKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgY2xhc3NOYW1lOiAiYmctYmx1ZS02MDAgdGV4dC13aGl0ZSBweC00IHB5LTIgcm91bmRlZC1sZyBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgdGV4dC1zbSBzaGFkb3ctbWQgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMiLCBjaGlsZHJlbjogW2hhc0Vycm9ycyA/IF9qc3goUmVmcmVzaEN3LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pIDogX2pzeChQbGF5LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCBoYXNFcnJvcnMgPyAiUmV0cnkgRmFpbGVkIEFuYWx5c2lzIiA6ICJSdW4gQW5hbHlzaXMgTm93Il0gfSkpXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJoaWRkZW4gcHJpbnQ6YmxvY2sgcHJpbnQ6bWItNiBwcmludC1uby1icmVhayIsIGNoaWxkcmVuOiBfanN4KFFySGVhZGVyLCB7IHRpdGxlOiByb29tLm5hbWUsIHN1YlRpdGxlOiBgJHtyb29tLmRlcGFydG1lbnR9YCwgc2l0ZU5hbWU6IHN0YXRlLnNpdGVOYW1lLCBjb21wYW55TmFtZTogc3RhdGUuY29tcGFueU5hbWUsIGluc3BlY3Rvck5hbWU6IHN0YXRlLmluc3BlY3Rvck5hbWUsIGRhdGU6IHN0YXRlLmluc3BlY3Rpb25EYXRlLCBsb2dvOiBzdGF0ZS5jb21wYW55TG9nbywgdGhlbWVDb2xvcjogcHJpbWFyeUNvbG9yIH0pIH0pLCAocm9vbS5ldmFjdWF0aW9uUGxhbiB8fCBpc0ZhY2lsaXR5T3JPSFMpICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSBwLTYgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBzaGFkb3ctc20gcHJpbnQtbm8tYnJlYWsgcHJpbnQtY2FyZC1jbGVhbiBwcmludC1zZWN0aW9uLWJvcmRlciIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIG1iLTQiLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1ibHVlLTkwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBwcmludDp0ZXh0LWJsYWNrIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogW19qc3goTWFwSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBFdmFjdWF0aW9uIFBsYW4iXSB9KSwgcm9vbS5ldmFjdWF0aW9uUGxhbiAmJiBfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJiZy1ncmVlbi0xMDAgdGV4dC1ncmVlbi03MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBib3JkZXIgYm9yZGVyLWdyZWVuLTIwMCBwcmludDpoaWRkZW4iLCBjaGlsZHJlbjogIkdlbmVyYXRlZCIgfSldIH0pLCByb29tLmV2YWN1YXRpb25QbGFuID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctc2xhdGUtNTAgcm91bmRlZCBib3JkZXIgYm9yZGVyLXNsYXRlLTEwMCBwLTIgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS0zMDAgcHJpbnQ6Ymctd2hpdGUiLCBjaGlsZHJlbjogX2pzeCgiaW1nIiwgeyBzcmM6IHJvb20uZXZhY3VhdGlvblBsYW4sIGNsYXNzTmFtZTogInctZnVsbCBtYXgtaC1bNjAwcHhdIG9iamVjdC1jb250YWluIHByaW50Om1heC1oLVs4Y21dIiB9KSB9KSkgOiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctYmx1ZS01MCBib3JkZXIgYm9yZGVyLWJsdWUtMTAwIHJvdW5kZWQtbGcgcC04IHRleHQtY2VudGVyIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ3LTE2IGgtMTYgYmctYmx1ZS0xMDAgdGV4dC1ibHVlLTYwMCByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgbXgtYXV0byBtYi00IiwgY2hpbGRyZW46IF9qc3goTWFwSWNvbiwgeyBjbGFzc05hbWU6ICJ3LTggaC04IiB9KSB9KSwgX2pzeCgiaDQiLCB7IGNsYXNzTmFtZTogInRleHQteGwgZm9udC1ib2xkIHRleHQtYmx1ZS05MDAgbWItMiIsIGNoaWxkcmVuOiAiRXZhY3VhdGlvbiBQbGFuIE1pc3NpbmciIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTYwMCBtYi02IG1heC13LW1kIG14LWF1dG8iLCBjaGlsZHJlbjogIkdlbmVyYXRlIGEgcHJvZmVzc2lvbmFsIGV2YWN1YXRpb24gcGxhbiB3aXRoIGZsb29yIG1hcmtpbmdzIGFuZCBleGl0IHJvdXRlcyB1c2luZyBBSSBiYXNlZCBvbiB0aGUgcm9vbSBsYXlvdXQuIiB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gaGFuZGxlR2VuZXJhdGVQbGFuRm9yUm9vbShyb29tLmlkKSwgZGlzYWJsZWQ6IHN0YXRlLmxvYWRpbmcsIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtNiBweS0zIHJvdW5kZWQtbGcgZm9udC1ib2xkIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbXgtYXV0byIsIGNoaWxkcmVuOiBbc3RhdGUubG9hZGluZyA/IF9qc3goTG9hZGVyMiwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IGFuaW1hdGUtc3BpbiIgfSkgOiBfanN4KE1hcEljb24sIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICJHZW5lcmF0ZSBBSSBFdmFjdWF0aW9uIFBsYW4iXSB9KV0gfSkpXSB9KSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0xMiBwcmludDpzcGFjZS15LTgiLCBjaGlsZHJlbjogcm9vbS5jYXB0dXJlcy5tYXAoKGNhcHR1cmUsIGlkeCkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNiByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuIHByaW50LXNlY3Rpb24tYm9yZGVyIiwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTQgYm9yZGVyLWIgcGItMiBmbGV4IGp1c3RpZnktYmV0d2VlbiBwcmludDp0ZXh0LWJsYWNrIiwgc3R5bGU6IHsgY29sb3I6IHByaW1hcnlDb2xvciwgYm9yZGVyQ29sb3I6IHByaW1hcnlDb2xvciB9LCBjaGlsZHJlbjogW19qc3hzKCJzcGFuIiwgeyBjaGlsZHJlbjogWyJWaWV3cG9pbnQgIiwgaWR4ICsgMV0gfSksIF9qc3hzKCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIGZvbnQtbm9ybWFsIHRleHQtc2xhdGUtNTAwIiwgY2hpbGRyZW46IFsiSUQ6ICIsIGNhcHR1cmUuaWQuc3BsaXQoJy0nKVsxXV0gfSldIH0pLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogIm1iLTYiLCBjaGlsZHJlbjogY2FwdHVyZS5vdmVybGF5SW1hZ2UgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0yIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KEltYWdlQ29tcGFyZVNsaWRlciwgeyBvcmlnaW5hbDogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBvdmVybGF5OiBjYXB0dXJlLm92ZXJsYXlJbWFnZSB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiaGlkZGVuIHByaW50LWdyaWQtMiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiT3JpZ2luYWwgQ2FwdHVyZSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogInByaW50LWltYWdlLWNvbXBhY3QiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiQW5hbHlzaXMgT3ZlcmxheSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm92ZXJsYXlJbWFnZSwgY2xhc3NOYW1lOiAicHJpbnQtaW1hZ2UtY29tcGFjdCIgfSldIH0pXSB9KV0gfSkpIDogKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImdyaWQgZ3JpZC1jb2xzLTIgZ2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyBmb250LWJvbGQgdGV4dC1zbGF0ZS01MDAgbWItMiB1cHBlcmNhc2UiLCBjaGlsZHJlbjogIk9yaWdpbmFsIENhcHR1cmUiIH0pLCBfanN4KCJpbWciLCB7IHNyYzogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBjbGFzc05hbWU6ICJ3LWZ1bGwgcm91bmRlZCBiZy1zbGF0ZS0xMDAgYm9yZGVyIGgtNjQgb2JqZWN0LWNvdmVyIiB9KV0gfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidy1mdWxsIGgtNjQgYmctc2xhdGUtNTAgYm9yZGVyIHJvdW5kZWQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgdGV4dC1zbGF0ZS00MDAgdGV4dC14cyBpdGFsaWMiLCBjaGlsZHJlbjogY2FwdHVyZS5lcnJvciA/ICJBbmFseXNpcyBGYWlsZWQiIDogIkFuYWx5c2lzIFBlbmRpbmciIH0pXSB9KSkgfSksIGNhcHR1cmUuZXJyb3IgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicC02IGJnLXJlZC01MCBib3JkZXIgYm9yZGVyLXJlZC0yMDAgcm91bmRlZC1sZyB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeChBbGVydENpcmNsZSwgeyBjbGFzc05hbWU6ICJ3LTggaC04IHRleHQtcmVkLTUwMCBteC1hdXRvIG1iLTIiIH0pLCBfanN4KCJoNCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtcmVkLTkwMCIsIGNoaWxkcmVuOiAiQW5hbHlzaXMgRmFpbGVkIiB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSB0ZXh0LXJlZC03MDAgbXQtMSBtYi00IiwgY2hpbGRyZW46IGNhcHR1cmUuZXJyb3IgfSldIH0pKSA6IGNhcHR1cmUuYW5hbHlzaXMgPyAoX2pzeChBbmFseXNpc0Rpc3BsYXksIHsgYW5hbHlzaXM6IGNhcHR1cmUuYW5hbHlzaXMgfSkpIDogKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtOCBiZy1hbWJlci01MCBib3JkZXIgYm9yZGVyLWFtYmVyLTEwMCByb3VuZGVkLWxnIHRleHQtY2VudGVyIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3goQ2xvY2ssIHsgY2xhc3NOYW1lOiAidy04IGgtOCB0ZXh0LWFtYmVyLTQwMCBteC1hdXRvIG1iLTIiIH0pLCBfanN4KCJoNCIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtYW1iZXItOTAwIiwgY2hpbGRyZW46ICJBbmFseXNpcyBQZW5kaW5nIiB9KV0gfSkpXSB9LCBjYXB0dXJlLmlkKSkpIH0pXSB9KV0gfSkpOwogICAgfQogICAgLy8gUmVwb3J0IFZpZXcgKEZ1bGwgU2l0ZSkKICAgIGlmIChzdGF0ZS52aWV3ID09PSAncmVwb3J0JykgewogICAgICAgIGNvbnN0IGFuYWx5emVkUm9vbXMgPSBzdGF0ZS5yb29tcy5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ2FuYWx5emVkJyk7CiAgICAgICAgY29uc3QgdG90YWxDYXB0dXJlcyA9IGFuYWx5emVkUm9vbXMucmVkdWNlKChhY2MsIHIpID0+IGFjYyArIHIuY2FwdHVyZXMubGVuZ3RoLCAwKTsKICAgICAgICBjb25zdCBhdmdTY29yZSA9IHRvdGFsQ2FwdHVyZXMgPiAwCiAgICAgICAgICAgID8gTWF0aC5yb3VuZChhbmFseXplZFJvb21zLnJlZHVjZSgoYWNjLCByKSA9PiBhY2MgKyByLmNhcHR1cmVzLnJlZHVjZSgoY0FjYywgYykgPT4gY0FjYyArIChjLmFuYWx5c2lzPy5zY29yZSB8fCAwKSwgMCkgLyB0b3RhbENhcHR1cmVzKSkKICAgICAgICAgICAgOiAwOwogICAgICAgIGNvbnN0IGFsbFN0YW5kYXJkcyA9IGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMuZmxhdE1hcChjID0+IGMuYW5hbHlzaXM/LnJlbGV2YW50U3RhbmRhcmRzIHx8IFtdKSk7CiAgICAgICAgY29uc3QgdW5pcXVlU3RhbmRhcmRzID0gQXJyYXkuZnJvbShuZXcgTWFwKGFsbFN0YW5kYXJkcy5tYXAoKHMpID0+IFtzLnN0YW5kYXJkSWQsIHNdKSkudmFsdWVzKCkpOwogICAgICAgIGNvbnN0IGFjdGl2ZVNjb3BlTGFiZWwgPSBzdGF0ZS5zY29wZS5tYXAocyA9PiBTQ09QRV9DT05GSUdbc10ubGFiZWwpLmpvaW4oJyArICcpOwogICAgICAgIGNvbnN0IGFjdGl2ZVNjb3BlQ29uZmlnID0gU0NPUEVfQ09ORklHW3N0YXRlLnNjb3BlWzBdXTsKICAgICAgICBjb25zdCB0aGVtZUNvbG9yID0gYWN0aXZlU2NvcGVDb25maWcuaGV4OwogICAgICAgIGNvbnN0IGlzRmFjaWxpdHlTY29wZSA9IHN0YXRlLnNjb3BlLmluY2x1ZGVzKCdGYWNpbGl0eScpOwogICAgICAgIC8vIEFnZ3JlZ2F0ZSBmaW5kaW5ncyBmb3IgRmFjaWxpdHkgU2NvcGUgU3VtbWFyeSBUYWJsZQogICAgICAgIGNvbnN0IGZhY2lsaXR5U3VtbWFyeSA9IGlzRmFjaWxpdHlTY29wZSA/IGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMpLnJlZHVjZSgoYWNjLCBjKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhdCA9IGMuYW5hbHlzaXM/LmNhdGVnb3J5IHx8ICdHZW5lcmFsJzsKICAgICAgICAgICAgaWYgKCFhY2NbY2F0XSkKICAgICAgICAgICAgICAgIGFjY1tjYXRdID0geyBzY29yZVN1bTogMCwgY291bnQ6IDAsIGlzc3VlczogMCB9OwogICAgICAgICAgICBhY2NbY2F0XS5zY29yZVN1bSArPSBjLmFuYWx5c2lzPy5zY29yZSB8fCAwOwogICAgICAgICAgICBhY2NbY2F0XS5jb3VudCArPSAxOwogICAgICAgICAgICBhY2NbY2F0XS5pc3N1ZXMgKz0gKGMuYW5hbHlzaXM/LmRldGFpbGVkRmluZGluZ3M/LmZpbHRlcihmID0+IGYudHlwZSAhPT0gJ0dvb2QgY29uZGl0aW9uJykubGVuZ3RoIHx8IDApOwogICAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0sIHt9KSA6IG51bGw7CiAgICAgICAgcmV0dXJuIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctc2xhdGUtMTAwIHByaW50OmJnLXdoaXRlIHByaW50Om1pbi1oLTAiLCBjaGlsZHJlbjogW19qc3goInN0eWxlIiwgeyBjaGlsZHJlbjogR2xvYmFsUHJpbnRTdHlsZXMgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBzdGlja3kgdG9wLTAgei01MCBzaGFkb3ctbWQgcHJpbnQ6aGlkZGVuIiwgY2hpbGRyZW46IF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1heC13LTV4bCBteC1hdXRvIHB4LTQgaC0xNiBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4iLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IHNldFZpZXcoJ2Rhc2hib2FyZCcpLCBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBob3Zlcjp0ZXh0LWJsdWUtOTAwIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBCYWNrIHRvIERhc2hib2FyZCJdIH0pLCBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiB3aW5kb3cucHJpbnQoKSwgY2xhc3NOYW1lOiAiYmctYmx1ZS02MDAgdGV4dC13aGl0ZSBweC00IHB5LTIgcm91bmRlZC1sZyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBob3ZlcjpiZy1ibHVlLTcwMCBmb250LWJvbGQgc2hhZG93LXNtIiwgY2hpbGRyZW46IFtfanN4KFByaW50ZXIsIHsgY2xhc3NOYW1lOiAidy00IGgtNCIgfSksICIgUHJpbnQgRnVsbCBSZXBvcnQiXSB9KV0gfSkgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm1heC13LTV4bCBteC1hdXRvIHAtOCBwcmludDpwLTAgcHJpbnQ6bWF4LXctbm9uZSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJpbnQtY292ZXItcGFnZSIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50Om1iLTgiLCBjaGlsZHJlbjogX2pzeChRckhlYWRlciwgeyB0aXRsZTogIlNpdGUgSW5zcGVjdGlvbiBSZXBvcnQiLCBzdWJUaXRsZTogYWN0aXZlU2NvcGVMYWJlbCwgc2l0ZU5hbWU6IHN0YXRlLnNpdGVOYW1lLCBjb21wYW55TmFtZTogc3RhdGUuY29tcGFueU5hbWUsIGluc3BlY3Rvck5hbWU6IHN0YXRlLmluc3BlY3Rvck5hbWUsIGRhdGU6IHN0YXRlLmluc3BlY3Rpb25EYXRlLCBsb2dvOiBzdGF0ZS5jb21wYW55TG9nbywgdGhlbWVDb2xvcjogdGhlbWVDb2xvciB9KSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBnYXAtOCBtYi04IHByaW50LW5vLWJyZWFrIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0zIGdhcC00IHRleHQtY2VudGVyIHByaW50OmdyaWQgcHJpbnQ6Z2FwLTQiLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNCByb3VuZGVkLXhsIHNoYWRvdy1zbSBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHByaW50OnRleHQtYmxhY2siLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogYW5hbHl6ZWRSb29tcy5sZW5ndGggfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB0ZXh0LXNsYXRlLTUwMCB1cHBlcmNhc2UgZm9udC1ib2xkIiwgY2hpbGRyZW46ICJBcmVhcyBBdWRpdGVkIiB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHAtNCByb3VuZGVkLXhsIHNoYWRvdy1zbSBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHByaW50OnRleHQtYmxhY2siLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogdG90YWxDYXB0dXJlcyB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQiLCBjaGlsZHJlbjogIlRvdGFsIFZpZXdwb2ludHMiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgYmctd2hpdGUgcC00IHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHByaW50LWNhcmQtY2xlYW5gLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQtM3hsIGZvbnQtYm9sZCAke2dldFNjb3JlQ29sb3IoYXZnU2NvcmUpfSBwcmludDp0ZXh0LWJsYWNrYCwgY2hpbGRyZW46IFthdmdTY29yZSwgIiUiXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQiLCBjaGlsZHJlbjogIlNpdGUgQ29tcGxpYW5jZSIgfSldIH0pXSB9KSwgc3RhdGUuZ2VvTG9jYXRpb24gJiYgc3RhdGUuZ2VvTG9jYXRpb24gIT09ICdGZXRjaGluZy4uLicgJiYgc3RhdGUuZ2VvTG9jYXRpb24gIT09ICdOb3QgU3VwcG9ydGVkJyAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgcC0xIHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIG92ZXJmbG93LWhpZGRlbiBoLTQwIHJlbGF0aXZlIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS0zMDAgcHJpbnQ6aC0zMiIsIGNoaWxkcmVuOiBbX2pzeCgiaWZyYW1lIiwgeyB3aWR0aDogIjEwMCUiLCBoZWlnaHQ6ICIxMDAlIiwgZnJhbWVCb3JkZXI6ICIwIiwgc2Nyb2xsaW5nOiAibm8iLCBtYXJnaW5IZWlnaHQ6IDAsIG1hcmdpbldpZHRoOiAwLCB0aXRsZTogIlNpdGUgTG9jYXRpb24iLCBzcmM6IGBodHRwczovL21hcHMuZ29vZ2xlLmNvbS9tYXBzP3E9JHtlbmNvZGVVUklDb21wb25lbnQoc3RhdGUuZ2VvTG9jYXRpb24pfSZ0PSZ6PTEzJmllPVVURjgmaXdsb2M9Jm91dHB1dD1lbWJlZGAsIGNsYXNzTmFtZTogInJvdW5kZWQtbGciIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMiBsZWZ0LTIgYmctd2hpdGUvOTAgYmFja2Ryb3AtYmx1ciBweC0yIHB5LTEgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBzaGFkb3ctc20gdGV4dC1zbGF0ZS03MDAgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEgcHJpbnQ6Ym9yZGVyIHByaW50OmJvcmRlci1zbGF0ZS00MDAiLCBjaGlsZHJlbjogW19qc3goTWFwUGluLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiICIsIHN0YXRlLmdlb0xvY2F0aW9uXSB9KV0gfSkpXSB9KV0gfSksIGlzRmFjaWxpdHlTY29wZSAmJiBmYWNpbGl0eVN1bW1hcnkgJiYgKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXdoaXRlIHJvdW5kZWQteGwgYm9yZGVyIGJvcmRlci1zbGF0ZS0yMDAgc2hhZG93LXNtIHAtNiBtYi04IHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4iLCBjaGlsZHJlbjogW19qc3hzKCJoMyIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1ibHVlLTkwMCBtYi00IGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJvcmRlci1iIGJvcmRlci1zbGF0ZS0xMDAgcGItMiBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1zbGF0ZS0zMDAiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogW19qc3goTGF5b3V0RGFzaGJvYXJkLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIENhdGVnb3J5IFN1bW1hcnkiXSB9KSwgX2pzeHMoInRhYmxlIiwgeyBjbGFzc05hbWU6ICJ3LWZ1bGwgdGV4dC1zbSB0ZXh0LWxlZnQiLCBjaGlsZHJlbjogW19qc3goInRoZWFkIiwgeyBjbGFzc05hbWU6ICJiZy1zbGF0ZS01MCBmb250LWJvbGQgdGV4dC1zbGF0ZS03MDAiLCBjaGlsZHJlbjogX2pzeHMoInRyIiwgeyBjaGlsZHJlbjogW19qc3goInRoIiwgeyBjbGFzc05hbWU6ICJwLTIgYm9yZGVyLWIiLCBjaGlsZHJlbjogIkNhdGVnb3J5IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiSW1hZ2VzIiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiQXZnIFNjb3JlIiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMiBib3JkZXItYiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiAiRmluZGluZ3MiIH0pXSB9KSB9KSwgX2pzeCgidGJvZHkiLCB7IGNoaWxkcmVuOiBPYmplY3QuZW50cmllcyhmYWNpbGl0eVN1bW1hcnkpLm1hcCgoW2NhdCwgc3RhdHNdKSA9PiAoX2pzeHMoInRyIiwgeyBjbGFzc05hbWU6ICJib3JkZXItYiBsYXN0OmJvcmRlci0wIiwgY2hpbGRyZW46IFtfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0yIGZvbnQtbWVkaXVtIiwgY2hpbGRyZW46IGNhdCB9KSwgX2pzeCgidGQiLCB7IGNsYXNzTmFtZTogInAtMiB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBzdGF0cy5jb3VudCB9KSwgX2pzeHMoInRkIiwgeyBjbGFzc05hbWU6ICJwLTIgdGV4dC1jZW50ZXIiLCBjaGlsZHJlbjogW01hdGgucm91bmQoc3RhdHMuc2NvcmVTdW0gLyBzdGF0cy5jb3VudCksICIlIl0gfSksIF9qc3goInRkIiwgeyBjbGFzc05hbWU6ICJwLTIgdGV4dC1jZW50ZXIiLCBjaGlsZHJlbjogc3RhdHMuaXNzdWVzID4gMCA/IChfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1yZWQtNjAwIGZvbnQtYm9sZCIsIGNoaWxkcmVuOiBbc3RhdHMuaXNzdWVzLCAiIElzc3VlcyJdIH0pKSA6IChfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyZWVuLTYwMCBmb250LWJvbGQiLCBjaGlsZHJlbjogIkdvb2QiIH0pKSB9KV0gfSwgY2F0KSkpIH0pXSB9KV0gfSkpLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy13aGl0ZSByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwLTYgbWItOCBwcmludC1uby1icmVhayBwcmludC1jYXJkLWNsZWFuIiwgY2hpbGRyZW46IFtfanN4cygiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWxnIHRleHQtYmx1ZS05MDAgbWItNCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBib3JkZXItYiBib3JkZXItc2xhdGUtMTAwIHBiLTIgcHJpbnQ6dGV4dC1ibGFjayBwcmludDpib3JkZXItc2xhdGUtMzAwIiwgc3R5bGU6IHsgY29sb3I6IHRoZW1lQ29sb3IgfSwgY2hpbGRyZW46IFtfanN4KEdhdmVsLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIEFwcGxpY2FibGUgUmVndWxhdG9yeSBGcmFtZXdvcmsiXSB9KSwgdW5pcXVlU3RhbmRhcmRzLmxlbmd0aCA+IDAgPyAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC00IiwgY2hpbGRyZW46IHVuaXF1ZVN0YW5kYXJkcy5tYXAoKHMsIGkpID0+IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zIHAtMyBiZy1zbGF0ZS01MCByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItc2xhdGUtMTAwIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6cC0wIHByaW50Om1iLTIgcHJpbnQ6YmxvY2siLCBjaGlsZHJlbjogW3Muc3RhbmRhcmRJZC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsb2NhbCcpID8gKF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiYmctaW5kaWdvLTYwMCB0ZXh0LXdoaXRlIHAtMS41IHJvdW5kZWQgbXQtMC41IHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KE1hcFBpbiwgeyBjbGFzc05hbWU6ICJ3LTQgaC00IiB9KSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy1ibHVlLTYwMCB0ZXh0LXdoaXRlIHAtMS41IHJvdW5kZWQgbXQtMC41IHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBfanN4KEdsb2JlLCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pIH0pKSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTgwMCB0ZXh0LXNtIiwgY2hpbGRyZW46IHMuc3RhbmRhcmRJZC5yZXBsYWNlKC9cWy4qP1xdL2csICcnKS50cmltKCkgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB0ZXh0LXNsYXRlLTYwMCIsIGNoaWxkcmVuOiBzLmRlc2NyaXB0aW9uIH0pXSB9KV0gfSwgaSkpKSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNsYXRlLTQwMCBpdGFsaWMgdGV4dC1zbSIsIGNoaWxkcmVuOiAiTm8gc3BlY2lmaWMgc3RhbmRhcmRzIHdlcmUgY2l0ZWQgaW4gdGhlIGFuYWx5c2lzIHJlc3VsdHMuIiB9KSldIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJzcGFjZS15LTEyIHByaW50OnNwYWNlLXktMCIsIGNoaWxkcmVuOiBhbmFseXplZFJvb21zLm1hcCgocm9vbSkgPT4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInByaW50LWJyZWFrLWJlZm9yZSBtYi0xNiBsYXN0Om1iLTAgcHJpbnQ6bWItMCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJiZy1ibHVlLTkwMCB0ZXh0LXdoaXRlIHAtNCByb3VuZGVkLXQtbGcgbWItNiBwcmludDpiZy13aGl0ZSBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1iLTIgcHJpbnQ6Ym9yZGVyLWJsYWNrIHByaW50OnJvdW5kZWQtbm9uZSBwcmludDpweC0wIHByaW50Om1iLTQgcHJpbnQtbm8tYnJlYWsiLCBzdHlsZTogeyBib3JkZXJDb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtZW5kIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC14cyB1cHBlcmNhc2UgZm9udC1ib2xkIHRleHQtYmx1ZS0yMDAgcHJpbnQ6dGV4dC1zbGF0ZS01MDAgbWItMSIsIGNoaWxkcmVuOiByb29tLmRlcGFydG1lbnQgfSksIF9qc3goImgyIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pXSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXJpZ2h0IiwgY2hpbGRyZW46IF9qc3hzKCJwIiwgeyBjbGFzc05hbWU6ICJvcGFjaXR5LTcwIHRleHQtc20gcHJpbnQ6dGV4dC1zbGF0ZS02MDAiLCBjaGlsZHJlbjogWyJBdWRpdGVkOiAiLCBuZXcgRGF0ZShyb29tLnRpbWVzdGFtcCkudG9Mb2NhbGVEYXRlU3RyaW5nKCldIH0pIH0pXSB9KSB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIGdhcC0xMiBwcmludDpnYXAtNCIsIGNoaWxkcmVuOiByb29tLmNhcHR1cmVzLm1hcCgoY2FwdHVyZSwgaWR4KSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAicHJpbnQtbm8tYnJlYWsgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBwYi04IGxhc3Q6Ym9yZGVyLTAgcHJpbnQ6Ym9yZGVyLW5vbmUgcHJpbnQ6cGItMCBwcmludDptYi00IHByaW50LXNlY3Rpb24tYm9yZGVyIiwgY2hpbGRyZW46IFtfanN4cygiaDQiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTQgdGV4dC1sZyBwcmludDp0ZXh0LWJsYWNrIHByaW50OnRleHQtYmFzZSIsIHN0eWxlOiB7IGNvbG9yOiB0aGVtZUNvbG9yIH0sIGNoaWxkcmVuOiBbIlZpZXdwb2ludCAiLCBpZHggKyAxXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMiBnYXAtNiBtYi02IHByaW50LWdyaWQtMiIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtY2VudGVyIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiT3JpZ2luYWwgU2NlbmUiIH0pLCBfanN4KCJpbWciLCB7IHNyYzogY2FwdHVyZS5vcmlnaW5hbEltYWdlLCBjbGFzc05hbWU6ICJ3LWZ1bGwgaC02NCBvYmplY3QtY292ZXIgYm9yZGVyIHJvdW5kZWQtbGcgc2hhZG93LXNtIHByaW50LWltYWdlLWNvbXBhY3QiIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtY2VudGVyIGZvbnQtYm9sZCB0ZXh0LXNsYXRlLTUwMCBtYi0yIHVwcGVyY2FzZSIsIGNoaWxkcmVuOiAiQUkgQW5hbHlzaXMgT3ZlcmxheSIgfSksIF9qc3goImltZyIsIHsgc3JjOiBjYXB0dXJlLm92ZXJsYXlJbWFnZSB8fCBjYXB0dXJlLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogInctZnVsbCBoLTY0IG9iamVjdC1jb3ZlciBib3JkZXIgcm91bmRlZC1sZyBzaGFkb3ctc20gcHJpbnQtaW1hZ2UtY29tcGFjdCIgfSldIH0pXSB9KSwgY2FwdHVyZS5hbmFseXNpcyA/IChfanN4KEFuYWx5c2lzRGlzcGxheSwgeyBhbmFseXNpczogY2FwdHVyZS5hbmFseXNpcywgY29tcGFjdDogZmFsc2UsIGhpZGVJdGVtczogdHJ1ZSB9KSkgOiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXJlZC01MDAgZm9udC1ib2xkIHRleHQtc20gaXRhbGljIiwgY2hpbGRyZW46ICJBbmFseXNpcyBGYWlsZWQgZm9yIHRoaXMgdmlld3BvaW50LiIgfSkpXSB9LCBjYXB0dXJlLmlkKSkpIH0pLCByb29tLmV2YWN1YXRpb25QbGFuICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC04IHAtNCBwcmludC1uby1icmVhayBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCByb3VuZGVkLWxnIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6bXQtNCBwcmludC1zZWN0aW9uLWJvcmRlciIsIGNoaWxkcmVuOiBbX2pzeCgiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCBtYi00IHRleHQtYmx1ZS05MDAgYm9yZGVyLWIgcGItMiBwcmludDp0ZXh0LWJsYWNrIHByaW50OmJvcmRlci1zbGF0ZS0zMDAiLCBzdHlsZTogeyBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogIkV2YWN1YXRpb24gUGxhbiIgfSksIF9qc3goImltZyIsIHsgc3JjOiByb29tLmV2YWN1YXRpb25QbGFuLCBjbGFzc05hbWU6ICJtYXgtaC1bNjAwcHhdIG9iamVjdC1jb250YWluIHctZnVsbCBwcmludDptYXgtaC1bOGNtXSIgfSldIH0pKV0gfSwgcm9vbS5pZCkpKSB9KSwgaXNGYWNpbGl0eVNjb3BlICYmIChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtdC0xMiBiZy13aGl0ZSByb3VuZGVkLXhsIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIHNoYWRvdy1zbSBwLTggcHJpbnQtbm8tYnJlYWsgcHJpbnQtY2FyZC1jbGVhbiBwcmludDpicmVhay1iZWZvcmUtcGFnZSIsIGNoaWxkcmVuOiBbX2pzeHMoImgzIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC14bCB0ZXh0LWJsdWUtOTAwIG1iLTYgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgYm9yZGVyLWItMiBib3JkZXItc2xhdGUtMjAwIHBiLTQgcHJpbnQ6dGV4dC1ibGFjayIsIHN0eWxlOiB7IGJvcmRlckNvbG9yOiB0aGVtZUNvbG9yLCBjb2xvcjogdGhlbWVDb2xvciB9LCBjaGlsZHJlbjogW19qc3goQWN0aXZpdHksIHsgY2xhc3NOYW1lOiAidy02IGgtNiIgfSksICIgRmluYWwgRXZhbHVhdGlvbiJdIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtOCBtYi04IiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNTAwIHVwcGVyY2FzZSBmb250LWJvbGQgbWItMSIsIGNoaWxkcmVuOiAiT3ZlcmFsbCBTY29yZSIgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtNXhsIGZvbnQtYmxhY2sgdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogW2F2Z1Njb3JlLCAiJSJdIH0pXSB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgZmxleC0xIHAtNiByb3VuZGVkLXhsIGJvcmRlciBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtNCAke2F2Z1Njb3JlID49IDcwID8gJ2JnLWdyZWVuLTUwIGJvcmRlci1ncmVlbi0yMDAnIDogJ2JnLXJlZC01MCBib3JkZXItcmVkLTIwMCd9YCwgY2hpbGRyZW46IFthdmdTY29yZSA+PSA3MCA/IF9qc3goVGh1bWJzVXAsIHsgY2xhc3NOYW1lOiAidy0xMiBoLTEyIHRleHQtZ3JlZW4tNjAwIiB9KSA6IF9qc3goVGh1bWJzRG93biwgeyBjbGFzc05hbWU6ICJ3LTEyIGgtMTIgdGV4dC1yZWQtNjAwIiB9KSwgX2pzeHMoImRpdiIsIHsgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogYHRleHQtMnhsIGZvbnQtYm9sZCAke2F2Z1Njb3JlID49IDcwID8gJ3RleHQtZ3JlZW4tODAwJyA6ICd0ZXh0LXJlZC04MDAnfWAsIGNoaWxkcmVuOiBhdmdTY29yZSA+PSA3MCA/ICdQQVNTJyA6ICdGQUlMJyB9KSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtc2xhdGUtNjAwIiwgY2hpbGRyZW46IGF2Z1Njb3JlID49IDcwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ICJGYWNpbGl0eSBtZWV0cyB0aGUgYmFzZWxpbmUgdmlzdWFsIGluc3BlY3Rpb24gc3RhbmRhcmRzLiBNaW5vciBpbXByb3ZlbWVudHMgcmVjb21tZW5kZWQuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAiQ3JpdGljYWwgbm9uLWNvbmZvcm1pdGllcyBkZXRlY3RlZC4gSW1tZWRpYXRlIGNvcnJlY3RpdmUgYWN0aW9uIHJlcXVpcmVkLiIgfSldIH0pXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNoaWxkcmVuOiBbX2pzeCgiaDQiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LXNsYXRlLTcwMCB1cHBlcmNhc2UgdGV4dC1zbSBtYi00IiwgY2hpbGRyZW46ICJQcmlvcml0eSBJbXByb3ZlbWVudCBBY3Rpb25zIiB9KSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0zIiwgY2hpbGRyZW46IFthbmFseXplZFJvb21zLmZsYXRNYXAociA9PiByLmNhcHR1cmVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZsYXRNYXAoYyA9PiBjLmFuYWx5c2lzPy5kZXRhaWxlZEZpbmRpbmdzIHx8IFtdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmID0+IGYucmlzayA9PT0gJ0hpZ2gnIHx8IGYudHlwZSA9PT0gJ1NhZmV0eSBoYXphcmQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNsaWNlKDAsIDUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChmLCBpKSA9PiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtMyBwLTMgYmctcmVkLTUwIGJvcmRlciBib3JkZXItcmVkLTEwMCByb3VuZGVkLWxnIiwgY2hpbGRyZW46IFtfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogImJnLXJlZC0yMDAgdGV4dC1yZWQtODAwIGZvbnQtYm9sZCB3LTYgaC02IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXhzIHNocmluay0wIiwgY2hpbGRyZW46IGkgKyAxIH0pLCBfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtcmVkLTkwMCB0ZXh0LXNtIiwgY2hpbGRyZW46IGYuaXNzdWUgfSksIF9qc3goImRpdiIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS02MDAgdGV4dC14cyBpdGFsaWMiLCBjaGlsZHJlbjogZi5yZWNvbW1lbmRhdGlvbiB9KV0gfSldIH0sIGkpKSksIGFuYWx5emVkUm9vbXMuZmxhdE1hcChyID0+IHIuY2FwdHVyZXMpLmZsYXRNYXAoYyA9PiBjLmFuYWx5c2lzPy5kZXRhaWxlZEZpbmRpbmdzIHx8IFtdKS5maWx0ZXIoZiA9PiBmLnJpc2sgPT09ICdIaWdoJykubGVuZ3RoID09PSAwICYmIChfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogInRleHQtc2xhdGUtNTAwIGl0YWxpYyIsIGNoaWxkcmVuOiAiTm8gaGlnaC1yaXNrIHByaW9yaXR5IGFjdGlvbnMgaWRlbnRpZmllZC4iIH0pKV0gfSldIH0pXSB9KSksICFpc0ZhY2lsaXR5U2NvcGUgJiYgKGFuYWx5emVkUm9vbXMubWFwKHJvb20gPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9vbUl0ZW1zID0gcm9vbS5jYXB0dXJlcy5mbGF0TWFwKGMgPT4gYy5hbmFseXNpcz8ucmVjb21tZW5kZWRJdGVtcyB8fCBbXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm9vbUl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogIm10LTggYmctd2hpdGUgcm91bmRlZC14bCBib3JkZXIgYm9yZGVyLXNsYXRlLTIwMCBzaGFkb3ctc20gcC02IHByaW50LW5vLWJyZWFrIHByaW50LWNhcmQtY2xlYW4gcHJpbnQ6bXQtNiByZW1lZGlhdGlvbi1tYW5pZmVzdCIsIGNoaWxkcmVuOiBbX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgdGV4dC1lbWVyYWxkLTkwMCBtYi00IGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIGJvcmRlci1iIGJvcmRlci1lbWVyYWxkLTEwMCBwYi0yIHByaW50OmhpZGRlbiIsIGNoaWxkcmVuOiBbX2pzeChTaG9wcGluZ0JhZywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBSZW1lZGlhdGlvbiBCaWxsIG9mIE1hdGVyaWFscyAoIiwgcm9vbS5uYW1lLCAiKSJdIH0pLCBfanN4cygidGFibGUiLCB7IGNsYXNzTmFtZTogInctZnVsbCB0ZXh0LXNtIHRleHQtbGVmdCIsIGNoaWxkcmVuOiBbX2pzeCgidGhlYWQiLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtNTAgdGV4dC1lbWVyYWxkLTkwMCBmb250LWJvbGQgYm9yZGVyLWIgYm9yZGVyLWVtZXJhbGQtMjAwIiwgY2hpbGRyZW46IF9qc3hzKCJ0ciIsIHsgY2hpbGRyZW46IFtfanN4KCJ0aCIsIHsgY2xhc3NOYW1lOiAicC0zIiwgY2hpbGRyZW46ICJJdGVtIC8gRXF1aXBtZW50IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMyIsIGNoaWxkcmVuOiAiUmVxdWlyZWQgUXR5IiB9KSwgX2pzeCgidGgiLCB7IGNsYXNzTmFtZTogInAtMyIsIGNoaWxkcmVuOiAiUmVhc29uIC8gSGF6YXJkIiB9KV0gfSkgfSksIF9qc3goInRib2R5IiwgeyBjbGFzc05hbWU6ICJkaXZpZGUteSBkaXZpZGUtc2xhdGUtMTAwIiwgY2hpbGRyZW46IHJvb21JdGVtcy5tYXAoKGl0ZW0sIGlkeCkgPT4gKF9qc3hzKCJ0ciIsIHsgY2xhc3NOYW1lOiAiaG92ZXI6Ymctc2xhdGUtNTAiLCBjaGlsZHJlbjogW19qc3goInRkIiwgeyBjbGFzc05hbWU6ICJwLTMgZm9udC1tZWRpdW0gdGV4dC1zbGF0ZS04MDAiLCBjaGlsZHJlbjogaXRlbS5pdGVtIH0pLCBfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0zIiwgY2hpbGRyZW46IF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLWVtZXJhbGQtMTAwIHRleHQtZW1lcmFsZC04MDAgcHgtMiBweS0wLjUgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCB3aGl0ZXNwYWNlLW5vd3JhcCIsIGNoaWxkcmVuOiBpdGVtLnF1YW50aXR5IH0pIH0pLCBfanN4KCJ0ZCIsIHsgY2xhc3NOYW1lOiAicC0zIHRleHQtc2xhdGUtNTAwIHRleHQteHMgaXRhbGljIiwgY2hpbGRyZW46IGl0ZW0ucmVhc29uIH0pXSB9LCBpZHgpKSkgfSldIH0pXSB9LCByb29tLmlkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgfSkpLCBfanN4KCJkaXYiLCB7IGNsYXNzTmFtZTogIm10LTEyIHRleHQtY2VudGVyIHByaW50OmhpZGRlbiBwYi0xMiIsIGNoaWxkcmVuOiBfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRWaWV3KCdkYXNoYm9hcmQnKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgaG92ZXI6dGV4dC1ibHVlLTkwMCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTIgbXgtYXV0byIsIGNoaWxkcmVuOiBbX2pzeChDaGV2cm9uTGVmdCwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgIiBSZXR1cm4gdG8gRGFzaGJvYXJkIl0gfSkgfSldIH0pXSB9KSk7CiAgICB9CiAgICAvLyBEYXNoYm9hcmQgLi4uIChyZXN0IHVuY2hhbmdlZCkKICAgIGNvbnN0IHBlbmRpbmdSb29tc0NvdW50ID0gc3RhdGUucm9vbXMuZmlsdGVyKHIgPT4gci5zdGF0dXMgPT09ICdwZW5kaW5nJykubGVuZ3RoOwogICAgY29uc3QgZXJyb3JSb29tc0NvdW50ID0gc3RhdGUucm9vbXMuZmlsdGVyKHIgPT4gci5jYXB0dXJlcy5zb21lKGMgPT4gYy5lcnJvcikpLmxlbmd0aDsKICAgIHJldHVybiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWluLWgtc2NyZWVuIGJnLXNsYXRlLTUwIGZsZXggZmxleC1jb2wiLCBjaGlsZHJlbjogW19qc3goInN0eWxlIiwgeyBjaGlsZHJlbjogR2xvYmFsUHJpbnRTdHlsZXMgfSksIF9qc3goQWN0aXZpdHlMb2dNb2RhbCwgeyBsb2dzOiBzdGF0ZS5sb2dzLCBpc09wZW46IHN0YXRlLnNob3dMb2dzLCBvbkNsb3NlOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHNob3dMb2dzOiBmYWxzZSB9KSkgfSksIF9qc3goIm5hdiIsIHsgY2xhc3NOYW1lOiAiYmctd2hpdGUgYm9yZGVyLWIgYm9yZGVyLXNsYXRlLTIwMCBzdGlja3kgdG9wLTAgei0xMCBzaHJpbmstMCIsIGNoaWxkcmVuOiBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJtYXgtdy01eGwgbXgtYXV0byBweC00IGgtMTYgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIiwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGB3LTggaC04IHJvdW5kZWQtbGcgJHtzdGF0ZS5zY29wZS5sZW5ndGggPiAwID8gU0NPUEVfQ09ORklHW3N0YXRlLnNjb3BlWzBdXS5jb2xvciA6ICdiZy1zbGF0ZS01MDAnfSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB0ZXh0LXdoaXRlYCwgY2hpbGRyZW46IHN0YXRlLnNjb3BlLmluY2x1ZGVzKCdGYWNpbGl0eScpID8gX2pzeChDbGlwYm9hcmRDaGVjaywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSA6IF9qc3goU2hpZWxkLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGZsZXgtY29sIiwgY2hpbGRyZW46IFtfanN4KCJzcGFuIiwgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1ibHVlLTkwMCB0ZXh0LXNtIGxlYWRpbmctdGlnaHQiLCBjaGlsZHJlbjogc3RhdGUuY29tcGFueU5hbWUgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtY2VudGVyIGdhcC0xIHRleHQteHMgdGV4dC1zbGF0ZS01MDAiLCBjaGlsZHJlbjogW19qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRydW5jYXRlIG1heC13LVsyMDBweF0iLCBjaGlsZHJlbjogc3RhdGUuc2l0ZU5hbWUgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogIm14LTEiLCBjaGlsZHJlbjogIlx1MjAyMiIgfSksIF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogInRydW5jYXRlIG1heC13LVsyMDBweF0iLCBjaGlsZHJlbjogc3RhdGUuc2NvcGUubWFwKHMgPT4gU0NPUEVfQ09ORklHW3NdLmxhYmVsKS5qb2luKCcsICcpIH0pXSB9KV0gfSldIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyIsIGNoaWxkcmVuOiBbX2pzeCgiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIHNob3dMb2dzOiB0cnVlIH0pKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgaG92ZXI6dGV4dC1ibHVlLTYwMCBwLTIgcm91bmRlZC1mdWxsIGhvdmVyOmJnLXNsYXRlLTUwIHRyYW5zaXRpb24tY29sb3JzIiwgdGl0bGU6ICJWaWV3IEFjdGl2aXR5IExvZyIsIGNoaWxkcmVuOiBfanN4KEhpc3RvcnksIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSkgfSksIHN0YXRlLnJvb21zLnNvbWUociA9PiByLnN0YXR1cyA9PT0gJ2FuYWx5emVkJyAmJiAhci5jYXB0dXJlcy5zb21lKGMgPT4gYy5lcnJvcikpICYmIChfanN4cygiYnV0dG9uIiwgeyBvbkNsaWNrOiAoKSA9PiBzZXRWaWV3KCdyZXBvcnQnKSwgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS02MDAgaG92ZXI6dGV4dC1ibHVlLTkwMCBmb250LW1lZGl1bSB0ZXh0LXNtIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRyYW5zaXRpb24tY29sb3JzIiwgY2hpbGRyZW46IFtfanN4KEZpbGVUZXh0LCB7IGNsYXNzTmFtZTogInctNCBoLTQiIH0pLCAiIFNpdGUgUmVwb3J0Il0gfSkpXSB9KV0gfSkgfSksIF9qc3hzKCJtYWluIiwgeyBjbGFzc05hbWU6IGBtYXgtdy01eGwgbXgtYXV0byBwLTYgdy1mdWxsICR7c3RhdGUucm9vbXMubGVuZ3RoID09PSAwID8gJ2ZsZXgtMSBmbGV4IGZsZXgtY29sJyA6ICcnfWAsIGNoaWxkcmVuOiBbKHBlbmRpbmdSb29tc0NvdW50ID4gMCB8fCBlcnJvclJvb21zQ291bnQgPiAwKSAmJiAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiBgbWItOCBwLTYgcm91bmRlZC14bCB0ZXh0LXdoaXRlIHNoYWRvdy1sZyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gJHtlcnJvclJvb21zQ291bnQgPiAwID8gJ2JnLWFtYmVyLTcwMCcgOiAnYmctaW5kaWdvLTkwMCd9YCwgY2hpbGRyZW46IFtfanN4cygiZGl2IiwgeyBjaGlsZHJlbjogW19qc3hzKCJoMiIsIHsgY2xhc3NOYW1lOiAidGV4dC14bCBmb250LWJvbGQgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW2Vycm9yUm9vbXNDb3VudCA+IDAgPyBfanN4KEFsZXJ0Q2lyY2xlLCB7IGNsYXNzTmFtZTogInctNSBoLTUgdGV4dC1hbWJlci0yMDAiIH0pIDogX2pzeChTcGFya2xlcywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IHRleHQtaW5kaWdvLTMwMCIgfSksIGVycm9yUm9vbXNDb3VudCA+IDAgPyAiRmFpbHVyZXMgRGV0ZWN0ZWQiIDogIkFjdGlvbiBSZXF1aXJlZCJdIH0pLCBfanN4KCJwIiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXdoaXRlLzgwIHRleHQtc20gbXQtMSIsIGNoaWxkcmVuOiBlcnJvclJvb21zQ291bnQgPiAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgJHtlcnJvclJvb21zQ291bnR9IGFyZWEocykgZmFpbGVkIGFuYWx5c2lzLiBQbGVhc2UgY2hlY2sgaW50ZXJuZXQgYW5kIHJldHJ5LmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGAke3BlbmRpbmdSb29tc0NvdW50fSBhcmVhKHMpIGFyZSBxdWV1ZWQgZm9yIGFuYWx5c2lzLiBSdW4gYmF0Y2ggcHJvY2Vzc2luZy5gIH0pXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogaGFuZGxlQmF0Y2hBbmFseXplLCBkaXNhYmxlZDogc3RhdGUubG9hZGluZywgY2xhc3NOYW1lOiAiYmctd2hpdGUgdGV4dC1pbmRpZ28tOTAwIHB4LTYgcHktMyByb3VuZGVkLWxnIGZvbnQtYm9sZCBob3ZlcjpiZy1pbmRpZ28tNTAgdHJhbnNpdGlvbi1jb2xvcnMgc2hhZG93LWxnIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIiwgY2hpbGRyZW46IFtzdGF0ZS5sb2FkaW5nID8gX2pzeChMb2FkZXIyLCB7IGNsYXNzTmFtZTogInctNSBoLTUgYW5pbWF0ZS1zcGluIiB9KSA6IGVycm9yUm9vbXNDb3VudCA+IDAgPyBfanN4KFJlZnJlc2hDdywgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSA6IF9qc3goUGxheSwgeyBjbGFzc05hbWU6ICJ3LTUgaC01IiB9KSwgZXJyb3JSb29tc0NvdW50ID4gMCA/ICJSZXRyeSBBbGwgRmFpbGVkIiA6ICJBbmFseXplIEFsbCBQZW5kaW5nIl0gfSldIH0pKSwgc3RhdGUucm9vbXMubGVuZ3RoID4gMCAmJiAoX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGxnOmdyaWQtY29scy0zIGdhcC02IG1iLTgiLCBjaGlsZHJlbjogc3RhdGUucm9vbXMubWFwKChyb29tKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0aHVtYiA9IHJvb20uY2FwdHVyZXNbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc1BlbmRpbmcgPSByb29tLnN0YXR1cyA9PT0gJ3BlbmRpbmcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzRXJyb3IgPSByb29tLmNhcHR1cmVzLnNvbWUoYyA9PiBjLmVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjb3JlID0gIWlzUGVuZGluZyAmJiAhaGFzRXJyb3IgJiYgcm9vbS5jYXB0dXJlcy5sZW5ndGggPiAwID8gTWF0aC5yb3VuZChyb29tLmNhcHR1cmVzLnJlZHVjZSgoYWNjLCBjKSA9PiBhY2MgKyAoYy5hbmFseXNpcz8uc2NvcmUgfHwgMCksIDApIC8gcm9vbS5jYXB0dXJlcy5sZW5ndGgpIDogMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoX2pzeHMoImRpdiIsIHsgb25DbGljazogKCkgPT4geyBzZXRTdGF0ZShzID0+ICh7IC4uLnMsIGFjdGl2ZVJvb21JZDogcm9vbS5pZCwgdmlldzogJ3Jvb20tZGV0YWlsJyB9KSk7IH0sIGNsYXNzTmFtZTogYGJnLXdoaXRlIHJvdW5kZWQteGwgc2hhZG93LXNtIGJvcmRlciBvdmVyZmxvdy1oaWRkZW4gaG92ZXI6c2hhZG93LW1kIGN1cnNvci1wb2ludGVyIHRyYW5zaXRpb24tYWxsIGdyb3VwICR7aGFzRXJyb3IgPyAnYm9yZGVyLXJlZC0zMDAnIDogaXNQZW5kaW5nID8gJ2JvcmRlci1hbWJlci0yMDAnIDogJ2JvcmRlci1zbGF0ZS0yMDAgaG92ZXI6Ym9yZGVyLWJsdWUtNDAwJ31gLCBjaGlsZHJlbjogW19qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInJlbGF0aXZlIGgtNDggYmctc2xhdGUtMTAwIiwgY2hpbGRyZW46IFtfanN4KCJpbWciLCB7IHNyYzogdGh1bWIub3ZlcmxheUltYWdlIHx8IHRodW1iLm9yaWdpbmFsSW1hZ2UsIGNsYXNzTmFtZTogYHctZnVsbCBoLWZ1bGwgb2JqZWN0LWNvdmVyIHRyYW5zaXRpb24tdHJhbnNmb3JtIGdyb3VwLWhvdmVyOnNjYWxlLTEwNSAke2lzUGVuZGluZyB8fCBoYXNFcnJvciA/ICdvcGFjaXR5LTgwIGdyYXlzY2FsZS1bMC41XScgOiAnJ31gIH0pLCBpc1BlbmRpbmcgPyAoX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgdG9wLTIgcmlnaHQtMiBiZy1hbWJlci01MDAgdGV4dC13aGl0ZSBweC0yIHB5LTEgcm91bmRlZCB0ZXh0LXhzIGZvbnQtYm9sZCBzaGFkb3ctc20gZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiLCBjaGlsZHJlbjogW19qc3goQ2xvY2ssIHsgY2xhc3NOYW1lOiAidy0zIGgtMyIgfSksICIgUGVuZGluZyJdIH0pKSA6IGhhc0Vycm9yID8gKF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC0yIHJpZ2h0LTIgYmctcmVkLTUwMCB0ZXh0LXdoaXRlIHB4LTIgcHktMSByb3VuZGVkIHRleHQteHMgZm9udC1ib2xkIHNoYWRvdy1zbSBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSIsIGNoaWxkcmVuOiBbX2pzeChBbGVydFRyaWFuZ2xlLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiIEZhaWxlZCJdIH0pKSA6IChfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMiByaWdodC0yIGJnLXdoaXRlLzkwIGJhY2tkcm9wLWJsdXIgcHgtMiBweS0xIHJvdW5kZWQgdGV4dC14cyBmb250LWJvbGQgc2hhZG93LXNtIHRleHQtYmx1ZS05MDAiLCBjaGlsZHJlbjogWyJTY29yZTogIiwgc2NvcmVdIH0pKSwgX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgYm90dG9tLTIgcmlnaHQtMiBiZy1ibGFjay81MCB0ZXh0LXdoaXRlIHB4LTIgcHktMSByb3VuZGVkIHRleHQteHMgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiLCBjaGlsZHJlbjogW19qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiICIsIHJvb20uY2FwdHVyZXMubGVuZ3RoXSB9KV0gfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogInAtNCIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0xIiwgY2hpbGRyZW46IF9qc3goInNwYW4iLCB7IGNsYXNzTmFtZTogImJnLXNsYXRlLTEwMCB0ZXh0LXNsYXRlLTYwMCB0ZXh0LVsxMHB4XSBmb250LWJvbGQgcHgtMS41IHB5LTAuNSByb3VuZGVkIHVwcGVyY2FzZSB0cmFja2luZy13aWRlIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIiwgY2hpbGRyZW46IHJvb20uZGVwYXJ0bWVudCB9KSB9KSwgX2pzeCgiaDMiLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIHRydW5jYXRlIHRleHQtbGciLCBjaGlsZHJlbjogcm9vbS5uYW1lIH0pLCBfanN4cygiZGl2IiwgeyBjbGFzc05hbWU6ICJ0ZXh0LXhzIHRleHQtc2xhdGUtNTAwIG10LTEgZmxleCBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeCgic3BhbiIsIHsgY2hpbGRyZW46IG5ldyBEYXRlKHJvb20udGltZXN0YW1wKS50b0xvY2FsZURhdGVTdHJpbmcoKSB9KSwgcm9vbS5ldmFjdWF0aW9uUGxhbiAmJiBfanN4cygic3BhbiIsIHsgY2xhc3NOYW1lOiAidGV4dC1ibHVlLTYwMCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSBmb250LW1lZGl1bSIsIGNoaWxkcmVuOiBbX2pzeChNYXBJY29uLCB7IGNsYXNzTmFtZTogInctMyBoLTMiIH0pLCAiIFBsYW4gUmVhZHkiXSB9KV0gfSldIH0pXSB9LCByb29tLmlkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pIH0pKSwgX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGAKICAgICAgICAgICAgcmVsYXRpdmUgdHJhbnNpdGlvbi1hbGwgZ3JvdXAKICAgICAgICAgICAgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2ZsZXgtMSBib3JkZXItNCBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgYmctc2xhdGUtMTAwLzUwIHJvdW5kZWQtM3hsIGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLVs1MDBweF0nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdiZy13aGl0ZSByb3VuZGVkLTJ4bCBib3JkZXItMiBib3JkZXItZGFzaGVkIGJvcmRlci1zbGF0ZS0zMDAgcC04IHNoYWRvdy1zbSd9CiAgICAgICAgICBgLCBjaGlsZHJlbjogX2pzeHMoImRpdiIsIHsgY2xhc3NOYW1lOiAibWF4LXctbWQgbXgtYXV0byB0ZXh0LWNlbnRlciIsIGNoaWxkcmVuOiBbX2pzeCgiZGl2IiwgeyBjbGFzc05hbWU6IGAKICAgICAgICAgICAgICByb3VuZGVkLWZ1bGwgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgbXgtYXV0byBtYi00CiAgICAgICAgICAgICAgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAndy0yNCBoLTI0IGJnLXdoaXRlIHNoYWRvdy14bCB0ZXh0LWJsdWUtNjAwJyA6ICd3LTE2IGgtMTYgYmctYmx1ZS01MCB0ZXh0LWJsdWUtNjAwJ30KICAgICAgICAgICAgYCwgY2hpbGRyZW46IF9qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogYCR7c3RhdGUucm9vbXMubGVuZ3RoID09PSAwID8gJ3ctMTAgaC0xMCcgOiAndy04IGgtOCd9YCB9KSB9KSwgX2pzeCgiaDIiLCB7IGNsYXNzTmFtZTogYGZvbnQtYm9sZCB0ZXh0LWJsdWUtOTAwIG1iLTIgJHtzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAndGV4dC0zeGwnIDogJ3RleHQteGwnfWAsIGNoaWxkcmVuOiBzdGF0ZS5yb29tcy5sZW5ndGggPT09IDAgPyAnU3RhcnQgSW5zcGVjdGlvbicgOiAnQWRkIE5ldyBBcmVhJyB9KSwgX2pzeCgicCIsIHsgY2xhc3NOYW1lOiAidGV4dC1zbGF0ZS01MDAgbWItOCB0ZXh0LWxnIiwgY2hpbGRyZW46IHN0YXRlLnJvb21zLmxlbmd0aCA9PT0gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBgQ2FwdHVyZSBvciB1cGxvYWQgcGhvdG9zIHRvIGJlZ2luIHlvdXIgJHtzdGF0ZS5zY29wZS5sZW5ndGggPiAxID8gJ0NvbWJpbmVkJyA6IFNDT1BFX0NPTkZJR1tzdGF0ZS5zY29wZVswXSB8fCAnT0hTJ10ubGFiZWx9IGF1ZGl0LmAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogYFVwbG9hZCBwaG90b3Mgb3IgY2FwdHVyZSBpbWFnZXMgb2YgdGhlIG5ldyBhcmVhLmAgfSksIF9qc3hzKCJkaXYiLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC1jb2wgc206ZmxleC1yb3cgZ2FwLTQganVzdGlmeS1jZW50ZXIiLCBjaGlsZHJlbjogW19qc3hzKCJidXR0b24iLCB7IG9uQ2xpY2s6ICgpID0+IGNhbWVyYUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcHgtOCBweS0zIHJvdW5kZWQteGwgZm9udC1ib2xkIHNoYWRvdy1sZyBzaGFkb3ctYmx1ZS02MDAvMjAgaG92ZXI6YmctYmx1ZS03MDAgdHJhbnNpdGlvbi1jb2xvcnMgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZ2FwLTIiLCBjaGlsZHJlbjogW19qc3goQ2FtZXJhLCB7IGNsYXNzTmFtZTogInctNSBoLTUiIH0pLCAiIFRha2UgUGhvdG8iXSB9KSwgX2pzeHMoImJ1dHRvbiIsIHsgb25DbGljazogKCkgPT4gZmlsZUlucHV0UmVmLmN1cnJlbnQ/LmNsaWNrKCksIGNsYXNzTmFtZTogImJnLXdoaXRlIHRleHQtYmx1ZS03MDAgYm9yZGVyIGJvcmRlci1ibHVlLTIwMCBweC04IHB5LTMgcm91bmRlZC14bCBmb250LWJvbGQgaG92ZXI6YmctYmx1ZS01MCB0cmFuc2l0aW9uLWNvbG9ycyBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBnYXAtMiIsIGNoaWxkcmVuOiBbX2pzeChVcGxvYWQsIHsgY2xhc3NOYW1lOiAidy01IGgtNSIgfSksICIgVXBsb2FkIEdhbGxlcnkiXSB9KV0gfSldIH0pIH0pLCBfanN4KCJpbnB1dCIsIHsgdHlwZTogImZpbGUiLCByZWY6IGZpbGVJbnB1dFJlZiwgY2xhc3NOYW1lOiAiaGlkZGVuIiwgYWNjZXB0OiAiaW1hZ2UvKiIsIG11bHRpcGxlOiB0cnVlLCBvbkNoYW5nZTogaGFuZGxlSW1hZ2VTZWxlY3QgfSksIF9qc3goImlucHV0IiwgeyB0eXBlOiAiZmlsZSIsIHJlZjogY2FtZXJhSW5wdXRSZWYsIGNsYXNzTmFtZTogImhpZGRlbiIsIGFjY2VwdDogImltYWdlLyoiLCBjYXB0dXJlOiAiZW52aXJvbm1lbnQiLCBvbkNoYW5nZTogaGFuZGxlSW1hZ2VTZWxlY3QgfSldIH0pXSB9KSk7Cn0KY29uc3Qgcm9vdCA9IGNyZWF0ZVJvb3QoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKSk7CnJvb3QucmVuZGVyKF9qc3goQ29tcGxpYW5jZUluc3BlY3RvckFwcCwge30pKTsK"}}</script>
<script type="module">
  const geminiUrl = window.location.origin + '/api-proxy';

  window.API_KEY = 'UNUSED_PLACEHOLDER_FOR_API_KEY';
  window.GEMINI_API_KEY = 'UNUSED_PLACEHOLDER_FOR_API_KEY';
  window.process = window.process || {};
  window.process.env = window.process.env || {};
  window.process.env.API_KEY = window.API_KEY;
  window.process.env.GEMINI_API_KEY = window.GEMINI_API_KEY;
</script>


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HSE Compliance App</title>
        <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="./index.tsx"></script>
  </body>
</html>

<script type="module">import '@/index';</script>
